webpackJsonp([1],Array(26).concat([function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=n(673);Object.defineProperty(t,"Paginator",{enumerable:!0,get:function(){return a(r).default}});var i=n(674);Object.defineProperty(t,"LivePaginator",{enumerable:!0,get:function(){return a(i).default}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAABl9pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPHRpZmY6Q29tcHJlc3Npb24+NTwvdGlmZjpDb21wcmVzc2lvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzI8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOk9yaWVudGF0aW9uPjE8L3RpZmY6T3JpZW50YXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyPC90aWZmOllSZXNvbHV0aW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+MTAwPC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjEwMDwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+MTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOkEzNjMxNjc5RUZGQTExRTRCODg4OThENzNBNThGM0VDPC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOkEzNjMxNjdBRUZGQTExRTRCODg4OThENzNBNThGM0VDPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06RGVyaXZlZEZyb20gcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICA8c3RSZWY6aW5zdGFuY2VJRD54bXAuaWlkOkEzNjMxNjc3RUZGQTExRTRCODg4OThENzNBNThGM0VDPC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD54bXAuZGlkOkEzNjMxNjc4RUZGQTExRTRCODg4OThENzNBNThGM0VDPC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICA8L3htcE1NOkRlcml2ZWRGcm9tPgogICAgICAgICA8ZGM6c3ViamVjdD4KICAgICAgICAgICAgPHJkZjpTZXEvPgogICAgICAgICA8L2RjOnN1YmplY3Q+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4yMDE1OjA1OjEyIDEwOjA1OjU4PC94bXA6TW9kaWZ5RGF0ZT4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5QaXhlbG1hdG9yIDMuMy4yPC94bXA6Q3JlYXRvclRvb2w+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpLVWDGAAARGUlEQVR4Ae1dCYwcxRX91T3XXt7DYAsbYyfhEAEMOECCgCBEzJmgWML4CFeMYwjYHAkJNkhoOQIOuZB314mcBUUCedfaYCScgAIRCIIgCGESxBFuFtkGg70G2ztHX5X3e7bt2dnZmXYfc7Efeqenu7rq13/1f/3/q3pMNEETEpiQwIQEJiQwIYEJCdSFBESt9kLefFkTxeLNJGSCNDNGQlFIIZ2USIpMSlLDtD2is9Oqtf7VBCDytqtmQrCzyaITicQ3cX4YjqlEshXf4zhXcXBfTBw6jj04dpCkLaSIN3HrNTLlfymZeE90dWVwr2qpKgGR8+erdGQHhG9dQJY8h4Q4FoJtJSgBhIwDf5yjkGi5VwJ/nIPLGlYG2vQukfIsWebfKBF/XnSu3Vvo8UpeqypA5M3XTKG4eTFJcSkkfjJF1AgAAS6wPCxUP8TgKHwAVNOu7x0A9lfSrYfFfb1v+ak6yGerAhB52+XTSSSuxui/klRlhg2CydYnRGJgVByGuRdzz0Yy5BqxuveVEFt0VXVFAZGd1zaTZvwUw/9GaMM0e+SyNpSTWHMimIJMM41mH4JZu1fc3fthOVnIbatigMhfLp1LUWU1RukcCANmyadJyu2Vl/P9wGzHwLib3t/9RzEwELKajmW07IDIzmWNpMnbYb9/hiNqgzGWr8pdYVPGc40lN5Fp3ChWP/hBOZkpKyBy5VWHY1LthYk4E7bb/0QdpqSiEXYmPibduEb8+sEnwmwqt+6yASJvWXI6gHiYVHUmOpnLQ/We86QvKUPS+rm4p7enHIyixfBJrlpyEUUimxBN1w4YLJasexyHVnfLW5feGb6kstFtqO3IlT+ZR6p4CI002fFEqK2FVDlP+Co8MV3/tVj9wMqQWrGrDdVkYVTNhVY8gpZaahaMXOmze6ybtyNeuSv3cpDnoQECMGYDjKeQYZpiq36QXFeqLtYUISQ8w2XQlN4w2AgFELnquskkMk9DzWfb3lQYnFeqTnaJiYbhFp8v7u39V9BsBD6pI7wDx5k1mMTrDwyWPgewQmmCpjxg594CRiRwQGjVUuSj1MU149p6EShnFiLqERQ1f+vl8WLPBGqy7HULqbyE0TO1LibxYpLje4oi0c+LYbo2lirq9n6wGmLRXRg5Xw0wWMKC/xOrZeeVbW4FXqpcYIDI25adToq6qK5NVb40OXBk05WJLs+/5fV7ICZLdnYqlNnydzB3Xs15VfbiV6GUP0TDiUZ2dYuRnYikz1DuBHHPuk+KFXVzDxm0ACiz5TQwP7fmwDCRU2vtIJpUwOLwxL1zO5GGJXgFAeF4xF5XNDKFNG0ZitwxXjG310vA764auXJpP8UiC2rKXBkAY86pRBcuIGpuQUdZFM6aDM5Zc7Z+RNS/jmjo8+KgsCZZ1iDFjRNE51++cCe1wqV8zyFy5ZKvQ10vqCntkBB28ySiCy5BUoc3royYJvtz5JxzV4d9g+jMC7JJxsLyy15l8CLIYqci3y9WzM0934DAVM2jqNriexOCG26DKsMbJpqaiRpxlKLJB2fX3kuV4/uqWOymWLEyvgCxJ3NJ8yq+/Fqsh+PeAyhudrK4KcNtZFP1p8uV18wat0kXN3wBQsOfQKfFnHoOAt3iYYMbibSQMM5yIfdxi/gDJGqdBtvZ4GqkjctCHd1gv0DQ9/z0yB8gRGfYzokfDurpWdts0UnypvkNXrvlOQ6xt3tKeUKo8wfHAhwrFCJ7204UI5KHZZUQe2+SZlK05TBw9LYXrjwDQrOa4H6g8bA2tjEQ02cRHXUcAq9YXt8wIQ/tIHrtZazgIXBjd7UaiMOYiBKHCT8SZ2UGJBqbht0Y7aHMHwzGzCOIfnwjUUPj+KI+8ths4DZ+ifLf4SBRl2DeG3kfWqY5HbsOvT9fjF/Wum+dVhwMfv64k4imTINZg2mrKpKzvLLjWaC6ZU0Nz35jXojzax8liOePGJdjW1ElZLOC9SCP5BkQzdDbPbbp6jHpPgBwVV/5CmEPhGUWyFa648DzpG6aVhHj7q7x4EtheGYj5rFVszZxfqoMZJhmwmszngExTAsv08DWVwuxy8lp8ukzYMZYHnlmLImXpT7DckXYbjKPCdP0jLxnQBSSuj0aeYEmr+9lx4jNG4Mw/yqio48vrAm6RvTvZ4geHwiZXyyzm9Y4wVNpyXieQywhk7JavBsd73kefwrRsXMKg8Fy4FjmjHPhTh8+frBZWl6lS2DBSrfsl39Kly1QwjMgJJUh2EqEIpVWj5FedXCc6oJa4Yu4dhhc1JdbBMYC6sEauCv38oGcezZZgpRPNbzjoUQszJUHYDKz6YWxPLJt92HfJeYzlkdFCWNTwqkQQmCy8kbeAVHMrbpFhmqaeFcWgJRSFHYAWOC8UseTr1OepcgjNjmcTYPgxdtwyWk4+FbYVTf4RSRBH3mt3XPv1Ziy1UzLIdMwp0iY56Kjk8HgpdIfXko0C1mFMbknCIlzU5v6iD56x2tfKvscBKDjRSQNaR/FFJ474XkOaWk5akgK+lDYo6KEU8GT/9kXER2DSbcJGwoam/IOLKUeOoto3uWI0Au4rJUVtbvWMaZYO3TTSkpZAUDs3xGRtFmF26uxl1OMIlDEQ2YUK5G9135Q1qRVU3xTmmu7RNbBsc3yh61T9S0uHxtTzLOGZGuSz7FF1jEyEAyNqXz0BTe2202Z0bVWy7eMpiPzzjtL6SXROYCgxxv5AkSQ+mJaN/bw/JEGQ/6pNgHhwahjnxf7JggDnvIjB1+AtPWs/xgT9EsxuL3MEKvtV5HSmma/2p62zCFTiOf8yMAXINAMDAr5iJM9SWW0fd6sH6Zq6VkeiGyy4xyLSfnMwd392/zw7wsQbhg68VjasHZGYDxZQzSMljE+sK3LbswRIHYmdLcZAKc8B5xuyCnvtv4ivHPcwYOQyeRyJB+2v/j44xuQ7IiQG+MIDnkuYQbt4CiXKfjm+hv/yb1S8Nz44B2yvhhC4KiQ8Vbp8ubWQTK3Y0BGo2S8/Tqi5OIm09r9JRmD79t5LWvXDpy/V5CP3IvGm6/uHyS5N3CeymTgzFj4yRZs/jet/6W0tifzihzwV5ahb9q1YuGJgONFjNE4jxpe2W1ubOAUQrZuXBvGpK989zyKHj07mwAcpTBY1PlkC2n/eJSa9RSJSJRSyRRZJ59B8TnfySYG88pbOz+nzJOPUuPuXaTGYpROJslAnBM/9Sz80hN24Ywqj697vqT00/jdsm2DFE0kyIKrPpzArwSei9fop04Dnzmi4FOYIu2NzSSf/yc1JeJjZJTB88k0fhMNdxrh1id186b2nr77xxQ8wAs5XBzgk3nFh5Yv7AdjC1LsbeBeDEw2Nexfp2FbO7x7N3KSsLUOUPvqwBMY3Q0NDZTAwcSey16Ut7jsmMjeLoBV3hhiTASZIAsmaO+e3VgRQF2FlvqR9IuCp+YW3umepVQqRWkc2YWrPFFgEAmYt+ZJLXh/dXRCg03zXgwYJtYOLGcPKilzTusDA1BvfzS6JR914fXtexGl/kARotFCZzQAoEClG0bWxlkYLW1tI+Zs9PDlb6xVXMYhTli2tLbaE+aY4Y5CSl55BZ5F86RJtrdn+59ORSOfAqBGOeeWQzwAIjB3JgSfBwdKCQChjtnHYaFsMsU/rZWlCPgwyfpNEGBwjWP5GGnIy8fO5Yvub4mqNwzn/LhMAqOYj30mxG6xQLMAsSCFXZ4bHaOxfBH85LHEA20YmmGMAMieVcY0N6e04TOmrduU5Kf8ku9JPZeBmDB+ldSND1mNHUpjks+wJ+JgwJ1k4ecfzgP5n2GX5/byebG/j2aE2WDNcMDg+REA6YjNfxEUGNzifsmNbt/Tt5augc9R4Y14GPHR/iqSACSVzrqH+6/W1lkqnbbNp9OtBpgzzB3dbd19TwfZk0ABYcYmdfc/lrHMbvY8HOJOcDQ7jBHmfnuP83TlP20thxl2BlkCYMB5ebnNMm8PmrvAAWEGO7TWWzGPPJsPioZOsXfCvvs+ExZ0jwKuj91bHkyOZox4VTssXS4RawcC/93fUAAR69Yl4d9ekTGN9+yUwoiQeISxR8Og2PNKwMILujp21VOINRxSbRWRGUPSko4/bXjduR7kZyiAMIPtPesHETdfgknw0xj/VF4OIf+FoEqjPeyxlIiucx4r6ynzxYGfQ4wFPGtpSLmio6tvk3M96M/Rkgq49vau/lcNaV6MWG17PA8UW1tGAqwkJszS6ykBM1ekOjvWAE/OfMfmynZxLXlnW1f/n4s86vuWYxp9V1Ssgi+vW/htBH4bVFXMTPMmgDxil5IZ4cAwjkCNAzL7At8oMzEI9jwH0+oQz4Up0+xtXdO3DAMpVK5C1RCnQ609/S+lZeY8w5KvNPLPr+aRMyo4ut+LVMYe5KXYs+H5ptzE2optsvuaZX7hUT3RGjGuDxsMbtSRxT4GwjzZtmzRQU0x6opFlIVIs4ykrAu3yLEZmzVOqUQQEXMqRYXZQ2oG10fYtj/whwsHQDxnsFc1Ujuxe5sxEIkL87xDEGMF0ETJKpy2SxYMqgDLedeKBddFSb0zqor2VAETlt+WAw5ftwEBSA4w3AHOUeUnAPPrKPWdNTKV496yI4JE5WBaiLlT1qx/t9TzQd0vOyAO40PLf3ScStbqiIqf5QBpOWbCKVPs09YJ/JFYmGpAerwBKXVPmgIJaFgayPWoeLMCxs0XmmFdOHlt/wvF+Aj6XsUA4Y5g5IvdNyxeoEi5Kqoqs3nV7YCBwTOcvPQKSDaVztnbrNljzUO8oenSXNTetWFj0AIvVV9ZJvXxmEDfZeua9f0p0zhNk3Ip3ONXOBLmPBELJmzijAGncxwwuEVeisbu9ZsrAQb3N/xecysu6d0V58enUhv/E0eXwRSdDd8fP2aFfV/wtnjhKTuGR1fGbqoXDeFUOru3HHM41AD3Nmno93V0b7jFuVbuz6oCJLfzO69dOCOq0tnYlnkurp+Cf2jlMACEAQy1gjDZvOF/pMCxph2LAhT3c4gda3AqHYGpIwB2b5F/W9++3by8Ev9uiNN3hx/ne1V+ymvnNydV9QhD0LEA4Rg4vl+zSB6K35huh+I0JuLRgzCHNLmd1NlMcczjdJ5NZNq0nsFG6YumhJAwPBChOjwdyDNVU1auWBHf0TAYa6fJv1cT8aVYsCjJG+8U4V2WTscTiG90ab2eseS5fvdUlWzcRQGHLxdFq7eIccuSbjUeu64oIOhpJqPbW3ecnrADAfO1TbPonMk9fW841yv5WVEvK7COw30uVZemIZUO7XCIYw3MQnsNU1xaLWAwb/UBiCPlcT558uYlWIfsKJ+EqVvy6va1659xrlfDZ90Dwm6tvXQ8Im1WJTZVmiVv7ejuX18NIOTyUNeA2Nt24FHxp0Mca2Als6uju+8+51o1fdYtIAyBnUqHhjgTzEgqfeO27dbN1QRCLi91C4i9bUffH/jZsYZhvCAjiauOGfD+hlOu8MI4H7taFEYrZa4zf9sOL78iafmuZSmL27v8/fJ02F2pO0AKbdsxpLUDk/vC9p4Ng2EL1G/99WOyOEtbcNsOVmAt6/K2ng2b/QqrHM/XDyBYecxdZOIkJMd+2Ax9PbK3T5RDmEG0UReADCMCN7A5grO4TOxVJbAEi8Dvjsk9G3rtizXypy4AMfHKXH6sgUWv3rauvjtrBId9bNYFIPt6gxOONbD36/G9EQvbdpCgrzGqK0DsXem6sVnE6YoZfxjIvnM2AUhlJGDnp0xrUFiRBZN+14efFqpNqgsNwQpiXLPMYcMyFrWufbj0u85VjFVdAAL36s2kZiyd3DPwYhXLeoK1CQlMSGBCAhMSmJBAqBL4P3iH6XSOsIpGAAAAAElFTkSuQmCC"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t=void 0;if(-1!==e.indexOf("::"))t="::";else{if(-1===e.indexOf("__"))return e;t="__"}var n=e.split(t);return""===n[0]&&2===n.length?n[1]:(0,b.contains)(w,n[1])?n[0]:e}function s(e){return i(e)}function o(e){return i(e).replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})}function l(e,t,n){void 0===t[n]&&(t[n]={name:n,type:"column",data:[]}),t[n].data.push(e)}function u(e,t,n){var a=e("api/query_results/:id",{id:"@id"},{post:{method:"POST"}}),i=e("api/jobs/:id",{id:"@id"}),u={1:"waiting",2:"processing",3:"done",4:"failed"};return function(){function e(t){r(this,e),this.deferred=n.defer(),this.job={},this.query_result={},this.status="waiting",this.filters=void 0,this.filterFreeze=void 0,this.updatedAt=(0,v.default)(),t&&this.update(t)}return f(e,[{key:"update",value:function(e){if(p(this,e),"query_result"in e){this.status="done",this.filters=void 0,this.filterFreeze=void 0;var t={};(0,b.each)(this.query_result.data.rows,function(e){(0,b.each)(e,function(n,a){var r=null;(0,b.isNumber)(n)?r="float":(0,b.isString)(n)&&n.match(/^\d{4}-\d{2}-\d{2}T/)?(e[a]=v.default.utc(n),r="datetime"):(0,b.isString)(n)&&n.match(/^\d{4}-\d{2}-\d{2}$/)?(e[a]=v.default.utc(n),r="date"):"object"===(void 0===n?"undefined":d(n))&&null!==n?e[a]=JSON.stringify(n):r="string",null!==r&&(void 0!==t[a]&&t[a]!==r?t[a]="string":t[a]=r)})}),(0,b.each)(this.query_result.data.columns,function(e){t[e.name]&&(null!=e.type&&"string"!==e.type||(e.type=t[e.name]))}),this.deferred.resolve(this)}else 3===this.job.status?this.status="processing":this.status=void 0}},{key:"getId",value:function(){var e=null;return"query_result"in this&&(e=this.query_result.id),e}},{key:"cancelExecution",value:function(){i.delete({id:this.job.id})}},{key:"getStatus",value:function(){return this.status||u[this.job.status]}},{key:"getError",value:function(){if("None"!==this.job.error)return this.job.error}},{key:"getLog",value:function(){return this.query_result.data&&this.query_result.data.log&&0!==this.query_result.data.log.length?this.query_result.data.log:null}},{key:"getUpdatedAt",value:function(){return this.query_result.retrieved_at||1e3*this.job.updated_at||this.updatedAt}},{key:"getRuntime",value:function(){return this.query_result.runtime}},{key:"getRawData",value:function(){return this.query_result.data?this.query_result.data.rows:null}},{key:"getData",value:function(){if(!this.query_result.data)return null;var e=this.getFilters(),t=function(e){return e?e.reduce(function(e,t){return e+t.current},""):null}(e);return this.filterFreeze!==t&&(this.filterFreeze=t,e?(e.forEach(function(e){e.multiple&&(0,b.includes)(e.current,x)&&(e.current=e.values.slice(2)),e.multiple&&(0,b.includes)(e.current,q)&&(e.current=[])}),this.filteredData=this.query_result.data.rows.filter(function(t){return e.reduce(function(e,n){return(0,b.isArray)(n.current)||(n.current=[n.current]),e&&(0,b.some)(n.current,function(e){var a=t[n.name];return v.default.isMoment(a)?a.isSame(e):e===a||String(a)===e})},!0)})):this.filteredData=this.query_result.data.rows),this.filteredData}},{key:"isEmpty",value:function(){return null===this.getData()||0===this.getData().length}},{key:"getChartData",value:function(e){var t={};return this.getData().forEach(function(n){var a={},r=void 0,i=0,s={},o=null,u=null;(0,b.each)(n,function(t,n){var l=n.split("::")[0]||n.split("__")[0],c=t,d=n.split("::")[1]||n.split("__")[1];e&&(d=e[n]),"unused"!==d&&("x"===d&&(i=c,a[d]=c),"y"===d&&(null==c&&(c=0),s[l]=c,a[d]=c),"yError"===d&&(o=c,a[d]=c),"series"===d&&(r=String(c)),"size"===d&&(a[d]=c,u=c),"multiFilter"!==d&&"multi-filter"!==d||(r=String(c)))}),void 0===r?(0,b.each)(s,function(e,n){a={x:i,y:e},null!==o&&(a.yError=o),null!==u&&(a.size=u),l(a,t,n)}):l(a,t,r)}),(0,b.sortBy)((0,b.values)(t),"name")}},{key:"getColumns",value:function(){return void 0===this.columns&&this.query_result.data&&(this.columns=this.query_result.data.columns),this.columns}},{key:"getColumnNames",value:function(){return void 0===this.columnNames&&this.query_result.data&&(this.columnNames=this.query_result.data.columns.map(function(e){return e.name})),this.columnNames}},{key:"getColumnCleanNames",value:function(){return this.getColumnNames().map(function(e){return s(e)})}},{key:"getColumnFriendlyNames",value:function(){return this.getColumnNames().map(function(e){return o(e)})}},{key:"getFilters",value:function(){return this.filters||this.prepareFilters(),this.filters}},{key:"prepareFilters",value:function(){if(this.getColumns()){var e=[];this.getColumns().forEach(function(t){var n=t.name,a=n.split("::")[1]||n.split("__")[1];if((0,b.contains)(w,a)){var r={name:n,friendlyName:o(n),column:t,values:[],multiple:"multiFilter"===a||"multi-filter"===a};e.push(r)}},this),this.getRawData().forEach(function(t){e.forEach(function(e){e.values.push(t[e.name]),1===e.values.length&&(e.multiple?e.current=[t[e.name]]:e.current=t[e.name])})}),e.forEach(function(e){e.multiple&&(e.values.unshift(x),e.values.unshift(q))}),e.forEach(function(e){e.values=(0,b.uniq)(e.values,function(e){return v.default.isMoment(e)?e.unix():e})}),this.filters=e}}},{key:"toPromise",value:function(){return this.deferred.promise}},{key:"loadResult",value:function(e){var n=this;a.get({id:this.job.query_result_id},function(e){n.update(e)},function(a){void 0===e&&(e=0),e>3?(y("Connection error while trying to load result",a),n.update({job:{error:"failed communicating with server. Please check your Internet connection and try again.",status:4}})):t(function(){n.loadResult(e+1)},1e3*Math.pow(2,e))})}},{key:"refreshStatus",value:function(e){var n=this;i.get({id:this.job.id},function(a){n.update(a),"processing"===n.getStatus()&&n.job.query_result_id&&"None"!==n.job.query_result_id?n.loadResult():"failed"!==n.getStatus()&&t(function(){n.refreshStatus(e)},3e3)},function(e){y("Connection error",e),n.update({job:{error:"failed communicating with server. Please check your Internet connection and try again.",status:4}})})}},{key:"getLink",value:function(e,t,n){var a="api/queries/"+e+"/results/"+this.getId()+"."+t;return n&&(a=a+"?api_key="+n),a}},{key:"getName",value:function(e,t){return e.replace(" ","_")+(0,v.default)(this.getUpdatedAt()).format("_YYYY_MM_DD")+"."+t}}],[{key:"getById",value:function(t){var n=new e;return a.get({id:t},function(e){n.update(e)}),n}},{key:"get",value:function(t,n,r,i){var s=new e,o={data_source_id:t,query:n,max_age:r};return void 0!==i&&(o.query_id=i),a.post(o,function(e){s.update(e),"job"in e&&s.refreshStatus(n)},function(e){403===e.status?s.update(e.data):400===e.status&&"job"in e.data?s.update(e.data):(y("Unknown error",e),s.update({job:{error:"unknown error occurred. Please try again later.",status:4}}))}),s}}]),e}()}function c(e){e.factory("QueryResult",u)}Object.defineProperty(t,"__esModule",{value:!0});var d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.getColumnCleanName=s,t.default=c;var m=n(24),g=a(m),h=n(0),v=a(h),b=n(5);u.$inject=["$resource","$timeout","$q"];var y=(0,g.default)("redash:services:QueryResult"),w=["filter","multi-filter","multiFilter"],x="*",q="-"},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){e.exports='<div class="container">\n  <overlay ng-if="canCreateQuery === false && query.isNew()">\n    You don\'t have permission to create new queries on any of the data sources available to you. You can either <a\n    href="queries">browse existing queries</a>, or ask for additional permissions from your Redash admin.\n  </overlay>\n  <overlay ng-if="noDataSources && currentUser.isAdmin">\n    Looks like no data sources were created yet (or none of them available to the group(s) you\'re member of). Please\n    create one first, and then start querying.\n    <br/>\n    <a href="data_sources/new" class="btn btn-primary">Create Data Source</a> <a href="groups" class="btn btn-default">Manage\n    Group Permissions</a>\n  </overlay>\n  <overlay ng-if="noDataSources && !currentUser.isAdmin">\n    Looks like no data sources were created yet (or none of them available to the group(s) you\'re member of). Please ask\n    your Redash admin to create one first.\n  </overlay>\n\n  <alert-unsaved-changes ng-if="canEdit" is-dirty="isDirty"></alert-unsaved-changes>\n\n  <div class="row bg-white p-10 m-b-10">\n    <div class="col-sm-9">\n      <h3>\n        <edit-in-place editable="canEdit" done="saveName" ignore-blanks="true" value="query.name"></edit-in-place>\n        <span class="label label-default" ng-if="query.is_draft && !query.is_archived">Unpublished</span>\n        <span class="label label-warning" ng-if="query.is_archived" uib-popover="This query is archived and can\'t be used in dashboards, and won\'t appear in search results." popover-placement="right" popover-trigger="\'mouseenter\'">Archived</span>\n      </h3>\n      <p>\n        <em>\n          <edit-in-place editable="canEdit"\n                         done="saveDescription"\n                         editor="textarea"\n                         placeholder="No description"\n                         ignore-blanks=\'false\'\n                         value="query.description"\n                         markdown="true">\n          </edit-in-place>\n        </em>\n\n      <ul class="list-inline m-t-20">\n        <li>\n          <span class="zmdi zmdi-account"></span>\n          <span class="text-muted">Created By </span>\n          <strong>{{query.user.name}}</strong>\n        </li>\n        <li ng-if="query.last_modified_by && query.user.id != query.last_modified_by.id">\n          <span class="zmdi zmdi-account"></span>\n          <span class="text-muted">Last Modified By </span>\n          <strong>{{query.last_modified_by.name}}</strong>\n        </li>\n        <li>\n          <span class="zmdi zmdi-time"></span>\n          <span class="text-muted">Updated at </span>\n          <strong>\n            <rd-time-ago value="query.updated_at"></rd-time-ago>\n          </strong>\n        </li>\n        <li>\n          <span class="zmdi zmdi-time"></span>\n          <span class="text-muted">Created at </span>\n          <strong>\n            <rd-time-ago value="query.created_at"></rd-time-ago>\n          </strong>\n        </li>\n      </ul>\n      </p>\n    </div>\n    <div class="col-sm-3 text-right">\n      <h3>\n        <span ng-show="query.id && canViewSource">\n            <a ng-show="!sourceMode"\n              ng-href="{{query.getUrl(true, selectedTab)}}" class="btn btn-default">Show Source\n            </a>\n            <a ng-show="sourceMode"\n              ng-href="{{query.getUrl(false, selectedTab)}}" class="btn btn-default">Hide Source\n            </a>\n        </span>\n      </h3>\n    </div>\n  </div>\n\n  \x3c!-- editor --\x3e\n  <div class="container">\n      <div class="row bg-white p-b-5" ng-if="sourceMode" resizable r-directions="[\'bottom\']" r-height="300" style="min-height:100px;">\n        <schema-browser class="col-md-3 hidden-sm hidden-xs schema-container"\n                        schema="schema"\n                        on-refresh="refreshSchema()"\n                        ng-show="hasSchema">\n        </schema-browser>\n\n        <div ng-class="editorSize" style="height:100%;">\n            <div class="p-5">\n              <button type="button" class="btn btn-primary btn-s" ng-disabled="queryExecuting || !canExecuteQuery()"\n                      ng-click="executeQuery()">\n                <span class="zmdi zmdi-play"></span> Execute\n              </button>\n\n              <button type="button" class="btn btn-default btn-s" ng-click="formatQuery()">\n                <span class="zmdi zmdi-format-indent-increase"></span> Format Query\n              </button>\n\n              <i class="fa fa-database"></i>\n              <span class="text-muted">Data Source</span>\n              <select ng-disabled="!isQueryOwner" ng-model="query.data_source_id" ng-change="updateDataSource()"\n                      ng-options="ds.id as ds.name for ds in dataSources"></select>\n\n              <div class="pull-right">\n                <button class="btn btn-s btn-default" ng-click="togglePublished()" ng-if="query.is_draft && query.id != undefined && (isQueryOwner || currentUser.hasPermission(\'admin\'))">\n                  <span class="fa fa-paper-plane"></span> Publish\n                </button>\n                <button class="btn btn-s btn-default" ng-click="duplicateQuery()" ng-disabled="query.id === undefined || !canForkQuery()">\n                  <span class="zmdi zmdi-arrow-split"></span> Fork\n                </button>\n                <button class="btn btn-default" ng-show="canEdit" ng-click="saveQuery()">\n                  <span class="fa fa-floppy-o"> </span> Save<span\n                  ng-show="isDirty">&#42;</span>\n                </button>\n                <div ng-if="query.id != undefined" class="btn-group" role="group" uib-dropdown>\n                  <button class="btn btn-default btn-sm dropdown-toggle" uib-dropdown-toggle>\n                    <span class="zmdi zmdi-more"></span>\n                  </button>\n                  <ul class="dropdown-menu pull-right" uib-dropdown-menu>\n                    <li ng-if="!query.is_archived && query.id != undefined && (isQueryOwner || currentUser.hasPermission(\'admin\'))"><a ng-click="archiveQuery()">Archive Query</a></li>\n                    <li ng-if="!query.is_archived && query.id != undefined && (isQueryOwner || currentUser.hasPermission(\'admin\')) && showPermissionsControl"><a ng-click="showManagePermissionsModal()">Manage Permissions</a></li>\n                    <li ng-if="!query.is_draft && query.id != undefined && (isQueryOwner || currentUser.hasPermission(\'admin\'))"><a ng-click="togglePublished()">Unpublish Query</a></li>\n                    <li ng-if="query.id != undefined"><a ng-click="showApiKey()">Show API Key</a></li>\n                  </ul>\n                </div>\n              </div>\n            </div>\n            <p style="height:calc(100% - 40px);">\n              <query-editor query="query"\n                            schema="schema"\n                            syntax="dataSource.syntax"></query-editor>\n            </p>\n        </div>\n      </div>\n  </div>\n  \x3c!-- end of editor --\x3e\n\n  \x3c!-- Query Details--\x3e\n  <div class="container m-b-5 p-t-5 bg-ace" ng-if="sourceMode">\n  </div>\n  \x3c!-- End of Query Details--\x3e\n\n  <div class="tile">\n    <div class="t-header bg-ace">\n      <div class="pull-right">\n        <button class="btn btn-sm btn-default" ng-click="executeQuery()"\n                ng-disabled="queryExecuting || !canExecuteQuery()" title="Refresh Dataset"\n                ng-if="!sourceMode"><span\n          class="zmdi zmdi-refresh"></span></button>\n        <div class="btn-group" uib-dropdown>\n          <button type="button" class="btn btn-default btn-sm dropdown-toggle"\n                  ng-disabled="queryExecuting || !queryResult.getData()" aria-haspopup="true"\n                  uib-dropdown-toggle aria-expanded="false">\n            Download Dataset <span class="caret"></span>\n          </button>\n          <ul class="dropdown-menu pull-right" uib-dropdown-menu>\n            <li>\n              <a query-result-link target="_self">\n                <span class="fa fa-file-o"></span> Download as CSV File\n              </a>\n            </li>\n            <li>\n              <a query-result-link file-type="xlsx" target="_self">\n                <span class="fa fa-file-excel-o"></span> Download as Excel File\n              </a>\n            </li>\n          </ul>\n        </div>\n      </div>\n      <ul class="list-inline">\n        <li>\n          \x3c!-- runtime --\x3e\n          <span class="zmdi zmdi-timer"></span>\n          <span class="text-muted">Runtime </span>\n          <strong ng-show="!queryExecuting">{{queryResult.getRuntime() | durationHumanize}}</strong>\n          <span ng-show="queryExecuting">Running&hellip;</span>\n        </li>\n        <li>\n          \x3c!-- rows --\x3e\n          <span class="zmdi zmdi-format-align-justify"></span>\n          <span class="text-muted">Rows </span><strong>{{queryResult.getData().length}}</strong>\n        </li>\n        <li>\n          \x3c!-- refresh schedule --\x3e\n          <span class="zmdi zmdi-refresh"></span>\n          <span class="text-muted">Refresh Schedule</span>\n          <a ng-click="openScheduleForm()" ng-if="!query.isNew()">{{query.schedule | scheduleHumanize}}</a>\n          <span ng-if="query.isNew()">Never</span>\n        </li>\n        <li>\n          \x3c!-- last update --\x3e\n          <span class="zmdi zmdi-time"></span>\n          <span class="text-muted">Last update </span>\n          <strong>\n            <rd-time-ago value="queryResult.query_result.retrieved_at"></rd-time-ago>\n          </strong>\n        </li>\n      </ul>\n\n    </div>\n    <div class="t-body">\n      <div class="row">\n        <div class="col-lg-12">\n          <parameters parameters="query.getParametersDefs()" sync-values="!query.isNew()" editable="sourceMode && canEdit"></parameters>\n          \x3c!-- Query Execution Status --\x3e\n          <div class="alert alert-info" ng-show="queryResult.getStatus() == \'processing\'">\n            Executing query&hellip;\n            <rd-timer timestamp="queryResult.getUpdatedAt()"></rd-timer>\n            <button type="button" class="btn btn-warning btn-xs pull-right" ng-disabled="cancelling"\n                    ng-click="cancelExecution()">Cancel\n            </button>\n          </div>\n          <div class="alert alert-info" ng-show="queryResult.getStatus() == \'waiting\'">\n            Query in queue&hellip;\n            <rd-timer timestamp="queryResult.getUpdatedAt()"></rd-timer>\n            <button type="button" class="btn btn-warning btn-xs pull-right" ng-disabled="cancelling"\n                    ng-click="cancelExecution()">Cancel\n            </button>\n          </div>\n          <div class="alert alert-danger" ng-show="queryResult.getError()">Error running query: <strong>{{queryResult.getError()}}</strong>\n          </div>\n          \x3c!-- End of Query Execution Status --\x3e\n\n          \x3c!-- tabs and data --\x3e\n          <div ng-if="showDataset">\n            <div class="row p-10" ng-show="showLog">\n              <div class="col-lg-12">\n                <p>Log Information:</p>\n                <p ng-repeat="l in queryResult.getLog()">{{l}}</p>\n              </div>\n            </div>\n            <div class="row">\n              <div class="col-lg-12">\n                <ul class="tab-nav">\n                  <rd-tab tab-id="table" name="Table" base-path="query.getUrl(sourceMode)"></rd-tab>\n                  <rd-tab tab-id="{{vis.id}}" name="{{vis.name}}" ng-if="vis.type!=\'TABLE\'" base-path="query.getUrl(sourceMode)"\n                          ng-repeat="vis in query.visualizations">\n                          <span class="remove" ng-click="deleteVisualization($event, vis)"\n                                ng-show="canEdit"> &times;</span>\n                  </rd-tab>\n                  <li class="rd-tab"><a ng-click="openVisualizationEditor()" ng-if="sourceMode && canEdit">&plus; New Visualization</a></li>\n                </ul>\n              </div>\n            </div>\n            <div class="row">\n              <div class="col-lg-12">\n                <div ng-show="selectedTab == \'table\'">\n                  <filters filters="filters"></filters>\n                  <grid-renderer query-result="queryResult" items-per-page="50"></grid-renderer>\n                  \x3c!-- the ng-repeat is a lame hack to find the table visualization... --\x3e\n                  <div class="bg-ace p-5" ng-repeat="vis in query.visualizations" ng-if="vis.type == \'TABLE\'">\n                    <button class="btn btn-default" ng-if="!query.isNew()" ng-click="showEmbedDialog(query, vis)"><i class="zmdi zmdi-code"></i> Embed</button>\n                  </div>\n                </div>\n                <div ng-if="selectedTab == vis.id" ng-repeat="vis in query.visualizations">\n                  <visualization-renderer visualization="vis" query-result="queryResult"></visualization-renderer>\n                  <div class="bg-ace p-5">\n                    <button class="btn btn-default" ng-click="openVisualizationEditor(vis)" ng-if="canEdit">Edit</button>\n                    <button class="btn btn-default" ng-click="showEmbedDialog(query, vis)"><i class="zmdi zmdi-code"></i> Embed</button>\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};n(293);var r=n(304),i=function(e){return e&&e.__esModule?e:{default:e}}(r);i.default.config(["$locationProvider","$compileProvider","uiSelectConfig","toastrConfig",function(e,t,n,r){t.debugInfoEnabled(!1),t.aHrefSanitizationWhitelist(/^\s*(https?|http|data):/),e.html5Mode(!0),n.theme="bootstrap",a(r,{positionClass:"toast-bottom-right",timeOut:2e3})}]),i.default.run(["$templateCache","OfflineListener",function(e,t){var n=e.get("bootstrap/match.tpl.html");n=n.replace("glyphicon glyphicon-remove","fa fa-remove"),e.put("bootstrap/match.tpl.html",n)}]),t.default=i.default},function(e,t,n){"use strict";n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(301),n(302),n(303)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){return e.keys().map(e).map(function(e){return e.default}).map(function(e){return e(U)})}Object.defineProperty(t,"__esModule",{value:!0}),n(305),n(331);var i=n(24),s=a(i),o=n(19),l=a(o),u=n(335),c=a(u),d=n(337),p=a(d),f=n(339),m=a(f),g=n(341),h=a(g),v=n(343),b=a(v),y=n(345),w=a(y),x=n(347),q=a(x),_=n(349),$=a(_),k=n(351),z=a(k);n(352),n(226),n(356),n(357);var A=n(358),S=a(A),C=n(5);n(359);var j=n(364),P=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(j),E=n(366),M=a(E),R=n(367),T=a(R),D=n(373),O=a(D),I=(0,s.default)("redash:config"),N=[p.default,m.default,c.default,h.default,w.default,b.default,"angularMoment",q.default,"ui.ace",$.default,"angularResizable",z.default,"ui.sortable",S.default.name],U=l.default.module("app",N);(0,M.default)(U),function(){r(n(441))}(),function(){(0,C.each)(P,function(e,t){U.filter(t,function(){return e})})}(),(0,T.default)(U),(0,O.default)(U),function(){r(n(374))}(),function(){r(n(671)).forEach(function(e){U.config(["$routeProvider",function(t){(0,C.each)(e,function(e,n){I("Registering route: %s",n),e.template="<app-header></app-header><route-status></route-status>"+e.template+"<footer></footer>",e.authenticated=!0,t.when(n,e)})}])})}(),function(){r(n(462))}(),t.default=U},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){function a(e){return n(r(e))}function r(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./af":111,"./af.js":111,"./ar":112,"./ar-dz":113,"./ar-dz.js":113,"./ar-kw":114,"./ar-kw.js":114,"./ar-ly":115,"./ar-ly.js":115,"./ar-ma":116,"./ar-ma.js":116,"./ar-sa":117,"./ar-sa.js":117,"./ar-tn":118,"./ar-tn.js":118,"./ar.js":112,"./az":119,"./az.js":119,"./be":120,"./be.js":120,"./bg":121,"./bg.js":121,"./bn":122,"./bn.js":122,"./bo":123,"./bo.js":123,"./br":124,"./br.js":124,"./bs":125,"./bs.js":125,"./ca":126,"./ca.js":126,"./cs":127,"./cs.js":127,"./cv":128,"./cv.js":128,"./cy":129,"./cy.js":129,"./da":130,"./da.js":130,"./de":131,"./de-at":132,"./de-at.js":132,"./de-ch":133,"./de-ch.js":133,"./de.js":131,"./dv":134,"./dv.js":134,"./el":135,"./el.js":135,"./en-au":136,"./en-au.js":136,"./en-ca":137,"./en-ca.js":137,"./en-gb":138,"./en-gb.js":138,"./en-ie":139,"./en-ie.js":139,"./en-nz":140,"./en-nz.js":140,"./eo":141,"./eo.js":141,"./es":142,"./es-do":143,"./es-do.js":143,"./es.js":142,"./et":144,"./et.js":144,"./eu":145,"./eu.js":145,"./fa":146,"./fa.js":146,"./fi":147,"./fi.js":147,"./fo":148,"./fo.js":148,"./fr":149,"./fr-ca":150,"./fr-ca.js":150,"./fr-ch":151,"./fr-ch.js":151,"./fr.js":149,"./fy":152,"./fy.js":152,"./gd":153,"./gd.js":153,"./gl":154,"./gl.js":154,"./gom-latn":155,"./gom-latn.js":155,"./he":156,"./he.js":156,"./hi":157,"./hi.js":157,"./hr":158,"./hr.js":158,"./hu":159,"./hu.js":159,"./hy-am":160,"./hy-am.js":160,"./id":161,"./id.js":161,"./is":162,"./is.js":162,"./it":163,"./it.js":163,"./ja":164,"./ja.js":164,"./jv":165,"./jv.js":165,"./ka":166,"./ka.js":166,"./kk":167,"./kk.js":167,"./km":168,"./km.js":168,"./kn":169,"./kn.js":169,"./ko":170,"./ko.js":170,"./ky":171,"./ky.js":171,"./lb":172,"./lb.js":172,"./lo":173,"./lo.js":173,"./lt":174,"./lt.js":174,"./lv":175,"./lv.js":175,"./me":176,"./me.js":176,"./mi":177,"./mi.js":177,"./mk":178,"./mk.js":178,"./ml":179,"./ml.js":179,"./mr":180,"./mr.js":180,"./ms":181,"./ms-my":182,"./ms-my.js":182,"./ms.js":181,"./my":183,"./my.js":183,"./nb":184,"./nb.js":184,"./ne":185,"./ne.js":185,"./nl":186,"./nl-be":187,"./nl-be.js":187,"./nl.js":186,"./nn":188,"./nn.js":188,"./pa-in":189,"./pa-in.js":189,"./pl":190,"./pl.js":190,"./pt":191,"./pt-br":192,"./pt-br.js":192,"./pt.js":191,"./ro":193,"./ro.js":193,"./ru":194,"./ru.js":194,"./sd":195,"./sd.js":195,"./se":196,"./se.js":196,"./si":197,"./si.js":197,"./sk":198,"./sk.js":198,"./sl":199,"./sl.js":199,"./sq":200,"./sq.js":200,"./sr":201,"./sr-cyrl":202,"./sr-cyrl.js":202,"./sr.js":201,"./ss":203,"./ss.js":203,"./sv":204,"./sv.js":204,"./sw":205,"./sw.js":205,"./ta":206,"./ta.js":206,"./te":207,"./te.js":207,"./tet":208,"./tet.js":208,"./th":209,"./th.js":209,"./tl-ph":210,"./tl-ph.js":210,"./tlh":211,"./tlh.js":211,"./tr":212,"./tr.js":212,"./tzl":213,"./tzl.js":213,"./tzm":214,"./tzm-latn":215,"./tzm-latn.js":215,"./tzm.js":214,"./uk":216,"./uk.js":216,"./ur":217,"./ur.js":217,"./uz":218,"./uz-latn":219,"./uz-latn.js":219,"./uz.js":218,"./vi":220,"./vi.js":220,"./x-pseudo":221,"./x-pseudo.js":221,"./yo":222,"./yo.js":222,"./zh-cn":223,"./zh-cn.js":223,"./zh-hk":224,"./zh-hk.js":224,"./zh-tw":225,"./zh-tw.js":225};a.keys=function(){return Object.keys(i)},a.resolve=r,e.exports=a,a.id=354},,,,,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=n(19),s=a(i),o=n(14),l=a(o),u=n(360),c=a(u);s.default.module("ui.sortable",[]).value("uiSortableConfig",{items:"> [ng-repeat],> [data-ng-repeat],> [x-ng-repeat]"}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(e,t,n){return{require:"?ngModel",scope:{ngModel:"=",uiSortable:"="},link:function(a,i,o,u){function d(e,t){var n="function"==typeof e,a="function"==typeof t;return n&&a?function(){e.apply(this,arguments),t.apply(this,arguments)}:a?t:e}function p(e){var t=e.data("ui-sortable");return t&&"object"===(void 0===t?"undefined":r(t))&&"ui-sortable"===t.widgetFullName?t:null}function f(t,n){return C[t]?("stop"===t&&(n=d(n,function(){a.$apply()}),n=d(n,x)),n=d(C[t],n)):j[t]&&(n=j[t](n)),n||"items"!==t&&"ui-model-items"!==t||(n=e.items),n}function m(e,t,n){function a(e,t){t in A||(A[t]=null)}s.default.forEach(C,a);var r=null;if(t){var i=void 0;s.default.forEach(t,function(t,n){if(!(e&&n in e)){if(n in S)return void(A[n]="ui-floating"===n?"auto":f(n,void 0));i||(i=(0,c.default)().options);var a=i[n];a=f(n,a),r||(r={}),r[n]=a,A[n]=a}})}return s.default.forEach(e,function(e,t){if(t in S)return"ui-floating"!==t||!1!==e&&!0!==e||!n||(n.floating=e),void(A[t]=f(t,e));e=f(t,e),r||(r={}),r[t]=e,A[t]=e}),r}function g(e){var t=e.sortable("option","placeholder");if(t&&t.element&&"function"==typeof t.element){var n=t.element();return n=(0,l.default)(n)}return null}function h(e,t){var n=A["ui-model-items"].replace(/[^,]*>/g,"");return e.find('[class="'+t.attr("class")+'"]:not('+n+")")}function v(e,t){var n=e.sortable("option","helper");return"clone"===n||"function"==typeof n&&t.item.sortable.isCustomHelperUsed()}function b(e,t,n){var a=null;return v(e,t)&&"parent"===e.sortable("option","appendTo")&&(a=n.last()),a}function y(e){return/left|right/.test(e.css("float"))||/inline|table-cell/.test(e.css("display"))}function w(e,t){for(var n=null,a=0;a<e.length;a++){var r=e[a];if(r.element[0]===t[0]){n=r.scope;break}}return n}function x(e,t){t.item.sortable._destroy()}function q(e){return e.parent().find(A["ui-model-items"]).index(e)}function _(){a.$watchCollection("ngModel",function(){t(function(){p(i)&&i.sortable("refresh")},0,!1)}),C.start=function(e,t){if("auto"===A["ui-floating"]){var n=t.item.siblings();p((0,l.default)(e.target)).floating=y(n)}var a=q(t.item);t.item.sortable={model:u.$modelValue[a],index:a,source:t.item.parent(),sourceModel:u.$modelValue,cancel:function(){t.item.sortable._isCanceled=!0},isCanceled:function(){return t.item.sortable._isCanceled},isCustomHelperUsed:function(){return!!t.item.sortable._isCustomHelperUsed},_isCanceled:!1,_isCustomHelperUsed:t.item.sortable._isCustomHelperUsed,_destroy:function(){s.default.forEach(t.item.sortable,function(e,n){t.item.sortable[n]=void 0})}}},C.activate=function(e,t){z=i.contents();var n=g(i);if(n&&n.length){var r=h(i,n);z=z.not(r)}var s=t.item.sortable._connectedSortables||[];s.push({element:i,scope:a}),t.item.sortable._connectedSortables=s},C.update=function(e,t){if(!t.item.sortable.received){t.item.sortable.dropindex=q(t.item);var n=t.item.parent();t.item.sortable.droptarget=n;var r=w(t.item.sortable._connectedSortables,n);t.item.sortable.droptargetModel=r.ngModel,i.sortable("cancel")}var s=!t.item.sortable.received&&b(i,t,z);s&&s.length&&(z=z.not(s)),z.appendTo(i),t.item.sortable.received&&(z=null),t.item.sortable.received&&!t.item.sortable.isCanceled()&&a.$apply(function(){u.$modelValue.splice(t.item.sortable.dropindex,0,t.item.sortable.moved)})},C.stop=function(e,t){if(!t.item.sortable.received&&"dropindex"in t.item.sortable&&!t.item.sortable.isCanceled())a.$apply(function(){u.$modelValue.splice(t.item.sortable.dropindex,0,u.$modelValue.splice(t.item.sortable.index,1)[0])});else if((!("dropindex"in t.item.sortable)||t.item.sortable.isCanceled())&&!s.default.equals(i.contents(),z)){var n=b(i,t,z);n&&n.length&&(z=z.not(n)),z.appendTo(i)}z=null},C.receive=function(e,t){t.item.sortable.received=!0},C.remove=function(e,t){"dropindex"in t.item.sortable||(i.sortable("cancel"),t.item.sortable.cancel()),t.item.sortable.isCanceled()||a.$apply(function(){t.item.sortable.moved=u.$modelValue.splice(t.item.sortable.index,1)[0]})},j.helper=function(e){return e&&"function"==typeof e?function(t,n){var a=n.sortable,r=q(n);n.sortable={model:u.$modelValue[r],index:r,source:n.parent(),sourceModel:u.$modelValue,_restore:function(){s.default.forEach(n.sortable,function(e,t){n.sortable[t]=void 0}),n.sortable=a}};var i=e.apply(this,arguments);return n.sortable._restore(),n.sortable._isCustomHelperUsed=n!==i,i}:e},a.$watchCollection("uiSortable",function(e,t){var n=p(i);if(n){var a=m(e,t,n);a&&i.sortable("option",a)}},!0),m(A)}function $(){u?_():n.info("ui.sortable: ngModel not provided!",i),i.sortable(A)}function k(){return(!a.uiSortable||!a.uiSortable.disabled)&&($(),k.cancelWatcher(),k.cancelWatcher=s.default.noop,!0)}var z=void 0;i=(0,l.default)(i);var A={},S={"ui-floating":void 0,"ui-model-items":e.items},C={receive:null,remove:null,start:null,stop:null,update:null},j={helper:null};s.default.extend(A,S,e,a.uiSortable),k.cancelWatcher=s.default.noop,k()||(k.cancelWatcher=a.$watch("uiSortable.disabled",k))}}}])},,,,,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){var t="";if(void 0===e)t="-";else if(e<60){var n=Math.round(e);t=n+"s"}else if(e>86400){var a=Math.round(parseFloat(e)/60/60/24);t=a+"days"}else if(e>=3600){var r=Math.round(parseFloat(e)/60/60);t=r+"h"}else{var i=Math.round(parseFloat(e)/60);t=i+"m"}return t}function i(e){if(null===e)return"Never";if(null!==e.match(/\d\d:\d\d/)){var t=e.split(":");return"Every day at "+m.default.utc().hour(t[0]).minute(t[1]).local().format("HH:mm")}return"Every "+r(parseInt(e,10))}function s(e){return e.replace(/_/g," ").replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})}function o(e){return 0===e?0:1===e?6:2===e?12:e}function l(e){return e?(0,h.default)(e):null}function u(e){return e.replace(b,"$1<a href='$2' target='_blank'>$2</a>")}function c(e,t){if(void 0===e)return e;var n=void 0;n=t instanceof Array?function(e){return-1===t.indexOf(e)}:function(e){return t!==e};for(var a=[],r=0;r<e.length;r+=1)n(e[r])&&a.push(e[r]);return a}function d(e){return!(0,v.isEmpty)(e)}function p(e,t){return e.$touched&&e.$invalid||t.$submitted}Object.defineProperty(t,"__esModule",{value:!0}),t.durationHumanize=r,t.scheduleHumanize=i,t.toHuman=s,t.colWidth=o,t.capitalize=l,t.linkify=u,t.remove=c,t.notEmpty=d,t.showError=p;var f=n(0),m=a(f),g=n(365),h=a(g),v=n(5),b=/(^|[\s\n]|<br\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi},,function(e,t,n){"use strict";function a(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(e,t,n,a){var r=function(t){a.$setValidity("compareTo",t===e.otherModelValue)};e.$watch("otherModelValue",function(){r(a.$modelValue)}),a.$parsers.push(function(e){return r(e),e})}}}function r(e){return{link:function(t,n){e(function(){n[0].focus()})}}}function i(e){return{title:"Redash",set:function(t){this.title=t,e.$broadcast("$titleChange")},get:function(){return this.title}}}function s(e,t){return{restrict:"E",link:function(n,a){function r(){var e=t.get();c("Updating title to: %s",e),a.text(e)}e.$on("$routeChangeSuccess",function(e,n){n.title&&t.set(n.title)}),e.$on("$titleChange",r)}}}function o(e){e.factory("Title",i),e.directive("title",s),e.directive("compareTo",a),e.directive("autofocus",r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var l=n(24),u=function(e){return e&&e.__esModule?e:{default:e}}(l);r.$inject=["$timeout"],s.$inject=["$rootScope","Title"],i.$inject=["$rootScope"];var c=(0,u.default)("redash:directives")},function(e,t,n){"use strict";function a(e){e.filter("markdown",["$sce","clientConfig",function(e,t){return function(n){if(!n)return"";var a=r.markdown.toHTML(String(n));return t.allowScriptsInUserInput&&(a=e.trustAsHtml(a)),a}}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=n(368)},,,,,,function(e,t,n){"use strict";function a(e){e.filter("toMilliseconds",function(){return function(e){return 1e3*e}}),e.filter("dateTime",["clientConfig",function(e){return function(t){return t?(0,i.default)(t).format(e.dateTimeFormat):"-"}}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=n(0),i=function(e){return e&&e.__esModule?e:{default:e}}(r)},function(e,t,n){function a(e){return n(r(e))}function r(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./alerts/alert-subscriptions/index.js":375,"./app-header/index.js":377,"./cancel-query-button/index.js":380,"./dashboards/add-widget-dialog.js":381,"./dashboards/edit-dashboard-dialog.js":383,"./dashboards/widget.js":385,"./dynamic-form.js":388,"./dynamic-table/index.js":391,"./edit-in-place.js":394,"./email-settings-warning/index.js":395,"./error-messages.js":396,"./filters.js":397,"./footer/index.js":399,"./groups/edit-group-dialog.js":401,"./groups/group-name.js":403,"./overlay.js":404,"./page-header/index.js":405,"./paginator.js":407,"./parameters.js":408,"./permissions-editor/index.js":412,"./queries/alert-unsaved-changes.js":414,"./queries/api-key-dialog.js":415,"./queries/embed-code-dialog.js":416,"./queries/query-editor.js":418,"./queries/query-results-link.js":424,"./queries/schedule-dialog.js":425,"./queries/schema-browser.js":427,"./queries/visualization-embed.js":429,"./query-link.js":431,"./rd-tab/index.js":432,"./rd-time-ago.js":433,"./rd-timer.js":434,"./route-status.js":435,"./settings-screen.js":436,"./sort-icon.js":438,"./tab-nav/index.js":439,"./visualization-name.js":440};a.keys=function(){return Object.keys(i)},a.resolve=r,e.exports=a,a.id=374},function(e,t,n){"use strict";function a(e,t,n,a,r,s,o){"ngInject";e.newSubscription={},e.subscribers=[],e.destinations=[],e.currentUser=a,t.all([s.query().$promise,r.query({alertId:e.alertId}).$promise]).then(function(t){var n=t[0],r=t[1],s=function(e){return e.destination&&e.destination.id},o=(0,i.compact)(r.map(s)),l=(0,i.compact)(r.map(function(e){return!e.destination&&e.user.id}));e.destinations=n.filter(function(e){return!(0,i.contains)(o,e.id)}),(0,i.contains)(l,a.id)||e.destinations.unshift({user:{name:a.name}}),e.newSubscription.destination=e.destinations[0],e.subscribers=r}),e.destinationsDisplay=function(e){if(!e)return"";var t=e;return e.destination?t=t.destination:t.user&&(t={name:e.user.name+" (Email)",icon:"fa-envelope",type:"user"}),n.trustAsHtml('<i class="fa '+t.icon+'"></i>&nbsp;'+t.name)},e.saveSubscriber=function(){var t=new r({alert_id:e.alertId});e.newSubscription.destination.id&&(t.destination_id=e.newSubscription.destination.id),t.$save(function(){o.success("Subscribed."),e.subscribers.push(t),e.destinations=(0,i.without)(e.destinations,e.newSubscription.destination),e.destinations.length>0?e.newSubscription.destination=e.destinations[0]:e.newSubscription.destination=void 0},function(){o.error("Failed saving subscription.")})},e.unsubscribe=function(t){var n=t.destination,r=t.user;t.$delete(function(){o.success("Unsubscribed"),e.subscribers=(0,i.without)(e.subscribers,t),n?e.destinations.push(n):r.id===a.id&&e.destinations.push({user:{name:a.name}}),1===e.destinations.length&&(e.newSubscription.destination=e.destinations[0])},function(){o.error("Failed unsubscribing.")})}}function r(e){e.directive("alertSubscriptions",function(){return{restrict:"E",replace:!0,scope:{alertId:"="},template:o.default,controller:a}})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(5),s=n(376),o=function(e){return e&&e.__esModule?e:{default:e}}(s);a.$inject=["$scope","$q","$sce","currentUser","AlertSubscription","Destination","toastr"]},function(e,t){e.exports='<div class="p-5">\n  <h4>Notifications</h4>\n\n  <div>\n    <ui-select ng-model="newSubscription.destination" ng-disabled="destinations.length == 0">\n      <ui-select-match><span ng-bind-html="destinationsDisplay($select.selected)"></span></ui-select-match>\n      <ui-select-choices repeat="d in destinations">\n        <span ng-bind-html="destinationsDisplay(d)"></span>\n      </ui-select-choices>\n    </ui-select>\n  </div>\n  <div class="m-t-5">\n    <button class="btn btn-default" ng-click="saveSubscriber()" ng-disabled="destinations.length == 0" style="width:50%;">Add</button>\n    <span class="pull-right m-t-5">\n      <a href="destinations/new" ng-if="currentUser.isAdmin">Create New Destination</a>\n    </span>\n  </div>\n\n  <hr/>\n\n  <div>\n    <div class="list-group-item" ng-repeat="subscriber in subscribers">\n      <span ng-bind-html="destinationsDisplay(subscriber)"></span>\n      <button class="btn btn-xs btn-danger pull-right" ng-click="unsubscribe(subscriber)" ng-if="currentUser.isAdmin || currentUser.id == subscriber.user.id">Remove</button>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a,r,i,s){var o=this;this.logoUrl=u.default,this.basePath=i.basePath,this.currentUser=r,this.showQueriesMenu=r.hasPermission("view_query"),this.showAlertsLink=r.hasPermission("list_alerts"),this.showNewQueryMenu=r.hasPermission("create_query"),this.showSettingsMenu=r.hasPermission("list_users"),this.showDashboardsMenu=r.hasPermission("list_dashboards"),this.reloadDashboards=function(){p("Reloading dashboards."),o.dashboards=s.recent()},this.reloadDashboards(),e.$on("reloadDashboards",this.reloadDashboards),this.newDashboard=function(){n.open({component:"editDashboardDialog",resolve:{dashboard:function(){return{name:null,layout:null}}}})},this.searchQueries=function(){t.path("/queries/search").search({q:o.term})},this.logout=function(){a.logout()}}function i(e){e.component("appHeader",{template:d.default,controller:r})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=n(24),o=a(s),l=n(70),u=a(l),c=n(378),d=a(c);n(379),r.$inject=["$rootScope","$location","$uibModal","Auth","currentUser","clientConfig","Dashboard"];var p=(0,o.default)("redash:appHeader")},function(e,t){e.exports='<nav class="navbar navbar-inverse navbar-fixed-top app-header" role="navigation">\n  <div class="container">\n    <div class="navbar-header">\n      <button type="button" class="navbar-toggle" ng-click="isNavOpen = !isNavOpen">\n        <span class="sr-only">Toggle navigation</span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n        <span class="icon-bar"></span>\n      </button>\n      <a class="navbar-brand" ng-href="{{$ctrl.basePath}}"><img ng-src="{{$ctrl.logoUrl}}"/></a>\n    </div>\n    <div class="collapse navbar-collapse" uib-collapse="!isNavOpen">\n      <ul class="nav navbar-nav">\n        <li class="dropdown" ng-show="$ctrl.showDashboardsMenu" uib-dropdown>\n          <a href="#" class="dropdown-toggle" uib-dropdown-toggle title="Dashboards">\n            <span class="visible-xs visible-md visible-lg">Dashboards <b class="caret"></b></span>\n            <span class="visible-sm"><i class="zmdi zmdi-view-dashboard"></i> <b class="caret"></b></span>\n          </a>\n          <ul class="dropdown-menu" uib-dropdown-menu>\n            <li><a ng-show="$ctrl.currentUser.hasPermission(\'create_dashboard\')" ng-click="$ctrl.newDashboard()">New Dashboard</a></li>\n            <li><a href="dashboards">Dashboards</a></li>\n            <li class="divider" ng-if="$ctrl.dashboards | notEmpty"></li>\n            <li ng-repeat="dashboard in $ctrl.dashboards">\n              <a href="dashboard/{{dashboard.slug}}" ng-bind="dashboard.name"></a>\n            </li>\n          </ul>\n        </li>\n        <li class="dropdown" ng-show="$ctrl.showQueriesMenu" uib-dropdown>\n          <a href="#" class="dropdown-toggle" uib-dropdown-toggle>Queries <b class="caret"></b></a>\n          <ul class="dropdown-menu" uib-dropdown-menu>\n            <li ng-show="$ctrl.showNewQueryMenu"><a href="queries/new">New Query</a></li>\n            <li><a href="queries">Queries</a></li>\n          </ul>\n        </li>\n        <li ng-if="$ctrl.showAlertsLink">\n          <a href="alerts">Alerts</a>\n        </li>\n      </ul>\n      <form class="navbar-form navbar-left" role="search" ng-submit="$ctrl.searchQueries()">\n        <div class="input-group menu-search">\n          <input type="text" ng-model="$ctrl.term" class="form-control" placeholder="Search queries...">\n          <span class="input-group-btn">\n            <button type="submit" class="btn btn-default"><span class="zmdi zmdi-search"></span></button>\n          </span>\n        </div>\n      </form>\n      <ul class="nav navbar-nav navbar-right">\n        <li ng-show="$ctrl.currentUser.isAdmin">\n          <a href="data_sources" title="Data Sources"><i class="fa fa-database"></i></a>\n        </li>\n        <li ng-show="$ctrl.showSettingsMenu">\n          <a href="users" title="Settings"><i class="fa fa-cog"></i></a>\n        </li>\n        <li class="dropdown" uib-dropdown>\n          <a href="#" class="dropdown-toggle" uib-dropdown-toggle><span ng-bind="$ctrl.currentUser.name"></span> <span\n            class="caret"></span></a>\n          <ul class="dropdown-menu" dropdown-menu>\n            <li style="width:300px">\n              <a ng-href="users/{{$ctrl.currentUser.id}}">\n                <div class="row">\n                  <div class="col-sm-2">\n                    <img ng-src="{{$ctrl.currentUser.gravatar_url}}" size="40px" class="img-circle" />\n                  </div>\n                  <div class="col-sm-10">\n                    <p><strong>{{$ctrl.currentUser.name}}</strong></p>\n                  </div>\n                </div>\n              </a>\n            </li>\n            <li class="divider" ng-if="$ctrl.currentUser.hasPermission(\'super_admin\')">\n              <li ng-if="$ctrl.currentUser.hasPermission(\'super_admin\')"><a href="admin/status">System Status</a></li>\n              <li class="divider">\n              </li>\n              <li>\n                <a ng-click="$ctrl.logout()">Log out</a>\n              </li>\n          </ul>\n          </li>\n      </ul>\n    </div>\n  </div>\n</nav>'},function(e,t){},function(e,t,n){"use strict";function a(){return{restrict:"E",scope:{queryId:"=",taskId:"="},transclude:!0,template:'<button class="btn btn-default" ng-disabled="inProgress" ng-click="cancelExecution()"><i class="zmdi zmdi-spinner zmdi-hc-spin" ng-if="inProgress"></i> Cancel</button>',replace:!0,controller:["$scope","$http","currentUser","Events",function(e,t,n,a){e.inProgress=!1,e.cancelExecution=function(){t.delete("api/jobs/"+e.taskId).success(function(){});var n=e.queryId;"adhoc"===e.queryId&&(n=null),a.record("cancel_execute","query",n,{admin:!0}),e.inProgress=!0}}]}}function r(e){e.directive("cancelQueryButton",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,n){"use strict";function a(e){e.component("addWidgetDialog",s)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=n(382),i=function(e){return e&&e.__esModule?e:{default:e}}(r),s={template:i.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$sce","toastr","Query","Widget",function(e,t,n,a){"ngInject";var r=this;this.dashboard=this.resolve.dashboard,this.saveInProgress=!1,this.widgetSize=1,this.selectedVis=null,this.query={},this.selected_query=void 0,this.text="",this.existing_text="",this.new_text="",this.widgetSizes=[{name:"Regular",value:1},{name:"Double",value:2}],this.type="visualization",this.trustAsHtml=function(t){return e.trustAsHtml(t)},this.isVisualization=function(){return"visualization"===r.type},this.isTextBox=function(){return"textbox"===r.type},this.setType=function(e){r.type=e,"textbox"===e?r.widgetSizes.push({name:"Hidden",value:0}):r.widgetSizes.length>2&&r.widgetSizes.pop()},this.onQuerySelect=function(){r.query.selected&&n.get({id:r.query.selected.id},function(e){e&&(r.selected_query=e,e.visualizations.length&&(r.selectedVis=e.visualizations[0]))})},this.searchQueries=function(e){!e||e.length<3||n.search({q:e},function(e){r.queries=e})},this.saveWidget=function(){r.saveInProgress=!0,new a({visualization_id:r.selectedVis&&r.selectedVis.id,dashboard_id:r.dashboard.id,options:{},width:r.widgetSize,text:r.text}).$save().then(function(e){r.dashboard.layout=e.layout,r.dashboard.version=e.version;var t=new a(e.widget);e.new_row?r.dashboard.widgets.push([t]):r.dashboard.widgets[r.dashboard.widgets.length-1].push(t),r.close()}).catch(function(){t.error("Widget can not be added")}).finally(function(){r.saveInProgress=!1})}}]}},function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" ng-disabled="$ctrl.saveInProgress" aria-hidden="true" ng-click="$ctrl.dismiss()">&times;</button>\n  <h4 class="modal-title">Add Widget</h4>\n</div>\n<div class="modal-body">\n  <p class="btn-group">\n      <button type="button" class="btn btn-default" ng-class="{active: $ctrl.isVisualization()}" ng-click="$ctrl.setType(\'visualization\')">Visualization</button>\n      <button type="button" class="btn btn-default" ng-class="{active: $ctrl.isTextBox()}" ng-click="$ctrl.setType(\'textbox\')">Text Box</button>\n  </p>\n\n  <div ng-show="$ctrl.isTextBox()">\n      <div class="form-group">\n          <textarea class="form-control" ng-model="$ctrl.text" rows="3"></textarea>\n      </div>\n      <div ng-show="$ctrl.text">\n          <strong>Preview:</strong>\n          <p ng-bind-html="$ctrl.text | markdown"></p>\n      </div>\n  </div>\n\n  <div ng-show="$ctrl.isVisualization()">\n      <div class="form-group">\n          <ui-select ng-model="$ctrl.query.selected" theme="bootstrap" reset-search-input="false" on-select="$ctrl.onQuerySelect($item, $model)">\n              <ui-select-match placeholder="Search a query by name">{{$select.selected.name}}</ui-select-match>\n              <ui-select-choices repeat="q in $ctrl.queries"\n                                 refresh="$ctrl.searchQueries($select.search)"\n                                 refresh-delay="0">\n                  <div ng-bind-html="$ctrl.trustAsHtml(q.name | highlight: $select.search)"></div>\n              </ui-select-choices>\n          </ui-select>\n      </div>\n\n      <div ng-show="$ctrl.selected_query">\n          <div class="form-group">\n              <label for="">Choose Visualization</label>\n              <select ng-model="$ctrl.selectedVis" ng-options="vis as vis.name group by vis.type for vis in $ctrl.selected_query.visualizations" class="form-control"></select>\n          </div>\n      </div>\n  </div>\n\n  <div class="form-group">\n      <label for="">Widget Size</label>\n      <select class="form-control" ng-model="$ctrl.widgetSize"\n              ng-options="c.value as c.name for c in $ctrl.widgetSizes"></select>\n  </div>\n</div>\n\n<div class="modal-footer">\n  <button type="button" class="btn btn-default" ng-disabled="$ctrl.saveInProgress" ng-click="$ctrl.dismiss()">Close</button>\n  <button type="button" class="btn btn-primary" ng-disabled="$ctrl.saveInProgress || !($ctrl.selectedVis || $ctrl.isTextBox())" ng-click="$ctrl.saveWidget()">Add to Dashboard</button>\n</div>\n'},function(e,t,n){"use strict";function a(e){e.component("editDashboardDialog",o)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=n(5),i=n(384),s=function(e){return e&&e.__esModule?e:{default:e}}(i),o={bindings:{resolve:"<",close:"&",dismiss:"&"},template:s.default,controller:["$rootScope","$location","$http","toastr","Events","Dashboard",function(e,t,n,a,i,s){"ngInject";var o=this;this.dashboard=this.resolve.dashboard,this.gridsterOptions={margins:[5,5],rowHeight:100,colWidth:260,columns:2,mobileModeEnabled:!1,swapping:!0,minRows:1,draggable:{enabled:!0},resizable:{enabled:!1}},this.items=[],this.dashboard.widgets&&this.dashboard.widgets.forEach(function(e,t){e.forEach(function(e,n){o.items.push({id:e.id,col:n,row:t,sizeY:1,sizeX:e.width,name:e.getName()})})}),this.isFormValid=function(){return!(0,r.isEmpty)(o.dashboard.name)},this.saveDashboard=function(){if(o.saveInProgress=!0,o.dashboard.id){var l=[];(0,r.sortBy)(o.items,function(e){return 10*e.row+e.col}).forEach(function(e){l[e.row]=l[e.row]||[],e.col>0&&void 0===l[e.row][e.col-1]?l[e.row][e.col-1]=e.id:l[e.row][e.col]=e.id});var u={slug:o.dashboard.id,name:o.dashboard.name,version:o.dashboard.version,dashboard_filters_enabled:o.dashboard.dashboard_filters_enabled,layout:JSON.stringify(l)};s.save(u,function(t){o.dashboard=t,o.saveInProgress=!1,o.close({$value:o.dashboard}),e.$broadcast("reloadDashboards")},function(e){o.saveInProgress=!1,403===e.status?a.error("Unable to save dashboard: Permission denied."):409===e.status&&a.error("It seems like the dashboard has been modified by another user. Please copy/backup your changes and reload this page.",{autoDismiss:!1})}),i.record("edit","dashboard",o.dashboard.id)}else n.post("api/dashboards",{name:o.dashboard.name}).success(function(e){o.close(),t.path("/dashboard/"+e.slug).replace()}),i.record("create","dashboard")}}]}},function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" ng-click="$ctrl.dismiss()" ng-disabled="$ctrl.saveInProgress" aria-hidden="true">&times;</button>\n  <h4 class="modal-title">Edit: {{$ctrl.dashboard.name}}</h4>\n</div>\n<div class="modal-body">\n  <p>\n    <input type="text" class="form-control" placeholder="Dashboard Name" ng-model="$ctrl.dashboard.name" autofocus>\n  </p>\n\n  <p ng-if="$ctrl.dashboard.id">\n    <label>\n        <input name="input" type="checkbox" ng-model="$ctrl.dashboard.dashboard_filters_enabled">\n        Use Dashboard Level Filters\n    </label>\n  </p>\n\n  <div gridster="$ctrl.gridsterOptions" ng-if="$ctrl.items | notEmpty">\n    <ul>\n      <li gridster-item="item" ng-repeat="item in $ctrl.items" class="widget panel panel-default gs-w">\n        <div class="heading">{{item.name}}</div>\n      </li>\n    </ul>\n  </div>\n</div>\n<div class="modal-footer">\n  <button type="button" class="btn btn-default" ng-disabled="$ctrl.saveInProgress" ng-click="$ctrl.dismiss()">Close</button>\n  <button type="button" class="btn btn-primary" ng-disabled="$ctrl.saveInProgress || !$ctrl.isFormValid()" ng-click="$ctrl.saveDashboard()">Save</button>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a,r){var i=this;this.canViewQuery=r.hasPermission("view_query"),this.editTextBox=function(){i.widget.existing_text=i.widget.text,i.widget.new_text=i.widget.text,t.open({component:"editTextBox",resolve:{widget:i.widget}})},this.localParametersDefs=function(){return i.localParameters||(i.localParameters=i.widget.query.getParametersDefs().filter(function(e){return!e.global})),i.localParameters},this.deleteWidget=function(){n.confirm('Are you sure you want to remove "'+i.widget.getName()+'" from the dashboard?')&&(a.record("delete","widget",i.widget.id),i.widget.$delete(function(e){i.dashboard.widgets=i.dashboard.widgets.map(function(e){return e.filter(function(e){return void 0!==e.id})}),i.dashboard.widgets=i.dashboard.widgets.filter(function(e){return e.length>0}),i.dashboard.layout=e.layout,i.dashboard.version=e.version,i.deleted&&i.deleted({})}))},a.record("view","widget",this.widget.id),this.reload=function(t){var n=e.search().maxAge;t&&(n=0),i.queryResult=i.query.getQueryResult(n)},this.widget.visualization?(a.record("view","query",this.widget.visualization.query.id,{dashboard:!0}),a.record("view","visualization",this.widget.visualization.id,{dashboard:!0}),this.query=this.widget.getQuery(),this.reload(!1),this.type="visualization"):this.widget.restricted?this.type="restricted":this.type="textbox"}function i(e){e.component("editTextBox",c),e.component("dashboardWidget",{template:o.default,controller:r,bindings:{widget:"<",public:"<",dashboard:"<",deleted:"&onDelete"}})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=n(386),o=a(s),l=n(387),u=a(l);r.$inject=["$location","$uibModal","$window","Events","currentUser"];var c={template:u.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["toastr",function(e){"ngInject";var t=this;this.saveInProgress=!1,this.widget=this.resolve.widget,this.saveWidget=function(){t.saveInProgress=!0,t.widget.new_text!==t.widget.existing_text?(t.widget.text=t.widget.new_text,t.widget.$save().then(function(){t.close()}).catch(function(){e.error("Widget can not be updated")}).finally(function(){t.saveInProgress=!1})):t.close()}}]}},function(e,t){e.exports='<div class="col-lg-{{$ctrl.widget.width | colWidth}}">\n    <div class="tile" ng-if="$ctrl.type==\'visualization\'">\n        <div class="t-header widget">\n            <div class="th-title">\n                <p class="hidden-print">\n                    <span ng-hide="$ctrl.canViewQuery">{{$ctrl.query.name}}</span>\n                    <query-link query="$ctrl.query" visualization="$ctrl.widget.visualization" ng-show="$ctrl.canViewQuery"></query-link>\n                    <small><visualization-name visualization="$ctrl.widget.visualization"/></small>\n                </p>\n                <p class="visible-print">\n                  {{$ctrl.query.name}}\n                  <visualization-name visualization="$ctrl.widget.visualization"/>\n                </p>\n                <div class="text-muted" ng-bind-html="$ctrl.query.description | markdown"></div>\n            </div>\n          <div class="actions dropdown" uib-dropdown ng-if="!$ctrl.public">\n            <a data-toggle="dropdown" uib-dropdown-toggle><i class="zmdi zmdi-more"></i></a>\n\n            <ul class="dropdown-menu pull-right" uib-dropdown-menu style="z-index:1000000">\n              <li ng-class="{\'disabled\': $ctrl.queryResult.isEmpty()}"><a ng-href="{{$ctrl.queryResult.getLink($ctrl.query.id, \'csv\')}}" download="{{$ctrl.queryResult.getName($ctrl.query.name, \'csv\')}}" target="_self">Download as CSV File</a></li>\n              <li ng-class="{\'disabled\': $ctrl.queryResult.isEmpty()}"><a ng-href="{{$ctrl.queryResult.getLink($ctrl.query.id, \'xlsx\')}}" download="{{$ctrl.queryResult.getName($ctrl.query.name, \'xlsx\')}}" target="_self">Download as Excel File</a></li>\n              <li><a ng-href="queries/{{$ctrl.query.id}}#{{$ctrl.widget.visualization.id}}" ng-show="$ctrl.canViewQuery">View Query</a></li>\n              <li><a ng-show="$ctrl.dashboard.canEdit()" ng-click="$ctrl.deleteWidget()">Remove From Dashboard</a></li>\n            </ul>\n          </div>\n        </div>\n\n        <parameters parameters="$ctrl.localParametersDefs()"></parameters>\n\n        <div ng-switch="$ctrl.queryResult.getStatus()">\n          <div ng-switch-when="failed">\n            <div class="alert alert-danger m-5" ng-show="$ctrl.queryResult.getError()">Error running query: <strong>{{$ctrl.queryResult.getError()}}</strong></div>\n          </div>\n          <div ng-switch-when="done">\n              <visualization-renderer visualization="$ctrl.widget.visualization" query-result="$ctrl.queryResult" class="t-body"></visualization-renderer>\n          </div>\n          <div ng-switch-default class="text-center">\n            <i class="zmdi zmdi-refresh zmdi-hc-spin zmdi-hc-5x"></i>\n          </div>\n        </div>\n\n        <div class="p-5 clearfix" style="line-height:28px;">\n            <span class="small hidden-print">Updated: <span am-time-ago="$ctrl.queryResult.getUpdatedAt()"></span></span>\n            <span class="visible-print">\n              Updated: {{$ctrl.queryResult.getUpdatedAt() | dateTime}}\n            </span>\n            <button class="btn btn-sm btn-default pull-right hidden-print" ng-click="$ctrl.reload(true)" ng-if="!$ctrl.public"><i class="zmdi zmdi-refresh"></i></button>\n        </div>\n    </div>\n\n  <div class="tile" ng-if="$ctrl.type==\'restricted\'">\n    <div class="t-body">\n      <div class="text-center">\n        <h1><span class="zmdi zmdi-lock"></span></h1>\n        <p class="text-muted">\n          This widget requires access to a data source you don\'t have access to.\n        </p>\n      </div>\n    </div>\n  </div>\n\n  <div class="tile" ng-hide="$ctrl.widget.width === 0" ng-if="$ctrl.type==\'textbox\'">\n    <div class="t-body">\n      <div class="dropdown" uib-dropdown ng-if="!$ctrl.public && $ctrl.dashboard.canEdit()">\n        <div class="dropdown-header">\n          <a data-toggle="dropdown" uib-dropdown-toggle class="actions"><i class="zmdi zmdi-more"></i></a>\n        </div>\n\n        <ul class="dropdown-menu pull-right" uib-dropdown-menu style="z-index:1000000">\n          <li><a ng-show="$ctrl.dashboard.canEdit()" ng-click="$ctrl.editTextBox()">Edit</a></li>\n          <li><a ng-show="$ctrl.dashboard.canEdit()" ng-click="$ctrl.deleteWidget()">Remove From Dashboard</a></li>\n        </ul>\n      </div>\n      <p ng-bind-html="$ctrl.widget.text | markdown" class="p-5"></p>\n    </div>\n  </div>\n</div>\n'},function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span></button>\n  <h4 class="modal-title">Edit TextBox</h4>\n</div>\n<div class="modal-body">\n  <div class="form-group">\n    <textarea class="form-control" ng-model="$ctrl.widget.new_text" rows="3"></textarea>\n  </div>\n  <div ng-show="$ctrl.widget.new_text">\n    <strong>Preview:</strong>\n    <p ng-bind-html="$ctrl.widget.new_text | markdown"></p>\n  </div>\n</div>\n\n<div class="modal-footer">\n  <button type="button" class="btn btn-default" ng-disabled="$ctrl.saveInProgress" ng-click="$ctrl.close()">Close</button>\n  <button type="button" class="btn btn-primary" ng-disabled="$ctrl.saveInProgress" ng-click="$ctrl.saveWidget()">Save</button>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){function a(e,t){var n=new Array(t.length);return Object.keys(e).forEach(function(a){var r=t.indexOf(a),i={name:a,property:e[a]};r>-1?n[r]=i:n.push(i)}),n}return{restrict:"E",replace:"true",transclude:!0,template:c.default,scope:{target:"=",type:"@type",actions:"="},link:function(r){function i(e){void 0===r.target.type&&(r.target.type=e[0].type);var t=(0,s.find)(e,function(e){return e.type===r.target.type}),n=t.configuration_schema;return r.fields=a(n.properties,n.order||[]),t}r.inProgressActions={},r.actions&&r.actions.forEach(function(e){var t=e.callback,n=e.name;e.callback=function(){function a(){r.inProgressActions[e.name]=!1,e.name=n}e.name='<i class="zmdi zmdi-spinner zmdi-hc-spin"></i> '+n,r.inProgressActions[e.name]=!0,t(a)}}),r.files={},r.$watchCollection("files",function(){(0,s.each)(r.files,function(e,t){!e&&r.target.options[t]&&r.dataSourceForm.$setPristine(),e&&(r.target.options[t]=e.base64)})});var o=e.get("api/"+r.type+"/types");n.all([o,r.target.$promise]).then(function(e){var t=e[0].data;i(t),r.types=t,t.forEach(function(e){(0,s.each)(e.configuration_schema.properties,function(t,n){"password"!==n&&"passwd"!==n||(t.type="password"),(0,l.default)(n,"File")&&(t.type="file"),"boolean"===t.type&&(t.type="checkbox"),t.required=(0,s.contains)(e.configuration_schema.required,n)})}),r.$watch("target.type",function(e,t){if(t!==e){void 0!==t&&(r.target.options={});var n=i(r.types);if(0===Object.keys(r.target.options).length){var a=n.configuration_schema.properties;Object.keys(a).forEach(function(e){(0,s.isUndefined)(a[e].default)||(r.target.options[e]=a[e].default)})}}})}),r.saveChanges=function(){r.target.$save(function(){t.success("Saved."),r.dataSourceForm.$setPristine()},function(e){400===e.status&&"message"in e.data?t.error(e.data.message):t.error("Failed saving.")})}}}}function i(e){e.directive("dynamicForm",r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=n(5),o=n(389),l=a(o),u=n(390),c=a(u);r.$inject=["$http","toastr","$q"]},,function(e,t){e.exports='<form name="dataSourceForm">\n    <div class="form-group">\n        <label for="type">Type</label>\n        <select name="type" class="form-control" ng-options="type.type as type.name for type in types" ng-model="target.type" autofocus></select>\n    </div>\n    <div class="form-group">\n        <label for="dataSourceName">Name</label>\n        <input type="string" class="form-control" name="dataSourceName" ng-model="target.name" required>\n    </div>\n    <div class="form-group" ng-class=\'{"has-error": !inner.input.$valid}\' ng-form="inner" ng-repeat="field in fields">\n        <label ng-if="field.property.type !== \'checkbox\'">{{field.property.title || field.name | capitalize}}</label>\n        <input name="input" type="{{field.property.type}}" class="form-control" ng-model="target.options[field.name]" ng-required="field.property.required"\n               ng-if="field.property.type !== \'file\' && field.property.type !== \'checkbox\'" accesskey="tab" placeholder="{{field.property.default}}">\n\n        <label ng-if="field.property.type==\'checkbox\'">\n            <input name="input" type="{{field.property.type}}" ng-model="target.options[field.name]" ng-required="field.property.required"\n                   ng-if="field.property.type !== \'file\'" accesskey="tab" placeholder="{{field.property.default}}">\n            {{field.property.title || field.name | capitalize}}\n        </label>\n\n        <input name="input" type="file" class="form-control" ng-model="files[field.name]" ng-required="field.property.required && !target.options[field.name]"\n               base-sixty-four-input\n               ng-if="field.property.type === \'file\'">\n    </div>\n\n    <button class="btn btn-primary" ng-disabled="!dataSourceForm.$valid" ng-click="saveChanges()">Save</button>\n    <span ng-repeat="action in actions">\n        <button class="btn"\n                ng-class="action.class"\n                ng-if="target.id"\n                ng-disabled="(action.disableWhenDirty && dataSourceForm.$dirty) || inProgressActions[action.name]"\n                ng-click="action.callback()" ng-bind-html="action.name"></button>\n    </span>\n\n    <span ng-transclude>\n\n    </span>\n</form>\n'},function(e,t,n){"use strict";function a(e){"ngInject";var t=this;this.itemsPerPage=this.count=15,this.page=1,this.rowsCount=0,this.orderByField=void 0,this.orderByReverse=!1,this.pageChanged=function(){var e=t.count*(t.page-1),n=t.count*t.page;t.rowsToDisplay=t.rows.slice(e,n)},this.$onChanges=function(e){e.columns&&(t.columns=e.columns.currentValue),e.rows&&(t.rows=e.rows.currentValue),t.rowsCount=t.rows.length,t.pageChanged()},this.orderBy=function(e){e===t.orderByField?t.orderByReverse=!t.orderByReverse:(t.orderByField=e,t.orderByReverse=!1),t.orderByField&&(t.rows=(0,i.sortBy)(t.rows,t.orderByField.name),t.orderByReverse&&(t.rows=t.rows.reverse()),t.pageChanged())},this.sanitize=function(t){return e(t)},this.sortIcon=function(e){return e!==t.orderByField?null:t.orderByReverse?"desc":"asc"}}function r(e){e.component("dynamicTable",{template:o.default,controller:a,bindings:{rows:"<",columns:"<",count:"<"}})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(5),s=n(392),o=function(e){return e&&e.__esModule?e:{default:e}}(s);n(393),a.$inject=["$sanitize"]},function(e,t){e.exports='<div>\n  <table class="table table-condensed table-hover">\n    <thead>\n    <tr>\n      <th ng-repeat="column in $ctrl.columns" ng-click="$ctrl.orderBy(column)" class="sortable-column">\n        {{column.title}} <span ng-if="$ctrl.sortIcon(column)"><i class="fa fa-sort-{{$ctrl.sortIcon(column)}}"></i></span>\n      </th>\n    </tr>\n\n    </thead>\n    <tbody>\n    <tr ng-repeat="row in $ctrl.rowsToDisplay">\n      <td ng-repeat="column in $ctrl.columns" ng-bind-html="$ctrl.sanitize(column.formatFunction(row[column.name]))">\n      </td>\n    </tr>\n    </tbody>\n  </table>\n</div>\n<div class="text-center">\n  <ul uib-pagination total-items="$ctrl.rowsCount"\n      items-per-page="$ctrl.itemsPerPage"\n      ng-model="$ctrl.page"\n      max-size="6"\n      class="pagination"\n      boundary-link-numbers="true"\n      rotate="false"\n      next-text=\'>\'\n      previous-text=\'<\'\n      ng-change="$ctrl.pageChanged()"></ul>\n</div>\n'},function(e,t){},function(e,t,n){"use strict";function a(){return{restrict:"E",scope:{value:"=",ignoreBlanks:"=",editable:"=",done:"="},template:function(e,t){var n=t.editor||"input",a=t.placeholder||"Click to edit";return("true"===t.markdown?'<span ng-click="editable && edit()" ng-bind-html="value|markdown" ng-class="{editable: editable}"></span>':'<span ng-click="editable && edit()" ng-bind="value" ng-class="{editable: editable}"></span>')+'<span ng-click="editable && edit()"\n                                     ng-show="editable && !value"\n                                     ng-class="{editable: editable}">'+a+"</span>"+'<{elType} ng-model="value" class="rd-form-control"></{elType}>'.replace("{elType}",n)},link:function(e,t){function n(){e.editing&&(e.ignoreBlanks&&(0,o.isEmpty)(e.value)&&(e.value=e.oldValue),e.editing=!1,t.removeClass("active"),e.value!==e.oldValue&&e.done&&e.done())}var a=(0,s.default)(t.children()[2]);t.addClass("edit-in-place"),e.editing=!1,e.edit=function(){e.oldValue=e.value,e.editing=!0,t.addClass("active"),a[0].focus()},(0,s.default)(a).keydown(function(t){13!==t.which||t.shiftKey?27===t.which&&(e.value=e.oldValue,e.$apply(function(){(0,s.default)(a[0]).blur()})):(t.preventDefault(),n())}).blur(function(){n()})}}}function r(e){e.directive("editInPlace",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(14),s=function(e){return e&&e.__esModule?e:{default:e}}(i),o=n(5)},function(e,t,n){"use strict";function a(e,t){this.showMailWarning=e.mailSettingsMissing&&t.isAdmin}function r(e){e.component("emailSettingsWarning",{bindings:{function:"<"},template:'<p class="alert alert-danger" ng-if="$ctrl.showMailWarning">It looks like your mail server isn\'t configured. Make sure to configure it for the {{$ctrl.function}} to work.</p>',controller:a})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a.$inject=["clientConfig","currentUser"]},function(e,t,n){"use strict";function a(e){e.component("errorMessages",r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r={template:'\n  <div class="help-block" ng-messages="$ctrl.input.$error" ng-show="$ctrl.input.$touched || $ctrl.form.$submitted">\n    <span class="error" ng-message="required">This field is required.</span>\n    <span class="error" ng-message="minlength">This field is too short.</span>\n    <span class="error" ng-message="email">This needs to be a valid email.</span>\n  </div>\n  ',replace:!0,bindings:{input:"<",form:"<"},controller:function(){}}},function(e,t,n){"use strict";function a(e){e.component("filters",s)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=n(398),i=function(e){return e&&e.__esModule?e:{default:e}}(r),s={template:i.default,bindings:{onChange:"&",filters:"<"},controller:function(){"ngInject";var e=this;this.filterChangeListener=function(t,n){e.onChange({filter:t,$modal:n})},this.itemGroup=function(e){return"*"===e||"-"===e?"":"Values"}}}},function(e,t){e.exports='<div class="container bg-white p-5" ng-show="$ctrl.filters | notEmpty">\n  <div class="row">\n    <div class="col-sm-6 m-t-5" ng-repeat="filter in $ctrl.filters">\n      <label>{{filter.friendlyName}}</label>\n    </div>\n  </div>\n  <div class="row">\n    <div class="col-sm-6 m-t-5" ng-repeat="filter in $ctrl.filters">\n      <ui-select ng-model="filter.current" ng-if="!filter.multiple" on-select="$ctrl.filterChangeListener(filter, $model)" on-remove="$ctrl.filterChangeListener(filter, $model)"\n        remove-selected="false">\n        <ui-select-match placeholder="Select value for {{filter.friendlyName}}...">{{$select.selected | filterValue:filter}}</ui-select-match>\n        <ui-select-choices repeat="value in filter.values | filter: $select.search">\n          {{value | filterValue:filter }}\n        </ui-select-choices>\n      </ui-select>\n\n      <ui-select ng-model="filter.current" multiple ng-if="filter.multiple" on-select="$ctrl.filterChangeListener(filter, $model)"\n        on-remove="$ctrl.filterChangeListener(filter, $model)" remove-selected="false">\n        <ui-select-match placeholder="Select value for {{filter.friendlyName}}...">{{$item | filterValue:filter}}</ui-select-match>\n        <ui-select-choices repeat="value in filter.values | filter: $select.search" group-by="$ctrl.itemGroup">\n          <span ng-if="value == \'*\'">\n            Select All\n          </span>\n          <span ng-if="value == \'-\'">\n            Clear\n          </span>\n          <span ng-if="value != \'*\' && value != \'-\'">\n            {{value | filterValue:filter }}\n          </span>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n  </div>\n</div>'},function(e,t,n){"use strict";function a(e,t){this.version=e.version,this.newVersionAvailable=e.newVersionAvailable&&t.isAdmin}function r(e){e.component("footer",{template:s.default,controller:a})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(400),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["clientConfig","currentUser"]},function(e,t){e.exports='<div id="footer">\n    <a href="http://redash.io">Redash</a> <span ng-bind="$ctrl.version"></span> <small ng-if="$ctrl.newVersionAvailable" ng-cloak class="ng-cloak"><a href="https://version.redash.io/">(New Redash version available)</a></small>\n\n    <ul class="f-menu">\n        <li><a href="https://redash.io/help/">Documentation</a></li>\n        <li><a href="http://github.com/getredash/redash">Contribute</a></li>\n    </ul>\n</div>\n'},function(e,t,n){"use strict";function a(e){e.component("editGroupDialog",s)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=n(402),i=function(e){return e&&e.__esModule?e:{default:e}}(r),s={template:i.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$location",function(e){"ngInject";var t=this;this.group=this.resolve.group;var n=void 0===this.group.id;n?(this.saveButtonText="Create",this.title="Create a New Group"):(this.saveButtonText="Save",this.title="Edit Group"),this.ok=function(){t.group.$save(function(a){n?(e.path("/groups/"+a.id).replace(),t.close()):t.close()})}}]}},function(e,t){e.exports='<div class="modal-header">\n    <h3 class="modal-title">{{$ctrl.title}}</h3>\n</div>\n<div class="modal-body">\n    <form class="form">\n        <input type="text" ng-model="$ctrl.group.name" placeholder="Group Name" class="form-control" autofocus/>\n    </form>\n</div>\n<div class="modal-footer">\n    <button class="btn btn-default" ng-click="$ctrl.close()">Cancel</button>\n    <button class="btn btn-primary" ng-click="$ctrl.ok()">{{$ctrl.saveButtonText}}</button>\n</div>\n'},function(e,t,n){"use strict";function a(e,t,n,a){var r=this;this.canEdit=function(){return a.isAdmin&&"builtin"!==r.group.type},this.saveName=function(){r.group.$save()},this.deleteGroup=function(){e.confirm("Are you sure you want to delete this group?")&&r.group.$delete(function(){t.path("/groups").replace(),n.success("Group deleted successfully.")})}}function r(e){e.component("groupName",{bindings:{group:"<"},transclude:!0,template:'\n      <h2 class="p-l-5">\n        <edit-in-place editable="$ctrl.canEdit()" done="$ctrl.saveName" ignore-blanks=\'true\' value="$ctrl.group.name"></edit-in-place>&nbsp;\n        <button class="btn btn-xs btn-danger" ng-if="$ctrl.canEdit()" ng-click="$ctrl.deleteGroup()">Delete this group</button>\n      </h2>\n    ',replace:!0,controller:a})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a.$inject=["$window","$location","toastr","currentUser"]},function(e,t,n){"use strict";function a(e){e.component("overlay",r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r={template:'\n  <div>\n    <div class="overlay"></div>\n    <div style="width: 100%; position:absolute; top:50px; z-index:2000">\n      <div class="well well-lg" style="width: 70%; margin: auto;" ng-transclude>\n      </div>\n    </div>\n  </div>\n  ',transclude:!0}},function(e,t,n){"use strict";function a(){}function r(e){e.component("pageHeader",{template:s.default,controller:a,transclude:!0,bindings:{title:"@"}})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(406),s=function(e){return e&&e.__esModule?e:{default:e}}(i)},function(e,t){e.exports='<div class="row bg-white p-10 p-l-15 p-r-15 m-b-10">\n  <div class="col-sm-9">\n    <h3>{{$ctrl.title}}</h3>\n  </div>\n  <div class="col-sm-3 text-right">\n    <h3 ng-transclude>\n    </h3>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){e.component("paginator",{template:'\n<div class="text-center">\n  <ul uib-pagination total-items="$ctrl.paginator.totalCount"\n                     items-per-page="$ctrl.paginator.itemsPerPage"\n                     ng-model="$ctrl.page"\n                     max-size="6"\n                     class="pagination"\n                     boundary-link-numbers="true"\n                     rotate="false"\n                     next-text=\'>\'\n                     previous-text=\'<\'\n                     ng-change="$ctrl.pageChanged()"></ul>\n</div>\n    ',bindings:{paginator:"<"},controller:s})}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.default=r;var s=function(){function e(){a(this,e),this.page=this.paginator.page}return i(e,[{key:"pageChanged",value:function(){this.paginator.setPage(this.page)}}]),e}()},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=e.data.columns,n=t.length,a=[];if(n>0){var r=null,i=null;t.forEach(function(e){var t=e.name.toLowerCase();"name"===t&&(r=e.name),"value"===t&&(i=e.name),null===r&&(r=e.name),null===i&&(i=e.name)}),null!==r&&null!==i&&(a=e.data.rows.map(function(e){return{name:e[r],value:e[i]}}))}return a}function i(e,t){void 0!==(0,l.find)(t,function(t){return t.value===e.value})||(e.value=t[0].value)}function s(e,t){return{restrict:"E",transclude:!0,scope:{parameters:"=",syncValues:"=?",editable:"=?",changed:"&onChange"},template:c.default,link:function(n){!1!==n.syncValues&&n.$watch("parameters",function(){n.changed&&n.changed({}),n.parameters.forEach(function(t){null===t.value&&""===t.value||e.search("p_"+t.name,t.value)})},!0),n.extractEnumOptions=function(e){return e?e.split("\n"):[]},n.showParameterSettings=function(e){t.open({component:"parameterSettings",resolve:{parameter:e}})}}}}function o(e){e.directive("parameters",s),e.component("queryBasedParameter",h),e.component("parameterSettings",g)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var l=n(5),u=n(409),c=a(u),d=n(410),p=a(d),f=n(411),m=a(f);s.$inject=["$location","$uibModal"];var g={template:m.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$sce","Query",function(e,t){"ngInject";var n=this;this.trustAsHtml=function(t){return e.trustAsHtml(t)},this.parameter=this.resolve.parameter,this.parameter.queryId&&t.get({id:this.parameter.queryId},function(e){n.queries=[e]}),this.searchQueries=function(e){!e||e.length<3||t.search({q:e},function(e){n.queries=e})}}]},h={template:p.default,bindings:{param:"<",queryId:"<"},controller:["Query",function(e){"ngInject";var t=this;this.$onChanges=function(n){n.queryId&&e.resultById({id:t.queryId},function(e){var n=e.query_result;t.queryResultOptions=r(n),i(t.param,t.queryResultOptions)})}}]}},function(e,t){e.exports='<div class="form-inline bg-white p-5"\n     ng-if="parameters | notEmpty"\n     ui-sortable="{ \'ui-floating\': true, \'disabled\': !editable }"\n     ng-model="parameters">\n  <div class="form-group m-l-10 m-r-10"\n       ng-repeat="param in parameters">\n    <label class="parameter-label">{{param.title}}</label>\n    <button class="btn btn-default btn-xs"\n            ng-click="showParameterSettings(param)"\n            ng-if="editable">\n        <i class="zmdi zmdi-settings"></i>\n    </button>\n    <span ng-switch="param.type">\n      <input ng-switch-when="datetime-with-seconds" type="datetime-local" step="1" class="form-control" ng-model="param.ngModel">\n      <input ng-switch-when="datetime-local" type="datetime-local" class="form-control" ng-model="param.ngModel">\n      <input ng-switch-when="date" type="date" class="form-control" ng-model="param.ngModel">\n      <span ng-switch-when="enum">\n        <select ng-model="param.value" class="form-control">\n          <option ng-repeat="option in extractEnumOptions(param.enumOptions)" value="{{option}}">{{option}}</option>\n        </select>\n      </span>\n      <span ng-switch-when="query">\n        <query-based-parameter param="param" query-id="param.queryId"></query-based-parameter>\n      </span>\n      <input ng-switch-default type="{{param.type}}" class="form-control" ng-model="param.ngModel">\n    </span>\n  </div>\n</div>\n'},function(e,t){e.exports='<select ng-model="$ctrl.param.value" class="form-control" ng-options="option.value as option.name for option in $ctrl.queryResultOptions">\n</select>'},function(e,t){e.exports='<div class="modal-header">\n    <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span></button>\n    <h4 class="modal-title">{{$ctrl.parameter.name}}</h4>\n</div>\n<div class="modal-body">\n    <div class="form">\n      <div class="form-group">\n        <label>Title</label>\n        <input type="text" class="form-control" ng-model="$ctrl.parameter.title">\n      </div>\n      <div class="form-group">\n        <label>Type</label>\n        <select ng-model="$ctrl.parameter.type" class="form-control">\n          <option value="text">Text</option>\n          <option value="number">Number</option>\n          <option value="enum">Dropdown List</option>\n          <option value="query">Query Based Dropdown List</option>\n          <option value="date">Date</option>\n          <option value="datetime-local">Date and Time</option>\n          <option value="datetime-with-seconds">Date and Time (with seconds)</option>\n        </select>\n      </div>\n      <div class="form-group">\n        <label>\n          <input type="checkbox" class="form-inline" ng-model="$ctrl.parameter.global">\n          Global\n        </label>\n      </div>\n      <div class="form-group" ng-if="$ctrl.parameter.type === \'enum\'">\n        <label>Dropdown List Values (newline delimited)</label>\n        <textarea class="form-control" rows="3" ng-model="$ctrl.parameter.enumOptions"></textarea>\n      </div>\n      <div class="form-group" ng-if="$ctrl.parameter.type === \'query\'">\n        <label>Query to load dropdown values from:</label>\n        <ui-select ng-model="$ctrl.parameter.queryId" reset-search-input="false">\n            <ui-select-match placeholder="Search a query by name">{{$select.selected.name}}</ui-select-match>\n            <ui-select-choices repeat="q.id as q in $ctrl.queries"\n                               refresh="$ctrl.searchQueries($select.search)"\n                               refresh-delay="0">\n            <div class="form-group" ng-bind-html="$ctrl.trustAsHtml(q.name | highlight: $select.search)"></div>\n            </ui-select-choices>\n        </ui-select>\n      </div>\n    </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){e.component("permissionsEditor",o)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=n(5),i=n(413),s=function(e){return e&&e.__esModule?e:{default:e}}(i),o={template:s.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$http","User",function(e,t){"ngInject";var n=this;this.grantees=[],this.newGrantees={},this.aclUrl=this.resolve.aclUrl.url;var a=function(){e.get(n.aclUrl).success(function(e){n.grantees=[],(0,r.each)(e,function(e,t){e.forEach(function(e){e.access_type=t,n.grantees.push(e)})})})};a(),this.findUser=function(e){""!==e&&void 0===n.foundUsers&&t.query(function(e){var t=n.grantees.map(function(e){return e.id});e.forEach(function(e){e.alreadyGrantee=(0,r.contains)(t,e.id)}),n.foundUsers=e})},this.addGrantee=function(t){n.newGrantees.selected=void 0;var r={access_type:"modify",user_id:t.id};e.post(n.aclUrl,r).success(function(){t.alreadyGrantee=!0,a()})},this.removeGrantee=function(t){var a={access_type:"modify",user_id:t.id};e({url:n.aclUrl,method:"DELETE",data:a,headers:{"Content-Type":"application/json"}}).success(function(){n.grantees=n.grantees.filter(function(e){return e!==t}),n.foundUsers&&n.foundUsers.forEach(function(e){e.id===t.id&&(e.alreadyGrantee=!1)})})}}]}},function(e,t){e.exports='<div class="modal-header">\n    <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span></button>\n    <h4 class="modal-title">Manage Permissions</h4>\n</div>\n<div class="modal-body">\n  <div style="overflow: auto; height: 300px">\n    <ui-select ng-model="$ctrl.newGrantee.selected" on-select="$ctrl.addGrantee($item)">\n       <ui-select-match placeholder="Add New User"></ui-select-match>\n       <ui-select-choices repeat="user in $ctrl.foundUsers | filter:$select.search"\n                         refresh="$ctrl.findUser($select.search)"\n                         refresh-delay="0"\n                         ui-disable-choice="user.alreadyGrantee">\n        <div>\n          <img ng-src="{{user.gravatar_url}}" height="24px">&nbsp;{{user.name}}\n          <small ng-if="user.alreadyGrantee">(already has permission)</small>\n        </div>\n       </ui-select-choices>\n    </ui-select>\n      <br/>\n       <table class="table table-condensed table-hover">\n        <thead>\n          <tr>\n            <th></th>\n            <th>User</th>\n            <th>Permission</th>\n            <th></th>\n          </tr>\n        </thead>\n        <tbody>\n        <tr ng-repeat="grantee in $ctrl.grantees">\n          <td width="50px"><img ng-src="{{grantee.gravatar_url}}" height="40px"/></td>\n          <td>{{grantee.name}} </td>\n          <td>{{grantee.access_type}}</td>\n          <td><button class="pull-right btn btn-sm btn-danger" ng-click="$ctrl.removeGrantee(grantee)">Remove</button></td>\n        </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n'},function(e,t,n){"use strict";function a(e){return{restrict:"E",replace:!0,scope:{isDirty:"="},link:function(t){var n=e.onbeforeunload;e.onbeforeunload=function(){return t.isDirty?"You will lose your changes if you leave":null},t.$on("$locationChangeStart",function(n,a,r){a.split("?")[0]!==r.split("?")[0]&&a.split("#")[0]!==r.split("#")[0]&&t.isDirty&&!e.confirm("You will lose your changes if you leave\n\nAre you sure you want to leave this page?")&&n.preventDefault()}),t.$on("$destroy",function(){e.onbeforeunload=n})}}}function r(e){e.directive("alertUnsavedChanges",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a.$inject=["$window"]},function(e,t,n){"use strict";function a(e){e.component("apiKeyDialog",r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r={template:'<div class="modal-header">\n    <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span></button>\n</div>\n<div class="modal-body">\n    <h5>API Key</h5>\n    <pre>{{$ctrl.apiKey}}</pre>\n\n    <h5>Example API Calls:</h5>\n\n    <div>\n        Results in CSV format:\n\n        <pre>{{$ctrl.csvUrl}}</pre>\n\n        Results in JSON format:\n\n        <pre>{{$ctrl.jsonUrl}}</pre>\n    </div>\n</div>',controller:["clientConfig",function(e){"ngInject";this.apiKey=this.resolve.query.api_key,this.csvUrl=e.basePath+"api/queries/"+this.resolve.query.id+"/results.csv?api_key="+this.apiKey,this.jsonUrl=e.basePath+"api/queries/"+this.resolve.query.id+"/results.json?api_key="+this.apiKey}],bindings:{resolve:"<",close:"&",dismiss:"&"}}},function(e,t,n){"use strict";function a(e){e.component("embedCodeDialog",s)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=n(417),i=function(e){return e&&e.__esModule?e:{default:e}}(r),s={controller:["clientConfig",function(e){"ngInject";this.query=this.resolve.query,this.visualization=this.resolve.visualization,this.embedUrl=e.basePath+"embed/query/"+this.query.id+"/visualization/"+this.visualization.id+"?api_key="+this.query.api_key,window.snapshotUrlBuilder&&(this.snapshotUrl=window.snapshotUrlBuilder(this.query,this.visualization))}],bindings:{resolve:"<",close:"&",dismiss:"&"},template:i.default}},function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span></button>\n  <h4 class="modal-title">Embed Code</h4>\n</div>\n<div class="modal-body">\n  <h5>IFrame Embed</h5>\n  <div>\n    <code>&lt;iframe src="{{ $ctrl.embedUrl }}" width="720" height="391"&gt;&lt;/iframe&gt;</code>\n  </div>\n  <span class="text-muted">(height should be adjusted)</span>\n  <div ng-if="$ctrl.snapshotUrl">\n    <h5>Image Embed</h5>\n    <div>\n      <code style="overflow-wrap:break-word;">{{$ctrl.snapshotUrl}}</code>\n    </div>\n  </div>\n</div>'},function(e,t,n){"use strict";function a(e){window.ace.define("ace/snippets/"+e,["require","exports","module"],function(t,n){n.snippetText="",n.scope=e})}function r(e){return{restrict:"E",scope:{query:"=",schema:"=",syntax:"="},template:'<div ui-ace="editorOptions" ng-model="query.query"></div>',link:{pre:function(t){t.syntax=t.syntax||"sql",t.editorOptions={mode:"json",advanced:{behavioursEnabled:!0,enableSnippets:!0,enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,autoScrollEditorIntoView:!0},onLoad:function(n){n.commands.bindKey("Cmd+L",null),n.commands.bindKey("Ctrl+L",null),e.query(function(e){window.ace.acequire(["ace/snippets"],function(t){var n=t.snippetManager,a={snippetText:""};a.snippets=n.parseSnippetFile(a.snippetText),e.forEach(function(e){a.snippets.push(e.getSnippet())}),n.register(a.snippets||[],a.scope)})}),n.$blockScrolling=1/0,n.getSession().setUseWrapMode(!0),n.setShowPrintMargin(!1),t.$watch("syntax",function(e){var t="ace/mode/"+e;n.getSession().setMode(t)}),t.$watch("schema",function(e,t){if(e!==t){e.reduce(function(e,t){return e+t.columns.length},0)>5e3?n.setOption("enableLiveAutocompletion",!1):n.setOption("enableLiveAutocompletion",!0)}}),t.$parent.$on("angular-resizable.resizing",function(){n.resize()}),n.focus()}};var n={getCompletions:function(e,n,a,r,i){if(0===r.length||!t.schema)return void i(null,[]);if(!t.schema.keywords){var o={};t.schema.forEach(function(e){o[e.name]="Table",e.columns.forEach(function(t){o[t]="Column",o[e.name+"."+t]="Column"})}),t.schema.keywords=(0,s.map)(o,function(e,t){return{name:t,value:t,score:0,meta:e}})}i(null,t.schema.keywords)}};window.ace.acequire(["ace/ext/language_tools"],function(e){e.addCompleter(n)})}}}}function i(e){e.directive("queryEditor",r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i,n(226),n(419),n(420),n(421),n(423);var s=n(5);r.$inject=["QuerySnippet"],a("python"),a("sql"),a("json")},,,,,,function(e,t,n){"use strict";function a(){return{restrict:"A",link:function(e,t,n){var a=n.fileType?n.fileType:"csv";e.$watch("queryResult && queryResult.getData()",function(n){n&&(null==e.queryResult.getId()?t.attr("href",""):(t.attr("href","api/queries/"+e.query.id+"/results/"+e.queryResult.getId()+"."+a+(e.embed?"?api_key="+e.apiKey:"")),t.attr("download",e.query.name.replace(" ","_")+(0,s.default)(e.queryResult.getUpdatedAt()).format("_YYYY_MM_DD")+"."+a)))})}}}function r(e){e.directive("queryResultLink",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(i)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=String(t);return n.length<e&&(n="0"+n),n}function i(){return{restrict:"E",scope:{refreshType:"=",query:"=",saveQuery:"="},template:'\n      <select ng-disabled="refreshType != \'daily\'" ng-model="hour" ng-change="updateSchedule()" ng-options="c as c for c in hourOptions"></select> :\n      <select ng-disabled="refreshType != \'daily\'" ng-model="minute" ng-change="updateSchedule()" ng-options="c as c for c in minuteOptions"></select>\n    ',link:function(e){if(e.hourOptions=(0,c.map)((0,c.range)(0,24),(0,c.partial)(r,2)),e.minuteOptions=(0,c.map)((0,c.range)(0,60,5),(0,c.partial)(r,2)),e.query.hasDailySchedule()){var t=e.query.scheduleInLocalTime().split(":");e.minute=t[1],e.hour=t[0]}else e.minute="15",e.hour="00";e.updateSchedule=function(){var t=(0,u.default)().hour(e.hour).minute(e.minute).utc().format("HH:mm");t!==e.query.schedule&&(e.query.schedule=t,e.saveQuery())},e.$watch("refreshType",function(){"daily"===e.refreshType&&e.updateSchedule()})}}}function s(){return{restrict:"E",scope:{refreshType:"=",query:"=",saveQuery:"="},template:'<select\n                ng-disabled="refreshType != \'periodic\'"\n                ng-model="query.schedule"\n                ng-change="saveQuery()"\n                ng-options="c.value as c.name for c in refreshOptions">\n                <option value="">No Refresh</option>\n                </select>',link:function(e){e.refreshOptions=[{value:"60",name:"Every minute"}],[5,10,15,30].forEach(function(t){e.refreshOptions.push({value:String(60*t),name:"Every "+t+" minutes"})}),(0,c.range)(1,13).forEach(function(t){e.refreshOptions.push({value:String(3600*t),name:"Every "+t+"h"})}),e.refreshOptions.push({value:String(86400),name:"Every 24h"}),e.refreshOptions.push({value:String(604800),name:"Every 7 days"}),e.refreshOptions.push({value:String(1209600),name:"Every 14 days"}),e.refreshOptions.push({value:String(2592e3),name:"Every 30 days"}),e.$watch("refreshType",function(){"periodic"===e.refreshType&&e.query.hasDailySchedule()&&(e.query.schedule=null,e.saveQuery())})}}}function o(e){e.directive("queryTimePicker",i),e.directive("queryRefreshSelect",s),e.component("scheduleDialog",f)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var l=n(0),u=a(l),c=n(5),d=n(426),p=a(d),f={controller:function(){this.query=this.resolve.query,this.saveQuery=this.resolve.saveQuery,this.query.hasDailySchedule()?this.refreshType="daily":this.refreshType="periodic"},bindings:{resolve:"<",close:"&",dismiss:"&"},template:p.default}},function(e,t){e.exports='<div class="modal-header">\n    <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span></button>\n    <h4 class="modal-title">Refresh Schedule</h4>\n</div>\n<div class="modal-body">\n    <div class="radio">\n        <label>\n            <input type="radio" value="periodic" ng-model="$ctrl.refreshType">\n            <query-refresh-select refresh-type="$ctrl.refreshType" query="$ctrl.query" save-query="$ctrl.saveQuery"></query-refresh-select>\n        </label>\n    </div>\n    <div class="radio">\n        <label>\n            <input type="radio" value="daily" ng-model="$ctrl.refreshType">\n            <query-time-picker refresh-type="$ctrl.refreshType" query="$ctrl.query" save-query="$ctrl.saveQuery"></query-time-picker>\n        </label>\n    </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){"ngInject";this.showTable=function(t){t.collapsed=!t.collapsed,e.$broadcast("vsRepeatTrigger")},this.getSize=function(e){var t=18;return e.collapsed||(t+=18*e.columns.length),t}}function r(e){e.component("schemaBrowser",o)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(428),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["$scope"];var o={bindings:{schema:"<",onRefresh:"&"},controller:a,template:s.default}},function(e,t){e.exports='<div class="schema-container">\n  <div class="schema-control">\n    <input type="text" placeholder="Search schema..." class="form-control" ng-model="$ctrl.schemaFilter">\n    <button class="btn btn-default"\n            title="Refresh Schema"\n            ng-click="$ctrl.onRefresh()">\n      <span class="zmdi zmdi-refresh"></span>\n    </button>\n  </div>\n\n  <div class="schema-browser" vs-repeat vs-size="$ctrl.getSize(table)">\n    <div ng-repeat="table in $ctrl.schema | filter:$ctrl.schemaFilter track by table.name">\n      <div class="table-name" ng-click="$ctrl.showTable(table)">\n        <i class="fa fa-table"></i>\n        <strong>\n          <span title="{{table.name}}">{{table.name}}</span>\n          <span ng-if="table.size !== undefined"> ({{table.size}})</span>\n        </strong>\n      </div>\n      <div uib-collapse="table.collapsed">\n        <div ng-repeat="column in table.columns track by column" style="padding-left:16px;">{{column}}</div>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){function t(e,t,n){"ngInject";var a=t.current.params.api_key;return n.setApiKey(a),n.loadConfig()}function n(e,n,a,r){return t(e,n,r).then(function(){var t=n.current.params.queryId,r=e.get("api/queries/"+t).then(function(e){return e.data}),i=e.get("api/queries/"+t+"/results.json"+location.search).then(function(e){return e.data});return a.all([r,i])})}n.$inject=["$http","$route","$q","Auth"],t.$inject=["$http","$route","Auth"],e.component("visualizationEmbed",c),e.config(["$routeProvider",function(e){e.when("/embed/query/:queryId/visualization/:visualizationId",{template:'<visualization-embed data="$resolve.data"></visualization-embed>',resolve:{data:n}})}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(5),s=n(70),o=a(s),l=n(430),u=a(l),c={template:u.default,bindings:{data:"<"},controller:["$routeParams","Query","QueryResult",function(e,t,n){"ngInject";document.querySelector("body").classList.add("headless");var a=parseInt(e.visualizationId,10);this.showQueryDescription=e.showDescription,this.apiKey=e.api_key,this.logoUrl=o.default,this.query=new t(this.data[0]),this.queryResult=new n(this.data[1]),this.visualization=(0,i.find)(this.query.visualizations,function(e){return e.id===a})}]}},function(e,t){e.exports='<div class="tile m-10">\n  <div class="t-heading p-10">\n    <h3 class="th-title">\n      <p>\n        <img ng-src="{{$ctrl.logoUrl}}" style="height: 24px;"/>\n        {{$ctrl.query.name}}\n        <small><visualization-name visualization="$ctrl.visualization"/></small>\n      </p>\n      <small ng-if="$ctrl.showQueryDescription">\n        <div class="text-muted" ng-bind-html="$ctrl.query.description | markdown"></div>\n      </small>\n    </h3>\n  </div>\n\n  <visualization-renderer visualization="$ctrl.visualization" query-result="$ctrl.queryResult" class="t-body">\n  </visualization-renderer>\n\n  <div class="bg-ace clearfix p-10">\n    <div class="col-sm-6">\n      <span class="label label-default hidden-print">Updated: <span am-time-ago="$ctrl.queryResult.getUpdatedAt()"></span></span>\n      <span class="label label-default visible-print">Updated: {{$ctrl.queryResult.getUpdatedAt() | dateTime}}</span>\n    </div>\n    <div class="col-sm-6 text-right hidden-print">\n      <a class="btn btn-default btn-xs" ng-href="queries/{{$ctrl.query.id}}#{{$ctrl.visualization.id}}" target="_blank" tooltip="Open in Redash">\n        <span class="zmdi zmdi-link"></span>\n      </a>\n\n      <div class="btn-group" uib-dropdown>\n        <button type="button" class="btn btn-default btn-xs dropdown-toggle" aria-haspopup="true" uib-dropdown-toggle\n                aria-expanded="false">\n          Download Dataset <span class="caret"></span>\n        </button>\n        <ul class="dropdown-menu pull-right" uib-dropdown-menu>\n          <li>\n            <a ng-href="{{$ctrl.queryResult.getLink($ctrl.query.id, \'csv\', $ctrl.apiKey)}}" download="{{$ctrl.queryResult.getName($ctrl.query.name, \'csv\')}}" target="_self">\n              <span class="fa fa-file-o"></span> Download as CSV File\n            </a>\n          </li>\n          <li>\n            <a ng-href="{{$ctrl.queryResult.getLink($ctrl.query.id, \'xlsx\', $ctrl.apiKey)}}" download="{{$ctrl.queryResult.getName($ctrl.query.name, \'xlsx\')}}"  target="_self">\n              <span class="fa fa-file-excel-o"></span> Download as Excel File\n            </a>\n          </li>\n        </ul>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(){var e=null;this.visualization&&(e="TABLE"===this.visualization.type?"table":this.visualization.id),this.link=this.query.getUrl(!1,e)}function r(e){e.component("queryLink",{bindings:{query:"<",visualization:"<"},template:'<a ng-href="{{$ctrl.link}}" class="query-link">{{$ctrl.query.name}}</a>',controller:a})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r},function(e,t,n){"use strict";function a(e){return{restrict:"E",scope:{tabId:"@",name:"@",basePath:"=?"},transclude:!0,template:'<li class="rd-tab" ng-class="{active: tabId==selectedTab}"><a href="{{basePath}}#{{tabId}}">{{name}}<span ng-transclude></span></a></li>',replace:!0,link:function(t){t.basePath=t.basePath||e.path().substring(1),t.$watch(function(){return t.$parent.selectedTab},function(e){t.selectedTab=e})}}}function r(e){e.directive("rdTab",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a.$inject=["$location"]},function(e,t,n){"use strict";function a(e){e.component("rdTimeAgo",r)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r={bindings:{value:"="},controller:function(){},template:'<span><span ng-show="$ctrl.value" am-time-ago="$ctrl.value"></span><span ng-hide="$ctrl.value">-</span></span>'}},function(e,t,n){"use strict";function a(){return{restrict:"E",scope:{timestamp:"="},template:"{{currentTime}}",controller:["$scope",function(e){e.currentTime="00:00:00";var t=setInterval(function(){e.currentTime=(0,s.default)((0,s.default)()-(0,s.default)(e.timestamp)).utc().format("HH:mm:ss"),e.$digest()},1e3);e.$on("$destroy",function(){t&&(clearInterval(t),t=null)})}]}}function r(e){e.directive("rdTimer",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(0),s=function(e){return e&&e.__esModule?e:{default:e}}(i)},function(e,t,n){"use strict";function a(e){e.component("routeStatus",{template:'<overlay ng-if="$ctrl.permissionDenied">You do not have permission to load this page.',controller:["$rootScope",function(e){var t=this;this.permissionDenied=!1,e.$on("$routeChangeSuccess",function(){t.permissionDenied=!1}),e.$on("$routeChangeError",function(e,n,a,r){403===r.status&&(t.permissionDenied=!0)})}]})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){e.directive("settingsScreen",["$location",function(e){return{restrict:"E",transclude:!0,template:l.default,controller:["$scope","currentUser",function(t,n){t.usersPage=(0,s.default)(e.path(),"/users"),t.groupsPage=(0,s.default)(e.path(),"/groups"),t.dsPage=(0,s.default)(e.path(),"/data_sources"),t.destinationsPage=(0,s.default)(e.path(),"/destinations"),t.snippetsPage=(0,s.default)(e.path(),"/query_snippets"),t.showGroupsLink=n.hasPermission("list_users"),t.showUsersLink=n.hasPermission("list_users"),t.showDsLink=n.hasPermission("admin"),t.showDestinationsLink=n.hasPermission("admin"),t.showQuerySnippetsLink=n.hasPermission("create_query")}]}}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(231),s=a(i),o=n(437),l=a(o)},function(e,t){e.exports='<page-header title="Settings">\n</page-header>\n\n<div class="container">\n  <div class="container bg-white p-5">\n    <ul class="tab-nav">\n      <li ng-class="{\'active\': dsPage }" ng-if="showDsLink"><a href="data_sources">Data Sources</a></li>\n      <li ng-class="{\'active\': usersPage }" ng-if="showUsersLink"><a href="users">Users</a></li>\n      <li ng-class="{\'active\': groupsPage }" ng-if="showGroupsLink"><a href="groups">Groups</a></li>\n      <li ng-class="{\'active\': destinationsPage }" ng-if="showDestinationsLink"><a href="destinations">Alert Destinations</a></li>\n      <li ng-class="{\'active\': snippetsPage }" ng-if="showQuerySnippetsLink"><a href="query_snippets">Query Snippets</a></li>\n    </ul>\n\n    <div ng-transclude>\n\n    </div>\n  </div>\n</div>'},function(e,t,n){"use strict";function a(e){e.component("sortIcon",{template:'<span ng-if="$ctrl.showIcon"><i class="fa fa-sort-{{$ctrl.icon}}"></i></span>',bindings:{column:"<",sortColumn:"<",reverse:"<"},controller:function(){var e=this;this.$onChanges=function(t){["column","sortColumn","reverse"].forEach(function(n){n in t&&(e[n]=t[n].currentValue)}),e.showIcon=!1,e.column===e.sortColumn&&(e.showIcon=!0,e.icon=e.reverse?"desc":"asc")}}})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,n){"use strict";function a(e){this.tabs.forEach(function(t){t.isActive?t.active=t.isActive(e.path()):t.active=(0,s.default)(e.path(),"/"+t.path)})}function r(e){e.component("tabNav",{template:'<ul class="tab-nav bg-white"><li ng-repeat="tab in $ctrl.tabs" ng-class="{\'active\': tab.active }"><a ng-href="{{tab.path}}">{{tab.name}}</a></li></ul>',controller:a,bindings:{tabs:"<"}})}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(231),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["$location"]},function(e,t,n){"use strict";function a(e){return{restrict:"E",scope:{visualization:"="},template:"{{name}}",replace:!1,link:function(t){var n=t.visualization.type;e.visualizations[n].name!==t.visualization.name&&(t.name=t.visualization.name)}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t,n){function a(e){return n(r(e))}function r(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./alert-dialog.js":442,"./alert-subscription.js":443,"./alert.js":444,"./auth.js":445,"./dashboard.js":446,"./data-source.js":447,"./destination.js":448,"./events.js":449,"./group.js":450,"./keyboard-shortcuts.js":451,"./notifications.js":454,"./offline-listener.js":455,"./query-result.js":232,"./query-snippet.js":456,"./query.js":457,"./user.js":459,"./widget.js":460};a.keys=function(){return Object.keys(i)},a.resolve=r,e.exports=a,a.id=441},function(e,t,n){"use strict";function a(e){return{open:function(t,n,a){return e.open({component:"alertDialog",resolve:{title:function(){return t},message:function(){return n},confirm:function(){return a}}}).result}}}function r(e){e.component("alertDialog",s),e.factory("AlertDialog",a)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.default=r,a.$inject=["$uibModal"];var s={template:'\n<div class="modal-header">\n    <h4 class="modal-title" ng-if="$ctrl.title">{{$ctrl.title}}</h4>\n</div>\n<div class="modal-body">\n  <p ng-bind-html="$ctrl.message"></p>\n</div>\n<div class="modal-footer">\n  <button class="btn btn-default" ng-click="$ctrl.dismiss()">Cancel</button>\n  <button class="btn" ng-class="$ctrl.confirm.class" ng-click="$ctrl.close()" ng-if="$ctrl.confirm.show">{{$ctrl.confirm.title}}</button>\n</div>\n  ',bindings:{close:"&",dismiss:"&",resolve:"<"},controller:function(){this.title=this.resolve.title,this.message=this.resolve.message,this.confirm=i({},{class:"btn-sucess",show:!0,title:"OK"},this.resolve.confirm)}}},function(e,t,n){"use strict";function a(e){return e("api/alerts/:alertId/subscriptions/:subscriberId",{alertId:"@alert_id",subscriberId:"@id"})}function r(e){e.factory("AlertSubscription",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a.$inject=["$resource"]},function(e,t,n){"use strict";function a(e,t){return e("api/alerts/:id",{id:"@id"},{save:{method:"POST",transformRequest:[function(e){var t=i({},e);return void 0===t.query_id&&(t.query_id=t.query.id,t.destination_id=t.destinations,delete t.query,delete t.destinations),t}].concat(t.defaults.transformRequest)}})}function r(e){e.factory("Alert",a)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.default=r,a.$inject=["$resource","$http"]},function(e,t,n){"use strict";function a(e){f("Updating session to be:",e),c(g,e,{loaded:!0})}function r(){if(g.loaded)return g;var e=window.sessionStorage.getItem(m);return e&&a(JSON.parse(e)),g}function i(e,t,n,i){return{isAuthenticated:function(){var e=r();return e.loaded&&e.user.id},login:function(){var e=encodeURI(t.url());f("Calling login with next = %s",e),window.location.href="login?next="+e},logout:function(){f("Logout."),window.sessionStorage.removeItem(m),e.location.href="logout"},loadSession:function(){f("Loading session");var e=r();return e.loaded&&e.user.id?(f("Resolving with local value."),n.resolve(e)):(this.setApiKey(null),i.get("api/session").then(function(e){return a(e.data),g}))},loadConfig:function(){return f("Loading config"),i.get("/api/config").then(function(e){return a({client_config:e.data.client_config,user:{permissions:[]}}),e.data})},setApiKey:function(e){f("Set API key to: %s",e),this.apiKey=e},getApiKey:function(){return this.apiKey}}}function s(){var e=this,t=r();c(this,t.user),this.canEdit=function(t){var n=t.user_id||t.user&&t.user.id;return e.hasPermission("admin")||n&&n===e.id},this.hasPermission=function(t){return-1!==e.permissions.indexOf(t)},this.isAdmin=this.hasPermission("admin")}function o(){c(this,r().client_config)}function l(e){return{request:function(t){var n=e.get("Auth"),a=n.getApiKey();return a&&(t.headers.Authorization="Key "+a),t}}}function u(e){e.factory("Auth",i),e.service("currentUser",s),e.service("clientConfig",o),e.factory("apiKeyHttpInterceptor",l),e.config(["$httpProvider",function(e){e.interceptors.push("apiKeyHttpInterceptor")}]),e.run(["$location","$window","$rootScope","$route","Auth",function(e,t,n,a,r){n.$on("$routeChangeStart",function(e,t){t.authenticated&&!r.isAuthenticated()&&(f("Requested authenticated route: ",t),e.preventDefault(),r.loadSession().then(function(){f("Loaded session"),a.reload()}).catch(function(){f("Need to login, redirecting"),r.login()}))})}])}Object.defineProperty(t,"__esModule",{value:!0});var c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.default=u;var d=n(24),p=function(e){return e&&e.__esModule?e:{default:e}}(d);l.$inject=["$injector"],i.$inject=["$window","$location","$q","$http"];var f=(0,p.default)("redash:auth"),m="session",g={loaded:!1}},function(e,t,n){"use strict";function a(e,t,n,a){function r(e){e.widgets=(0,i.map)(e.widgets,function(e){return e.map(function(e){return new a(e)})}),e.publicAccessEnabled=void 0!==e.public_url}var s=t.defaults.transformResponse.concat(function(e){return(0,i.isArray)(e)?e.forEach(r):r(e),e}),o=e("api/dashboards/:slug",{slug:"@slug"},{get:{method:"GET",transformResponse:s},save:{method:"POST",transformResponse:s},query:{method:"GET",isArray:!0,transformResponse:s},recent:{method:"get",isArray:!0,url:"api/dashboards/recent",transformResponse:s}});return o.prototype.canEdit=function(){return n.canEdit(this)||this.can_edit},o}function r(e){e.factory("Dashboard",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(5);a.$inject=["$resource","$http","currentUser","Widget"]},function(e,t,n){"use strict";function a(e){return e("api/data_sources/:id",{id:"@id"},{get:{method:"GET",cache:!1,isArray:!1},query:{method:"GET",cache:!1,isArray:!0},test:{method:"POST",cache:!1,isArray:!1,url:"api/data_sources/:id/test"},getSchema:{method:"GET",cache:!1,isArray:!0,url:"api/data_sources/:id/schema"}})}function r(e){e.factory("DataSource",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a.$inject=["$resource"]},function(e,t,n){"use strict";function a(e){return e("api/destinations/:id",{id:"@id"},{get:{method:"GET",cache:!1,isArray:!1},query:{method:"GET",cache:!1,isArray:!0}})}function r(e){e.factory("Destination",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a.$inject=["$resource"]},function(e,t,n){"use strict";function a(e){var t=this;this.events=[],this.post=(0,s.debounce)(function(){var n=t.events;t.events=[],e.post("api/events",n)},1e3),this.record=function(e,t,n,a){var r={action:e,object_type:t,object_id:n,timestamp:Date.now()/1e3};i(r,a),this.events.push(r),this.post()}}function r(e){e.service("Events",a)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.default=r;var s=n(5);a.$inject=["$http"]},function(e,t,n){"use strict";function a(e){return e("api/groups/:id",{id:"@id"},{get:{method:"GET",cache:!1,isArray:!1},query:{method:"GET",cache:!1,isArray:!0},members:{method:"GET",cache:!1,isArray:!0,url:"api/groups/:id/members"},dataSources:{method:"GET",cache:!1,isArray:!0,url:"api/groups/:id/data_sources"}})}function r(e){e.factory("Group",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a.$inject=["$resource"]},function(e,t,n){"use strict";function a(){this.bind=function(e){(0,i.each)(e,function(e,t){o.default.bindGlobal(t,function(t){t.preventDefault(),e()})})},this.unbind=function(e){(0,i.each)(e,function(e,t){o.default.unbind(t)})}}function r(e){e.service("KeyboardShortcuts",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(5),s=n(452),o=function(e){return e&&e.__esModule?e:{default:e}}(s);n(453)},,,function(e,t,n){"use strict";function a(e,t){var n={pageVisible:!0};return n.monitorVisibility=function(){var e=void 0,t=void 0;void 0!==document.hidden?(e="hidden",t="visibilitychange"):void 0!==document.msHidden&&(e="msHidden",t="msvisibilitychange");var a=document[e];document.addEventListener(t,function(){a!==document[e]&&(document[e]?n.pageVisible=!1:n.pageVisible=!0,a=document[e])})},n.monitorVisibility(),n.isSupported=function(){return"Notification"in window||(o("HTML5 notifications are not supported."),!1)},n.getPermissions=function(){this.isSupported()&&"default"===Notification.permission&&Notification.requestPermission(function(e){Notification.permission!==e&&(Notification.permission=e)})},n.showNotification=function(e,n){if(this.isSupported()&&!this.pageVisible&&"granted"===Notification.permission){var a=new Notification(e,{tag:e+n,body:n,icon:"/images/redash_icon_small.png"});setTimeout(function(){a.close()},3e3),a.onclick=function(){window.focus(),this.close(),t.record("click","notification")}}},n}function r(e){e.factory("Notifications",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(24),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["currentUser","Events"];var o=(0,s.default)("redash:notifications")},function(e,t,n){"use strict";function a(e){function t(t){function n(){e.remove(t.toastId),window.removeEventListener("online",n)}window.addEventListener("online",n)}window.addEventListener("offline",function(){t(e.warning("<div>Please check your Internet connection.</div>","",{allowHtml:!0,autoDismiss:!1,timeOut:!1,tapToDismiss:!0}))})}function r(e){e.service("OfflineListener",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a.$inject=["toastr"]},function(e,t,n){"use strict";function a(e){var t=e("api/query_snippets/:id",{id:"@id"});return t.prototype.getSnippet=function(){var e=this.trigger;return""!==this.description&&(e=this.trigger+": "+this.description),{name:e,content:this.snippet,tabTrigger:this.trigger}},t}function r(e){e.factory("QuerySnippet",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a.$inject=["$resource"]},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){var t=[];return e.forEach(function(e){"name"===e[0]||"&"===e[0]?t.push(e[1]):"#"===e[0]&&(t=(0,g.union)(t,i(e[4])))}),t}function s(e,t,n,a,r,i){var s=e("api/queries/:id",{id:"@id"},{search:{method:"get",isArray:!0,url:"api/queries/search"},recent:{method:"get",isArray:!0,url:"api/queries/recent"},query:{isArray:!1},myQueries:{method:"get",isArray:!1,url:"api/queries/my"},fork:{method:"post",isArray:!1,url:"api/queries/:id/fork",params:{id:"@id"}},resultById:{method:"get",isArray:!1,url:"api/queries/:id/results.json"}});return s.newQuery=function(){return new s({query:"",name:"New Query",schedule:null,user:r,options:{}})},s.format=function(e,a){if("json"!==e)return"sql"===e?t.post("api/queries/format",{query:a}).then(function(e){return e.data.query}):n.reject("Query formatting is not supported for your data source syntax.");try{var r=JSON.stringify(JSON.parse(a)," ",4);return n.resolve(r)}catch(e){return n.reject(String(e))}},s.prototype.getSourceLink=function(){return"/queries/"+this.id+"/source"},s.prototype.isNew=function(){return void 0===this.id},s.prototype.hasDailySchedule=function(){return this.schedule&&null!==this.schedule.match(/\d\d:\d\d/)},s.prototype.scheduleInLocalTime=function(){var e=this.schedule.split(":");return c.default.utc().hour(e[0]).minute(e[1]).local().format("HH:mm")},s.prototype.hasResult=function(){return!(!this.latest_query_data&&!this.latest_query_data_id)},s.prototype.paramsRequired=function(){return this.getParameters().isRequired()},s.prototype.getQueryResult=function(e){if(!this.query)return new v("Can't execute empty query.");var t=this.query,n=this.getParameters(),a=n.getMissing();if(a.length>0){var r="parameter",s="value";return a.length>1&&(r="parameters",s="values"),new i({job:{error:"missing "+s+" for "+a.join(", ")+" "+r+".",status:4}})}if(n.isRequired()&&(t=m.default.render(t,n.getValues()),this.latest_query_data=null,this.latest_query_data_id=null),this.latest_query_data&&0!==e)this.queryResult||(this.queryResult=new i({query_result:this.latest_query_data}));else if(this.latest_query_data_id&&0!==e)this.queryResult||(this.queryResult=i.getById(this.latest_query_data_id));else{if(!this.data_source_id)return new v("Please select data source to run this query.");this.queryResult=i.get(this.data_source_id,t,e,this.id)}return this.queryResult},s.prototype.getUrl=function(e,t){var n="queries/"+this.id;e&&(n+="/source");var a="";return this.getParameters().isRequired()&&(0,g.each)(this.getParameters().getValues(),function(e,t){null!==e&&(""!==a&&(a+="&"),a+="p_"+encodeURIComponent(t)+"="+encodeURIComponent(e))}),""!==a&&(n+="?"+a),t&&(n+="#"+t),n},s.prototype.getQueryResultPromise=function(){return this.getQueryResult().toPromise()},s.prototype.getParameters=function(){return this.$parameters||(this.$parameters=new y(this,a.search())),this.$parameters},s.prototype.getParametersDefs=function(){return this.getParameters().get()},s}function o(e){e.factory("Query",s)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();t.default=o;var u=n(0),c=a(u),d=n(24),p=a(d),f=n(458),m=a(f),g=n(5);s.$inject=["$resource","$http","$q","$location","currentUser","QueryResult"];var h=(0,p.default)("redash:services:query"),v=function(){function e(t){r(this,e),this.errorMessage=t}return l(e,[{key:"getError",value:function(){return this.errorMessage}}],[{key:"getStatus",value:function(){return"failed"}},{key:"getData",value:function(){return null}},{key:"getLog",value:function(){return null}},{key:"getChartData",value:function(){return null}}]),e}(),b=function(){function e(t){r(this,e),this.title=t.title,this.name=t.name,this.type=t.type,this.value=t.value,this.global=t.global,this.enumOptions=t.enumOptions,this.queryId=t.queryId}return l(e,[{key:"ngModel",get:function(){return"date"===this.type||"datetime-local"===this.type||"datetime-with-seconds"===this.type?(this.$$value=this.$$value||(0,c.default)(this.value).toDate(),this.$$value):"number"===this.type?(this.$$value=this.$$value||parseInt(this.value,10),this.$$value):this.value},set:function(e){e&&"date"===this.type?(this.value=(0,c.default)(e).format("YYYY-MM-DD"),this.$$value=(0,c.default)(this.value).toDate()):e&&"datetime-local"===this.type?(this.value=(0,c.default)(e).format("YYYY-MM-DD HH:mm"),this.$$value=(0,c.default)(this.value).toDate()):e&&"datetime-with-seconds"===this.type?(this.value=(0,c.default)(e).format("YYYY-MM-DD HH:mm:ss"),this.$$value=(0,c.default)(this.value).toDate()):this.value=this.$$value=e}}]),e}(),y=function(){function e(t,n){r(this,e),this.query=t,this.updateParameters(),this.initFromQueryString(n)}return l(e,[{key:"parseQuery",value:function(){var e=[];try{var t=m.default.parse(this.query.query);e=(0,g.uniq)(i(t))}catch(e){h("Failed parsing parameters: ",e)}return e}},{key:"updateParameters",value:function(){var e=this;if(this.query.query!==this.cachedQueryText){this.cachedQueryText=this.query.query;var t=this.parseQuery();this.query.options.parameters=this.query.options.parameters||[];var n={};this.query.options.parameters.forEach(function(e){n[e.name]=e}),t.forEach(function(t){(0,g.has)(n,t)||e.query.options.parameters.push({title:t,name:t,type:"text",value:null,global:!1})});var a=function(e){return(0,g.contains)(t,e.name)};this.query.options.parameters=this.query.options.parameters.filter(a).map(function(e){return new b(e)})}}},{key:"initFromQueryString",value:function(e){this.get().forEach(function(t){var n="p_"+t.name;(0,g.has)(e,n)&&(t.value=e[n])})}},{key:"get",value:function(){return this.updateParameters(),this.query.options.parameters}},{key:"getMissing",value:function(){return(0,g.pluck)((0,g.filter)(this.get(),function(e){return null===e.value||""===e.value}),"title")}},{key:"isRequired",value:function(){return!(0,g.isEmpty)(this.get())}},{key:"getValues",value:function(){var e=this.get();return(0,g.object)((0,g.pluck)(e,"name"),(0,g.pluck)(e,"value"))}}]),e}()},,function(e,t,n){"use strict";function a(e){void 0!==e.groups&&(e.admin=-1!==e.groups.indexOf("admin"))}function r(e){return(0,o.isArray)(e)?e.forEach(a):a(e),e}function i(e,t){var n=t.defaults.transformResponse.concat(r);return e("api/users/:id",{id:"@id"},{get:{method:"GET",transformResponse:n},save:{method:"POST",transformResponse:n},query:{method:"GET",isArray:!0,transformResponse:n},delete:{method:"DELETE",transformResponse:n}})}function s(e){e.factory("User",i)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var o=n(5);i.$inject=["$resource","$http"]},function(e,t,n){"use strict";function a(e,t){var n=e("api/widgets/:id",{id:"@id"});return n.prototype.getQuery=function(){return!this.query&&this.visualization&&(this.query=new t(this.visualization.query)),this.query},n.prototype.getName=function(){return this.visualization?this.visualization.query.name+" ("+this.visualization.name+")":(0,s.default)(this.text,20)},n}function r(e){e.factory("Widget",a)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(461),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["$resource","Query"]},,function(e,t,n){function a(e){return n(r(e))}function r(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./basic-image-show/index.js":463,"./box-plot/index.js":466,"./chart/index.js":469,"./chart/plotly.js":472,"./cohort/index.js":632,"./counter/index.js":636,"./edit-visualization-dialog.js":640,"./index.js":642,"./map/index.js":643,"./pivot/index.js":654,"./sankey/index.js":658,"./sunburst/index.js":661,"./table/index.js":664,"./word-cloud/index.js":666};a.keys=function(){return Object.keys(i)},a.resolve=r,e.exports=a,a.id=462},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){return e>=0?e-1:(Math.abs(e)>t&&(e%=t),t+e)}function i(){return{restrict:"E",template:u.default,link:function(e){var t=function(){var t=e.queryResult.getData();if(t){var n=r(e.visualization.options.rowNumber,t.length),a=e.visualization.options.avatarColName,i=e.visualization.options.captionColName;a&&(e.avatar=t[n][a]),e.captionValue=i?t[n][i]:null}};e.$watch("visualization.options",t,!0),e.$watch("queryResult && queryResult.getData()",t)}}}function s(){return{restrict:"E",template:d.default,link:function(e){e.currentTab="general",e.changeTab=function(t){e.currentTab=t}}}}function o(e){e.directive("basicImageShowEditor",s),e.directive("basicImageShowRenderer",i),e.config(["VisualizationProvider",function(e){var t={avatarColName:"avatar",rowNumber:1,targetRowNumber:1,stringDecimal:0,stringDecChar:".",stringThouSep:","};e.registerVisualization({type:"BASICIMAGESHOW",name:"Basic Image Show",renderTemplate:'<basic-image-show-renderer options="visualization.options" query-result="queryResult"></basic-image-show-renderer>',editorTemplate:"<basic-image-show-editor></basic-image-show-editor>",defaultOptions:t})}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var l=n(464),u=a(l),c=n(465),d=a(c)},function(e,t){e.exports='<basic-image-show>\n  <value ng-bind-html="avatar"></value>\n  <basic-image-show-target ng-if="captionValue">\n    <value>{{captionValue}}</value>\n  </basic-image-show-target>\n  <basic-image-show-name>\n    <value>{{visualization.name}}</value>\n  </basic-image-show-name>\n</basic-image-show>\n'},function(e,t){e.exports='<div class="form-horizontal">\n  <ul class="tab-nav">\n    <li ng-class="{active: currentTab == \'general\'}">\n      <a ng-click="changeTab(\'general\')">General</a>\n    </li>\n  </ul>\n  <div ng-show="currentTab == \'general\'">\n    <div class="form-group">\n      <label class="col-lg-6">Basic Show Image Value Column Name</label>\n      <div class="col-lg-6">\n        <select ng-options="name for name in queryResult.getColumnNames()" ng-model="visualization.options.avatarColName" class="form-control"></select>\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-lg-6">Basic Show Image Value Row Number</label>\n      <div class="col-lg-6">\n        <input type="number" ng-model="visualization.options.rowNumber" class="form-control" min="1" ng-max="queryResult.getData().length" max="{{queryResult.getData().length}}">\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-lg-6">Avatar Caption Column Name</label>\n      <div class="col-lg-6">\n        <select ng-options="name for name in queryResult.getColumnNames()" ng-model="visualization.options.captionColName" class="form-control">\n          <option value="">No caption value</option>\n        </select>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){return{restrict:"E",template:"<div></div>",link:function(e,t){function n(e){return function(t){for(var n=t.quartiles[0],a=t.quartiles[2],r=(a-n)*e,i=-1,s=t.length;t[++i]<n-r;);for(;t[--s]>a+r;);return[i,s]}}e.$watch("[queryResult && queryResult.getData(), visualization.options]",function(){function a(e){return y(b[e])+(y(b[1])-s.inner)/2}if(null!==e.queryResult.getData()){var r=e.queryResult.getData(),i=l.default.select(t[0].parentNode).node().getBoundingClientRect().width,s={top:10,right:50,bottom:40,left:50,inner:25},o=i-s.right-s.left,u=500-s.top-s.bottom,d=1/0,p=-1/0,f=[],m=0,g=[],h=e.visualization.options.xAxisLabel,v=e.visualization.options.yAxisLabel,b=e.queryResult.getColumnNames(),y=l.default.scale.ordinal().domain(b).rangeBands([0,i-s.left-s.right]),w=void 0;w=b.length>1?Math.min(y(b[1]),120):120,s.inner=w/3,b.forEach(function(e,t){g=f[t]=[],r.forEach(function(t){m=t[e],g.push(m),m>p&&(p=Math.ceil(m)),m<d&&(d=Math.floor(m))})});var x=l.default.scale.linear().domain([.99*d,1.01*p]).range([u,0]),q=(0,c.default)().whiskers(n(1.5)).width(w-2*s.inner).height(u).domain([.99*d,1.01*p]),_=l.default.svg.axis().scale(y).orient("bottom"),$=l.default.svg.axis().scale(x).orient("left"),k=l.default.svg.axis().scale(y).tickSize(u).orient("bottom"),z=l.default.svg.axis().scale(x).tickSize(o).orient("right");l.default.select(t[0]).selectAll("svg").remove();var A=l.default.select(t[0]).append("svg").attr("width",i).attr("height",u+s.bottom+s.top).append("g").attr("width",i-s.left-s.right).attr("transform","translate("+s.left+","+s.top+")");l.default.select("svg").append("text").attr("class","box").attr("x",i/2).attr("text-anchor","middle").attr("y",u+s.bottom).text(h),l.default.select("svg").append("text").attr("class","box").attr("transform","translate(10,"+(u+s.top+s.bottom)/2+")rotate(-90)").attr("text-anchor","middle").text(v),A.append("rect").attr("class","grid-background").attr("width",o).attr("height",u),A.append("g").attr("class","grid").call(z),A.append("g").attr("class","grid").call(k),A.append("g").attr("class","x axis").attr("transform","translate(0,"+u+")").call(_),A.append("g").attr("class","y axis").call($),A.selectAll(".box").data(f).enter().append("g").attr("class","box").attr("width",w).attr("height",u).attr("transform",function(e,t){return"translate("+a(t)+",0)"}).call(q)}},!0)}}}function i(){return{restrict:"E",template:p.default}}function s(e){e.directive("boxplotRenderer",r),e.directive("boxplotEditor",i),e.config(["VisualizationProvider",function(e){e.registerVisualization({type:"BOXPLOT",name:"Boxplot (Deprecated)",renderTemplate:'<boxplot-renderer options="visualization.options" query-result="queryResult"></boxplot-renderer>',editorTemplate:"<boxplot-editor></boxplot-editor>"})}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var o=n(2),l=a(o),u=n(467),c=a(u),d=n(468),p=a(d)},function(e,t,n){"use strict";function a(){function e(e){e.each(function(e,r){e=e.map(o).sort(d3.ascending);var i=d3.select(this),d=e.length,p=e[0],f=e[d-1],m=e.quartiles=u(e),g=l&&l.call(this,e,r),h=g&&g.map(function(t){return e[t]}),v=g?d3.range(0,g[0]).concat(d3.range(g[1]+1,d)):d3.range(d),b=d3.scale.linear().domain(s&&s.call(this,e,r)||[p,f]).range([n,0]),y=this.__chart__||d3.scale.linear().domain([0,1/0]).range(b.range());this.__chart__=b;var w=i.selectAll("line.center").data(h?[h]:[]);w.enter().insert("line","rect").attr("class","center").attr("x1",t/2).attr("y1",function(e){return y(e[0])}).attr("x2",t/2).attr("y2",function(e){return y(e[1])}).style("opacity",1e-6).transition().duration(a).style("opacity",1).attr("y1",function(e){return b(e[0])}).attr("y2",function(e){return b(e[1])}),w.transition().duration(a).style("opacity",1).attr("y1",function(e){return b(e[0])}).attr("y2",function(e){return b(e[1])}),w.exit().transition().duration(a).style("opacity",1e-6).attr("y1",function(e){return b(e[0])}).attr("y2",function(e){return b(e[1])}).remove();var x=i.selectAll("rect.box").data([m]);x.enter().append("rect").attr("class","box").attr("x",0).attr("y",function(e){return y(e[2])}).attr("width",t).attr("height",function(e){return y(e[0])-y(e[2])}).transition().duration(a).attr("y",function(e){return b(e[2])}).attr("height",function(e){return b(e[0])-b(e[2])}),x.transition().duration(a).attr("y",function(e){return b(e[2])}).attr("height",function(e){return b(e[0])-b(e[2])}),x.exit().remove();var q=i.selectAll("line.median").data([m[1]]);q.enter().append("line").attr("class","median").attr("x1",0).attr("y1",y).attr("x2",t).attr("y2",y).transition().duration(a).attr("y1",b).attr("y2",b),q.transition().duration(a).attr("y1",b).attr("y2",b),q.exit().remove();var _=i.selectAll("line.whisker").data(h||[]);_.enter().insert("line","circle, text").attr("class","whisker").attr("x1",0).attr("y1",y).attr("x2",t).attr("y2",y).style("opacity",1e-6).transition().duration(a).attr("y1",b).attr("y2",b).style("opacity",1),_.transition().duration(a).attr("y1",b).attr("y2",b).style("opacity",1),_.exit().transition().duration(a).attr("y1",b).attr("y2",b).style("opacity",1e-6).remove();var $=i.selectAll("circle.outlier").data(v,Number);$.enter().insert("circle","text").attr("class","outlier").attr("r",5).attr("cx",t/2).attr("cy",function(t){return y(e[t])}).style("opacity",1e-6).transition().duration(a).attr("cy",function(t){return b(e[t])}).style("opacity",1),$.transition().duration(a).attr("cy",function(t){return b(e[t])}).style("opacity",1),$.exit().transition().duration(a).attr("cy",function(t){return b(e[t])}).style("opacity",1e-6).remove();var k=c||b.tickFormat(8),z=i.selectAll("text.box").data(m);z.enter().append("text").attr("class","box").attr("dy",".3em").attr("dx",function(e,t){return 1&t?6:-6}).attr("x",function(e,n){return 1&n?t:0}).attr("y",y).attr("text-anchor",function(e,t){return 1&t?"start":"end"}).text(k).transition().duration(a).attr("y",b),z.transition().duration(a).text(k).attr("y",b),z.exit().remove();var A=i.selectAll("text.whisker").data(h||[]);A.enter().append("text").attr("class","whisker").attr("dy",".3em").attr("dx",6).attr("x",t).attr("y",y).text(k).style("opacity",1e-6).transition().duration(a).attr("y",b).style("opacity",1),A.transition().duration(a).text(k).attr("y",b).style("opacity",1),A.exit().transition().duration(a).attr("y",b).style("opacity",1e-6).remove()}),d3.timer.flush()}var t=1,n=1,a=0,s=null,o=Number,l=r,u=i,c=null;return e.width=function(n){return arguments.length?(t=n,e):t},e.height=function(t){return arguments.length?(n=t,e):n},e.tickFormat=function(t){return arguments.length?(c=t,e):c},e.duration=function(t){return arguments.length?(a=t,e):a},e.domain=function(t){return arguments.length?(s=null==t?t:d3.functor(t),e):s},e.value=function(t){return arguments.length?(o=t,e):o},e.whiskers=function(t){return arguments.length?(l=t,e):l},e.quartiles=function(t){return arguments.length?(u=t,e):u},e}function r(e){return[0,e.length-1]}function i(e){return[d3.quantile(e,.25),d3.quantile(e,.5),d3.quantile(e,.75)]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},function(e,t){e.exports='<div class="form-horizontal">\n  <div class="form-group">\n    <label class="col-lg-6">X Axis Label</label>\n    <div class="col-lg-6">\n      <input type="text" ng-model="visualization.options.xAxisLabel" class="form-control"></input>\n    </div>\n  </div>\n\n  <div class="form-group">\n    <label class="col-lg-6">Y Axis Label</label>\n    <div class="col-lg-6">\n      <input type="text" ng-model="visualization.options.yAxisLabel" class="form-control"></input>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){return{restrict:"E",scope:{queryResult:"=",options:"=?"},template:u.default,replace:!1,controller:["$scope",function(e){function t(t){return e.options.seriesOptions[t.name]?e.options.seriesOptions[t.name].zIndex:0}function n(){if(!(0,o.isUndefined)(e.queryResult)&&e.queryResult.getData()){var n=e.queryResult.getChartData(e.options.columnMapping);e.chartSeries=(0,o.sortBy)(n,t)}}function a(){n(),e.plotlyOptions=e.options}e.chartSeries=[],e.$watch("options",a,!0),e.$watch("queryResult && queryResult.getData()",n)}]}}function i(e,t){return{restrict:"E",template:d.default,scope:{queryResult:"=",options:"=?"},link:function(n){function a(){n.columns=n.queryResult.getColumns(),n.columnNames=(0,o.pluck)(n.columns,"name"),n.columnNames.length>0&&(0,o.each)((0,o.difference)((0,o.keys)(n.options.columnMapping),n.columnNames),function(e){delete n.options.columnMapping[e]})}function r(){a(),n.queryResult.getData()&&0!==n.queryResult.getData().length&&0!==n.columns.length&&(n.form.yAxisColumns=(0,o.intersection)(n.form.yAxisColumns,n.columnNames),(0,o.contains)(n.columnNames,n.form.xAxisColumn)||(n.form.xAxisColumn=void 0),(0,o.contains)(n.columnNames,n.form.groupby)||(n.form.groupby=void 0))}function i(){var e=(0,o.pluck)(n.queryResult.getChartData(n.options.columnMapping),"name"),t=(0,o.keys)(n.options.seriesOptions);(0,o.each)((0,o.difference)(e,t),function(e){n.options.seriesOptions[e]={type:n.options.globalSeriesType,yAxis:0},n.form.seriesList.push(e)}),(0,o.each)((0,o.difference)(t,e),function(e){n.form.seriesList=(0,o.without)(n.form.seriesList,e),delete n.options.seriesOptions[e]})}function s(e,t){n.options.columnMapping[t]=e}function l(e){s("unused",e)}n.currentTab="general",n.colors=(0,o.extend)({Automatic:null},e),n.stackingOptions={Disabled:null,Enabled:"normal",Percent:"percent"},n.changeTab=function(e){n.currentTab=e},n.chartTypes={line:{name:"Line",icon:"line-chart"},column:{name:"Bar",icon:"bar-chart"},area:{name:"Area",icon:"area-chart"},pie:{name:"Pie",icon:"pie-chart"},scatter:{name:"Scatter",icon:"circle-o"},bubble:{name:"Bubble",icon:"circle-o"},box:{name:"Box",icon:"square-o"}},t.allowCustomJSVisualizations&&(n.chartTypes.custom={name:"Custom",icon:"code"}),n.xAxisScales=["datetime","linear","logarithmic","category"],n.yAxisScales=["linear","logarithmic","datetime","category"],n.chartTypeChanged=function(){(0,o.keys)(n.options.seriesOptions).forEach(function(e){n.options.seriesOptions[e].type=n.options.globalSeriesType})},n.showSizeColumnPicker=function(){return(0,o.some)(n.options.seriesOptions,function(e){return"bubble"===e.type})},void 0===n.options.customCode&&(n.options.customCode="// Available variables are x, ys, element, and Plotly\n// Type console.log(x, ys); for more info about x and ys\n// To plot your graph call Plotly.plot(element, ...)\n// Plotly examples and docs: https://plot.ly/javascript/"),a(),n.$watch("options.columnMapping",function(){"done"===n.queryResult.status&&i()},!0),n.$watch(function(){return[n.queryResult.getId(),n.queryResult.status]},function(e){e[0]&&"done"===e[1]&&(r(),i())},!0),n.form={yAxisColumns:[],seriesList:(0,o.sortBy)((0,o.keys)(n.options.seriesOptions),function(e){return n.options.seriesOptions[e].zIndex})},n.$watchCollection("form.seriesList",function(e){(0,o.each)(e,function(e,t){n.options.seriesOptions[e].zIndex=t,n.options.seriesOptions[e].index=0})}),n.$watchCollection("form.yAxisColumns",function(e,t){(0,o.each)(t,l),(0,o.each)(e,(0,o.partial)(s,"y"))}),n.$watch("form.xAxisColumn",function(e,t){void 0!==t&&l(t),void 0!==e&&s("x",e)}),n.$watch("form.errorColumn",function(e,t){void 0!==t&&l(t),void 0!==e&&s("yError",e)}),n.$watch("form.sizeColumn",function(e,t){void 0!==t&&l(t),void 0!==e&&s("size",e)}),n.$watch("form.groupby",function(e,t){void 0!==t&&l(t),void 0!==e&&s("series",e)}),(0,o.has)(n.options,"legend")||(n.options.legend={enabled:!0}),(0,o.has)(n.options,"bottomMargin")||(n.options.bottomMargin=50),n.columnNames&&(0,o.each)(n.options.columnMapping,function(e,t){n.columnNames.length>0&&!(0,o.contains)(n.columnNames,t)||("x"===e?n.form.xAxisColumn=t:"y"===e?n.form.yAxisColumns.push(t):"series"===e?n.form.groupby=t:"yError"===e?n.form.errorColumn=t:"size"===e&&(n.form.sizeColumn=t))})}}}function s(e){e.component("colorBox",p),e.directive("chartRenderer",r),e.directive("chartEditor",i),e.config(["VisualizationProvider",function(e){var t={globalSeriesType:"column",sortX:!0,legend:{enabled:!0},yAxis:[{type:"linear"},{type:"linear",opposite:!0}],xAxis:{type:"datetime",labels:{enabled:!0}},error_y:{type:"data",visible:!0},series:{stacking:null,error_y:{type:"data",visible:!0}},seriesOptions:{},columnMapping:{},bottomMargin:50};e.registerVisualization({type:"CHART",name:"Chart",renderTemplate:'<chart-renderer options="visualization.options" query-result="queryResult"></chart-renderer>',editorTemplate:'<chart-editor options="visualization.options" query-result="queryResult"></chart-editor>',defaultOptions:t})}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var o=n(5),l=n(470),u=a(l),c=n(471),d=a(c);i.$inject=["ColorPalette","clientConfig"];var p={bindings:{color:"<"},template:"<span style='width: 12px; height: 12px; background-color: {{$ctrl.color}}; display: inline-block; margin-right: 5px;'></span>"}},function(e,t){e.exports="<div ng-if=\"plotlyOptions.globalSeriesType != 'custom'\">\n  <plotly-chart options='plotlyOptions' series='chartSeries' height=\"300\"></plotly-chart>\n</div>\n<div ng-if=\"plotlyOptions.globalSeriesType == 'custom'\">\n  <custom-plotly-chart series='chartSeries' options='plotlyOptions' height=\"300\"></custom-plotly-chart>\n</div>\n"},function(e,t){e.exports='<div>\n  <ul class="tab-nav">\n    <li ng-class="{active: currentTab == \'general\'}">\n      <a ng-click="changeTab(\'general\')">General</a>\n    </li>\n    <li ng-class="{active: currentTab == \'xAxis\'}" ng-if="options.globalSeriesType != \'custom\'">\n      <a ng-click="changeTab(\'xAxis\')">X Axis</a>\n    </li>\n    <li ng-class="{active: currentTab == \'yAxis\'}" ng-if="options.globalSeriesType != \'custom\'">\n      <a ng-click="changeTab(\'yAxis\')">Y Axis</a>\n    </li>\n    <li ng-class="{active: currentTab == \'series\'}" ng-if="options.globalSeriesType != \'custom\'">\n      <a ng-click="changeTab(\'series\')">Series</a>\n    </li>\n  </ul>\n  <div ng-show="currentTab == \'general\'">\n    <div class="form-group">\n      <label class="control-label">Chart Type</label>\n      <div ng-if="chartTypes">\x3c!--the if is a weird workaround--\x3e\n        <ui-select ng-model="options.globalSeriesType" on-select="chartTypeChanged()">\n          <ui-select-match placeholder="Choose chart type...">\n            <div>\n              <i class="fa fa-{{$select.selected.value.icon}}"></i>\n              {{$select.selected.value.name}}\n            </div>\n          </ui-select-match>\n          <ui-select-choices repeat="info.chartType as (chartType, info) in chartTypes">\n            <div><i class="fa fa-{{info.value.icon}}"></i><span> </span><span\n              ng-bind-html="info.value.name | highlight: $select.search"></span></div>\n          </ui-select-choices>\n        </ui-select>\n      </div>\n    </div>\n\n\n    <div class="form-group" ng-class="{\'has-error\': chartEditor.xAxisColumn.$invalid}">\n      <label class="control-label">X Column</label>\n\n      <ui-select name="xAxisColumn" required ng-model="form.xAxisColumn">\n        <ui-select-match placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:form.yAxisColumns | remove:form.groupby">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    \x3c!-- not using regular validation (chartEditor.yAxisColumns.$invalid) due to a bug in ui-select with multiple choices--\x3e\n    <div class="form-group" ng-class="{\'has-error\': !form.yAxisColumns || form.yAxisColumns.length == 0}">\n      <label class="control-label">Y Columns</label>\n\n      <ui-select multiple name="yAxisColumns" required ng-model="form.yAxisColumns">\n        <ui-select-match placeholder="Choose columns...">{{$item}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:form.groupby | remove:form.xAxisColumn">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n\n    </div>\n\n    <div class="form-group" ng-if="options.globalSeriesType != \'custom\'">\n      <label class="control-label">Group by</label>\n      <ui-select name="groupby" ng-model="form.groupby" class="clearable">\n        <ui-select-match allow-clear="true" placeholder="Choose column...">\n          {{$select.selected}}\n        </ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:form.yAxisColumns | remove:form.xAxisColumn">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="form-group" ng-if="showSizeColumnPicker()">\n      <label class="control-label">Bubble size column</label>\n\n      <ui-select name="sizeColumn" ng-model="form.sizeColumn">\n        <ui-select-match allow-clear="true" placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:form.yAxisColumns | remove:form.groupby">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="form-group" ng-if="options.globalSeriesType != \'custom\'">\n      <label class="control-label">Errors column</label>\n\n      <ui-select name="errorColumn" ng-model="form.errorColumn">\n        <ui-select-match allow-clear="true" placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:form.yAxisColumns | remove:form.groupby">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="checkbox" ng-if="options.globalSeriesType != \'custom\'">\n      <label>\n        <input type="checkbox" ng-model="options.legend.enabled">\n        <i class="input-helper"></i> Show Legend\n      </label>\n    </div>\n\n    <div class="checkbox" ng-if="options.globalSeriesType == \'box\'">\n      <label>\n        <input type="checkbox" ng-model="options.showpoints">\n        <i class="input-helper"></i> Show All Points\n      </label>\n    </div>\n\n    <div class="form-group" ng-if="options.globalSeriesType != \'custom\'">\n      <label class="control-label">Stacking</label>\n\n      <div ng-if="stackingOptions">\x3c!--the if is a weird workaround--\x3e\n        <ui-select ng-model="options.series.stacking"\n                   ng-disabled="[\'line\', \'area\', \'column\'].indexOf(options.globalSeriesType) == -1">\n          <ui-select-match placeholder="Choose Stacking...">{{$select.selected.key | capitalize}}</ui-select-match>\n          <ui-select-choices repeat="value.value as (key, value) in stackingOptions">\n            <div ng-bind-html="value.key | highlight: $select.search"></div>\n          </ui-select-choices>\n        </ui-select>\n      </div>\n    </div>\n\n    <div class="form-group" ng-if="options.globalSeriesType == \'box\'">\n      <label>\n        <label class="control-label">Graph Height</label>\n        <input name="graph-height" type="number" class="form-control" ng-model="options.height">\n      </label>\n    </div>\n  </div>\n\n  <div class="form-group" ng-if="options.globalSeriesType == \'custom\'">\n    <label class="control-label">Custom code</label>\n    <textarea ng-model="options.customCode" class="form-control v-resizable" rows="10">\n    </textarea>\n  </div>\n\n  <div class="checkbox" ng-if="options.globalSeriesType == \'custom\'">\n    <label>\n      <input type="checkbox" ng-model="options.enableConsoleLogs">\n      <i class="input-helper"></i> Show errors in the console\n    </label>\n  </div>\n\n  <div class="checkbox" ng-if="options.globalSeriesType == \'custom\'">\n    <label>\n      <input type="checkbox" ng-model="options.autoRedraw">\n      <i class="input-helper"></i> Auto update graph\n    </label>\n  </div>\n\n  <div ng-show="currentTab == \'xAxis\'">\n    <div class="form-group">\n      <label class="control-label">Scale</label>\n      <ui-select ng-model="options.xAxis.type">\n        <ui-select-match placeholder="Choose Scale...">{{$select.selected | capitalize}}</ui-select-match>\n        <ui-select-choices repeat="scaleType in xAxisScales">\n          <div ng-bind-html="scaleType | capitalize | highlight: $select.search"></div>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="form-group">\n      <label class="control-label">Name</label>\n      <input ng-model="options.xAxis.title.text" type="text" class="form-control"></input>\n    </div>\n\n    <div class="checkbox">\n      <label>\n        <input type="checkbox" ng-model="options.sortX">\n        <i class="input-helper"></i> Sort Values\n      </label>\n    </div>\n\n    <div class="checkbox">\n      <label>\n        <input type="checkbox" ng-model="options.xAxis.labels.enabled">\n        <i class="input-helper"></i> Show Labels\n      </label>\n    </div>\n\n    <div class="form-group">\n      <label class="control-label">Height</label>\n      <input name="x-axis-height" type="number" class="form-control" ng-model="options.bottomMargin">\n    </div>\n  </div>\n\n  <div ng-show="currentTab == \'yAxis\'">\n    <div ng-repeat="yAxis in options.yAxis">\n      <h4>{{$index == 0 ? \'Left\' : \'Right\'}} Y Axis</h4>\n\n      <div class="form-group">\n        <label class="control-label">Scale</label>\n        <ui-select ng-model="yAxis.type">\n          <ui-select-match placeholder="Choose Scale...">{{$select.selected | capitalize}}</ui-select-match>\n          <ui-select-choices repeat="scaleType in yAxisScales">\n            <div ng-bind-html="scaleType | capitalize | highlight: $select.search"></div>\n          </ui-select-choices>\n        </ui-select>\n      </div>\n      <div class="form-group">\n        <label class="control-label">Name</label>\n        <input ng-model="yAxis.title.text" type="text" class="form-control"></input>\n      </div>\n      <div class="form-group">\n        <label class="control-label">Min Value</label>\n        <input ng-model="yAxis.rangeMin" type="number" step="any" placeholder="Auto" class="form-control"></input>\n      </div>\n      <div class="form-group">\n        <label class="control-label">Max Value</label>\n        <input ng-model="yAxis.rangeMax" type="number" step="any" placeholder="Auto" class="form-control"></input>\n      </div>\n    </div>\n  </div>\n\n  <div ng-show="currentTab==\'series\'">\n    <table class="table table-condensed col-table">\n      <thead>\n      <th>zIndex</th>\n      <th>Left Y Axis</th>\n      <th>Right Y Axis</th>\n      <th>Label</th>\n      <th>Color</th>\n      <th>Type</th>\n      </thead>\n      <tbody ui-sortable ng-model="form.seriesList">\n      <tr ng-repeat="name in form.seriesList">\n        <td style="cursor: move;"><i class="fa fa-arrows-v"></i> <span\n          ng-bind="options.seriesOptions[name].zIndex + 1"></span></td>\n        <td>\n          <input type="radio" ng-value="0" ng-model="options.seriesOptions[name].yAxis">\n        </td>\n        <td>\n          <input type="radio" ng-value="1" ng-model="options.seriesOptions[name].yAxis">\n        </td>\n        <td style="padding: 3px; width: 140px;">\n          <input placeholder="{{name}}" class="form-control input-sm super-small-input" type="text"\n                 ng-model="options.seriesOptions[name].name">\n        </td>\n        <td style="padding: 3px; width: 35px;">\n          <ui-select ng-model="options.seriesOptions[name].color">\n            <ui-select-match>\n              <color-box color="$select.selected.value"></color-box>\n            </ui-select-match>\n            <ui-select-choices repeat="color.value as (key, color) in colors">\n              <color-box color="color.value"></color-box>\n              <span ng-bind-html="color.key | capitalize | highlight: $select.search"></span>\n            </ui-select-choices>\n          </ui-select>\n        </td>\n        <td style="padding: 3px; width: 105px;">\n          <ui-select ng-model="options.seriesOptions[name].type">\n            <ui-select-match placeholder="Chart Type">\n              <div>\n                <i class="fa fa-{{$select.selected.value.icon}}"></i>\n                {{$select.selected.value.name}}\n              </div>\n            </ui-select-match>\n            <ui-select-choices repeat="info.chartType as (chartType, info) in chartTypes">\n              <div><i class="fa fa-{{info.value.icon}}"></i><span> </span><span\n                ng-bind-html="info.value.name | highlight: $select.search"></span></div>\n            </ui-select-choices>\n          </ui-select>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n'},function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function fillXValues(e){var t=(0,_underscore.sortBy)(_underscore.union.apply(void 0,_toConsumableArray((0,_underscore.pluck)(e,"x"))),_underscore.identity);e.forEach(function(e){e.x=(0,_underscore.sortBy)(e.x,_underscore.identity),(0,_underscore.each)(t,function(t,n){e.x[n]!==t&&(e.x.splice(n,0,t),e.y.splice(n,0,null))})})}function storeOriginalHeightForEachSeries(e){e.forEach(function(e){(0,_underscore.has)(e,"visible")||(e.visible=!0,e.original_y=e.y.slice())})}function getEnabledSeries(e){return e.filter(function(e){return!0===e.visible})}function initializeTextAndHover(e){e.forEach(function(e){e.text=[],e.hoverinfo="text+name"})}function normalAreaStacking(e){fillXValues(e),storeOriginalHeightForEachSeries(e),initializeTextAndHover(e);var t=getEnabledSeries(e);(0,_underscore.each)(t,function(e,t,n){(0,_underscore.each)(e.y,function(a,r){var i=t>0?n[t-1].y[r]:0,s=i+e.original_y[r];e.y[r]=s,e.text.push("Value: "+e.original_y[r]+"<br>Sum: "+s)})})}function lastVisibleY(e,t,n){for(var a=t;a>=0;a-=1)if(!0===e[a].visible)return e[a].y[n];return 0}function percentAreaStacking(e){0!==e.length&&(fillXValues(e),storeOriginalHeightForEachSeries(e),initializeTextAndHover(e),(0,_underscore.each)(e[0].y,function(t,n){var a=e.reduce(function(e,t){return e+t.original_y[n]},0);(0,_underscore.each)(e,function(t,r){var i=t.original_y[n]/a*100,s=lastVisibleY(e,r-1,n);t.y[n]=i+s,t.text.push("Value: "+t.original_y[n]+"<br>Relative: "+i.toFixed(2)+"%")})}))}function percentBarStacking(e){if(0!==e.length){fillXValues(e),initializeTextAndHover(e);for(var t=0;t<e[0].y.length;t+=1){for(var n=0,a=0;a<e.length;a+=1)n+=e[a].y[t];for(var r=0;r<e.length;r+=1){var i=e[r].y[t]/n*100;e[r].text.push("Value: "+e[r].y[t]+"<br>Relative: "+i.toFixed(2)+"%"),e[r].y[t]=i}}}}function normalizeValue(e){return _moment2.default.isMoment(e)?e.format("YYYY-MM-DD HH:mm:ss"):e}function seriesMinValue(e){return(0,_underscore.min)(e.map(function(e){return(0,_underscore.min)(e.y)}))}function seriesMaxValue(e){return(0,_underscore.max)(e.map(function(e){return(0,_underscore.max)(e.y)}))}function leftAxisSeries(e){return e.filter(function(e){return"y2"!==e.yaxis})}function rightAxisSeries(e){return e.filter(function(e){return"y2"===e.yaxis})}function getScaleType(e){return"datetime"===e?"date":"logarithmic"===e?"log":e}function getColor(e){return ColorPaletteArray[e%ColorPaletteArray.length]}function init(e){e.constant("ColorPalette",ColorPalette),e.directive("plotlyChart",PlotlyChart),e.directive("customPlotlyChart",CustomPlotlyChart)}Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};exports.default=init;var _underscore=__webpack_require__(5),_d=__webpack_require__(2),_d2=_interopRequireDefault(_d),_core=__webpack_require__(473),_core2=_interopRequireDefault(_core),_bar=__webpack_require__(601),_bar2=_interopRequireDefault(_bar),_pie=__webpack_require__(606),_pie2=_interopRequireDefault(_pie),_histogram=__webpack_require__(614),_histogram2=_interopRequireDefault(_histogram),_box=__webpack_require__(623),_box2=_interopRequireDefault(_box),_moment=__webpack_require__(0),_moment2=_interopRequireDefault(_moment);_core2.default.register([_bar2.default,_pie2.default,_histogram2.default,_box2.default]),_core2.default.setPlotConfig({modeBarButtonsToRemove:["sendDataToCloud"]});var BaseColors={Blue:"#4572A7",Red:"#AA4643",Green:"#89A54E",Purple:"#80699B",Cyan:"#3D96AE",Orange:"#DB843D","Light Blue":"#92A8CD",Lilac:"#A47D7C","Light Green":"#B5CA92",Brown:"#A52A2A",Black:"#000000",Gray:"#808080",Pink:"#FFC0CB","Dark Blue":"#00008b"},ColorPalette=_extends({},BaseColors,{"Indian Red":"#F8766D","Green 2":"#53B400","Green 3":"#00C094",DarkTurquoise:"#00B6EB","Dark Violet":"#A58AFF","Pink 2":"#FB61D7"}),ColorPaletteArray=(0,_underscore.values)(BaseColors),PlotlyChart=function(){var e=50;return{restrict:"E",template:"<div></div>",scope:{options:"=",series:"=",height:"="},link:function(t,n){function a(){var n=Math.max(t.height,t.height-50+e);return"box"===t.options.globalSeriesType?t.options.height||n:n}function r(e,n){"column"===n?e.type="bar":"line"===n?e.mode="lines":"area"===n?(e.fill=null===t.options.series.stacking?"tozeroy":"tonexty",e.mode="lines"):"scatter"===n?(e.type="scatter",e.mode="markers"):"bubble"===n?e.mode="markers":"box"===n&&(e.type="box",e.mode="markers")}function i(e){return(0,_underscore.isUndefined)(e)||(0,_underscore.isUndefined)(e.title)?null:e.title.text}function s(){if(t.data.length=0,t.layout.showlegend=!(0,_underscore.has)(t.options,"legend")||t.options.legend.enabled,(0,_underscore.has)(t.options,"bottomMargin")&&(e=parseInt(t.options.bottomMargin,10),t.layout.margin.b=e),delete t.layout.barmode,delete t.layout.xaxis,delete t.layout.yaxis,delete t.layout.yaxis2,"pie"===t.options.globalSeriesType){var n=(0,_underscore.contains)((0,_underscore.values)(t.options.columnMapping),"x"),s=t.series.length>2?2:1,o=Math.ceil(t.series.length/s),l=1/o,u=1/s;return void(0,_underscore.each)(t.series,function(e,a){var r=a%o*l,i=Math.floor(a/o)*u,s={values:[],labels:[],type:"pie",hole:.4,marker:{colors:ColorPaletteArray},text:e.name,textposition:"inside",name:e.name,domain:{x:[r,r+l-.02],y:[i,i+u-.05]}};e.data.forEach(function(e){s.values.push(e.y),s.labels.push(n?e.x:"Slice "+a)}),t.data.push(s)})}"box"===t.options.globalSeriesType&&(t.layout.boxmode="group",t.layout.boxgroupgap=.5);var c=!1,d=!0===t.options.sortX||void 0===t.options.sortX,p=d&&"category"===t.options.xAxis.type&&"box"!==t.options.globalSeriesType,f=null;if(p&&(f=(0,_underscore.sortBy)(_underscore.union.apply(void 0,_toConsumableArray(t.series.map(function(e){return(0,_underscore.pluck)(e.data,"x")}))),_underscore.identity)),(0,_underscore.each)(t.series,function(e,n){var a=t.options.seriesOptions[e.name]||{type:t.options.globalSeriesType},i=a.color?a.color:getColor(n),s={x:[],y:[],error_y:{array:[],color:i},name:a.name||e.name,marker:{color:i}};1!==a.yAxis||null!==t.options.series.stacking&&"line"!==a.type||(c=!0,s.yaxis="y2"),r(s,a.type);var o=e.data;if(d&&(o=(0,_underscore.sortBy)(o,"x")),p&&0===n){var l={},u={};o.forEach(function(e){l[e.x]=e.y,e.yError&&(u[e.x]=e.yError)}),f.forEach(function(e){s.x.push(normalizeValue(e)),s.y.push(normalizeValue(l[e]||null)),(0,_underscore.isUndefined)(u[e])||s.error_y.array.push(normalizeValue(u[e]||null))})}else o.forEach(function(e){s.x.push(normalizeValue(e.x)),s.y.push(normalizeValue(e.y)),void 0!==e.yError&&s.error_y.array.push(normalizeValue(e.yError))});s.error_y.length||delete s.error_y.length,"bubble"===a.type&&(s.marker={size:(0,_underscore.pluck)(o,"size")}),"box"===a.type&&(s.boxpoints="outliers",s.marker={color:i,size:3},t.options.showpoints&&(s.boxpoints="all",s.jitter=.3,s.pointpos=-1.8)),t.data.push(s)}),t.layout.xaxis={title:i(t.options.xAxis),type:getScaleType(t.options.xAxis.type)},(0,_underscore.isUndefined)(t.options.xAxis.labels)||(t.layout.xaxis.showticklabels=t.options.xAxis.labels.enabled),(0,_underscore.isArray)(t.options.yAxis)&&(t.layout.yaxis={title:i(t.options.yAxis[0]),type:getScaleType(t.options.yAxis[0].type)},(0,_underscore.isNumber)(t.options.yAxis[0].rangeMin)||(0,_underscore.isNumber)(t.options.yAxis[0].rangeMax))){var m=t.options.yAxis[0].rangeMin||Math.min(0,seriesMinValue(leftAxisSeries(t.data))),g=t.options.yAxis[0].rangeMax||seriesMaxValue(leftAxisSeries(t.data));t.layout.yaxis.range=[m,g]}if(c&&!(0,_underscore.isUndefined)(t.options.yAxis)){if(t.layout.yaxis2={title:i(t.options.yAxis[1]),type:getScaleType(t.options.yAxis[1].type),overlaying:"y",side:"right"},(0,_underscore.isNumber)(t.options.yAxis[1].rangeMin)||(0,_underscore.isNumber)(t.options.yAxis[1].rangeMax)){var h=t.options.yAxis[1].rangeMin||Math.min(0,seriesMinValue(rightAxisSeries(t.data))),v=t.options.yAxis[1].rangeMax||seriesMaxValue(rightAxisSeries(t.data));t.layout.yaxis2.range=[h,v]}}else delete t.layout.yaxis2;"normal"===t.options.series.stacking?(t.layout.barmode="stack","area"===t.options.globalSeriesType&&normalAreaStacking(t.data)):"percent"===t.options.series.stacking&&(t.layout.barmode="stack","area"===t.options.globalSeriesType?percentAreaStacking(t.data):"column"===t.options.globalSeriesType&&percentBarStacking(t.data)),t.layout.margin.b=e,t.layout.height=a()}t.$watch("series",s),t.$watch("options",s,!0),t.layout={margin:{l:50,r:50,b:e,t:20,pad:4},height:a(),autosize:!0},t.plotlyOptions={showLink:!1,displaylogo:!1},t.data=[];var o=n[0].children[0];_core2.default.newPlot(o,t.data,t.layout,t.plotlyOptions),o.on("plotly_afterplot",function(){"area"!==t.options.globalSeriesType||"normal"!==t.options.series.stacking&&"percent"!==t.options.series.stacking||document.querySelectorAll(".legendtoggle").forEach(function(e,n){_d2.default.select(e).on("click",function(){var e=t.data.length-1,a=t.data[e-n];a.visible=!0!==a.visible||"legendonly","normal"===t.options.series.stacking?normalAreaStacking(t.data):"percent"===t.options.series.stacking&&percentAreaStacking(t.data),_core2.default.redraw(o)})})}),t.$watch("layout",function(e,t){(0,_underscore.isEqual)(e,t)||_core2.default.relayout(o,e)},!0),t.$watch("data",function(e){(0,_underscore.isEmpty)(e)||_core2.default.redraw(o)},!0)}}},CustomPlotlyChart=function CustomPlotlyChart(clientConfig){var customChart={restrict:"E",template:"<div></div>",scope:{series:"=",options:"=",height:"="},link:function link(scope,element){if(clientConfig.allowCustomJSVisualizations){var refresh=function refresh(){_core2.default.newPlot(element[0].children[0]);var codeCall=eval("codeCall = function(x, ys, element, Plotly){ "+scope.options.customCode+" }");codeCall(scope.x,scope.ys,element[0].children[0],_core2.default)},timeSeriesToPlotlySeries=function(){scope.x=[],scope.ys={},(0,_underscore.each)(scope.series,function(e){scope.ys[e.name]=[],(0,_underscore.each)(e.data,function(t){scope.x.push(normalizeValue(t.x)),scope.ys[e.name].push(normalizeValue(t.y))})})};scope.$watch("[options.customCode, options.autoRedraw]",function(){try{scope.options.autoRedraw&&refresh()}catch(e){scope.options.enableConsoleLogs&&console.log("Error while executing custom graph: "+e)}},!0),scope.$watch("series",function(){timeSeriesToPlotlySeries(),refresh()},!0)}}};return customChart};CustomPlotlyChart.$inject=["clientConfig"]},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t){},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n=u.default.sortBy(e,function(e){return e.date+parseInt(e.day_number,10)}),a=u.default.groupBy(n,"date"),r=(0,d.default)(n[0].date).toDate(),i=(0,d.default)(n[n.length-1].date),s=0===u.default.min(u.default.pluck(e,"day_number")),o=null,l=[];return u.default.each(a,function(e){if(null!==o)for(var n=Math.abs(o.diff(e[0].date,h[t]));n>1;)l.push([0]),n-=1;o=(0,d.default)(e[0].date);var a=[parseInt(e[0].total,10)],r=i.diff((0,d.default)(e[0].date),h[t]);s&&(r+=1),u.default.each(e,function(e){var t=s?e.day_number+1:e.day_number;a[t]=parseInt(e.value,10)});for(var c=0;c<=r;c+=1)void 0===a[c]&&(a[c]=0);l.push(a)}),{data:l,initialDate:r}}function i(){return{restrict:"E",scope:{queryResult:"=",options:"="},template:"",replace:!1,link:function(e,t){function n(){if(null!==e.queryResult.getData()){var n=r(e.queryResult.getData(),e.options.timeInterval),a=n.data,i=n.initialDate,s=f.default.element(t)[0];Cornelius.draw({initialDate:i,container:s,cohort:a,title:null,timeInterval:e.options.timeInterval,labels:{time:"Time",people:"Users",weekOf:"Week of"}})}}e.options.timeInterval=e.options.timeInterval||"daily",e.$watch("queryResult && queryResult.getData()",n),e.$watch("options.timeInterval",n)}}}function s(){return{restrict:"E",template:g.default}}function o(e){e.directive("cohortRenderer",i),e.directive("cohortEditor",s),e.config(["VisualizationProvider",function(e){var t={timeInterval:"daily"};e.registerVisualization({type:"COHORT",name:"Cohort",renderTemplate:'<cohort-renderer options="visualization.options" query-result="queryResult"></cohort-renderer>',editorTemplate:"<cohort-editor></cohort-editor>",defaultOptions:t})}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var l=n(5),u=a(l),c=n(0),d=a(c),p=n(19),f=a(p);n(633),n(634);var m=n(635),g=a(m),h={weekly:"weeks",daily:"days",monthly:"months"}},,function(e,t){},function(e,t){e.exports='<div class="form-group">\n    <label class="control-label">Time Interval</label>\n    <select class="form-control" ng-model="visualization.options.timeInterval">\n      <option value="daily">Daily</option>\n      <option value="weekly">Weekly</option>\n      <option value="monthly">Monthly</option>\n    </select>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){return e>=0?e-1:(Math.abs(e)>t&&(e%=t),t+e)}function i(){return{restrict:"E",template:p.default,link:function(e){var t=function(){var t=e.queryResult.getData();if(t){var n=r(e.visualization.options.rowNumber,t.length),a=r(e.visualization.options.targetRowNumber,t.length),i=e.visualization.options.counterColName,s=e.visualization.options.targetColName,o=e.visualization.options.targetSetValue;if(e.visualization.options.countRow?e.counterValue=t.length:i&&(e.counterValue=t[n][i]),s?(e.targetValue=t[a][s],e.targetValue&&(e.delta=e.counterValue-e.targetValue,e.trendPositive=e.delta>=0)):o?(e.targetValue=o,e.targetValue&&(e.delta=e.counterValue-e.targetValue,e.trendPositive=e.delta>=0)):e.targetValue=null,e.isNumber=(0,c.isNumber)(e.counterValue),e.isNumber){e.stringPrefix=e.visualization.options.stringPrefix,e.stringSuffix=e.visualization.options.stringSuffix;var l=e.visualization.options.stringDecimal,d=e.visualization.options.stringDecChar,p=e.visualization.options.stringThouSep;(l||d||p)&&(e.counterValue=(0,u.default)(e.counterValue,l,d,p),e.isNumber=!1)}else e.stringPrefix=null,e.stringSuffix=null}};e.$watch("visualization.options",t,!0),e.$watch("queryResult && queryResult.getData()",t)}}}function s(){return{restrict:"E",template:m.default,link:function(e){e.currentTab="general",e.changeTab=function(t){e.currentTab=t},e.isValueNumber=function(){var t=e.queryResult.getData();if(t){var n=r(e.visualization.options.rowNumber,t.length),a=e.visualization.options.counterColName;e.visualization.options.countRow?e.counterValue=t.length:a&&(e.counterValue=t[n][a])}return(0,c.isNumber)(e.counterValue)}}}}function o(e){e.directive("counterEditor",s),e.directive("counterRenderer",i),e.config(["VisualizationProvider",function(e){var t={counterColName:"counter",rowNumber:1,targetRowNumber:1,stringDecimal:0,stringDecChar:".",stringThouSep:","};e.registerVisualization({type:"COUNTER",name:"Counter",renderTemplate:'<counter-renderer options="visualization.options" query-result="queryResult"></counter-renderer>',editorTemplate:"<counter-editor></counter-editor>",defaultOptions:t})}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var l=n(637),u=a(l),c=n(5),d=n(638),p=a(d),f=n(639),m=a(f)},,function(e,t){e.exports='<counter ng-class="{\'positive\': targetValue && trendPositive, \'negative\': targetValue && !trendPositive}">\n  <value ng-if="isNumber">{{stringPrefix}}{{counterValue|number}}{{stringSuffix}}</value>\n  <value ng-if="!isNumber">{{stringPrefix}}{{counterValue}}{{stringSuffix}}</value>\n  <counter-target ng-if="targetValue">({{targetValue|number}})</counter-target>\n  <counter-name>{{visualization.name}}</counter-name>\n</counter>\n'},function(e,t){e.exports='<div class="form-horizontal">\n  <ul class="tab-nav">\n    <li ng-class="{active: currentTab == \'general\'}">\n      <a ng-click="changeTab(\'general\')">General</a>\n    </li>\n    <li ng-class="{active: currentTab == \'format\'}">\n      <a ng-click="changeTab(\'format\')">Format</a>\n    </li>\n  </ul>\n  <div ng-show="currentTab == \'general\'">\n    <div class="form-group">\n      <label class="col-lg-6">Counter Value Column Name</label>\n      <div class="col-lg-6">\n        <select ng-options="name for name in queryResult.getColumnNames()" ng-model="visualization.options.counterColName" class="form-control" ng-disabled="visualization.options.countRow"></select>\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-lg-6">Counter Value Row Number</label>\n      <div class="col-lg-6">\n        <input type="number" ng-model="visualization.options.rowNumber" class="form-control" ng-disabled="visualization.options.countRow">\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-lg-6">Target Value Column Name</label>\n      <div class="col-lg-6">\n        <select ng-options="name for name in queryResult.getColumnNames()" ng-model="visualization.options.targetColName" class="form-control">\n          <option value="">No target value</option>\n        </select>\n      </div>\n    </div>\n    <div class="form-group" ng-if="visualization.options.targetColName">\n      <label class="col-lg-6">Target Value Row Number</label>\n      <div class="col-lg-6">\n        <input type="number" ng-model="visualization.options.targetRowNumber" class="form-control">\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-lg-6">Target Set Value</label>\n      <div class="col-lg-6">\n        <input type="number" ng-model="visualization.options.targetSetValue" class="form-control">\n      </div>\n    </div>\n    <div class="form-group">\n      <div class="col-lg-6">\n        <input type="checkbox" ng-model="visualization.options.countRow">\n        <i class="input-helper"></i> Count Rows\n      </div>\n    </div>\n  </div>\n\n  <div ng-show="currentTab == \'format\'">\n    <div class="form-group">\n      <label class="col-lg-6">Formatting Decimal Place</label>\n      <div class="col-lg-6">\n        <input type="number" ng-model="visualization.options.stringDecimal" class="form-control" ng-disabled="!isValueNumber()">\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-lg-6">Formatting Decimal Character</label>\n      <div class="col-lg-6">\n        <input type="text" ng-model="visualization.options.stringDecChar" class="form-control" ng-disabled="!isValueNumber()">\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-lg-6">Formatting Thousands Separator</label>\n      <div class="col-lg-6">\n        <input type="text" ng-model="visualization.options.stringThouSep" class="form-control" ng-disabled="!isValueNumber()" ng-trim="false">\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-lg-6">Formatting String Prefix</label>\n      <div class="col-lg-6">\n        <input type="text" ng-model="visualization.options.stringPrefix" class="form-control" ng-disabled="!isValueNumber()" ng-trim="false">\n      </div>\n    </div>\n    <div class="form-group">\n      <label class="col-lg-6">Formatting String Suffix</label>\n      <div class="col-lg-6">\n        <input type="text" ng-model="visualization.options.stringSuffix" class="form-control" ng-disabled="!isValueNumber()" ng-trim="false">\n      </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){e.component("editVisualizationDialog",l)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=n(5),i=n(19),s=n(641),o=function(e){return e&&e.__esModule?e:{default:e}}(s),l={template:o.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$window","currentUser","Events","Visualization","toastr",function(e,t,n,a,s){"ngInject";var o=this;this.query=this.resolve.query,this.queryResult=this.resolve.queryResult,this.originalVisualization=this.resolve.visualization,this.onNewSuccess=this.resolve.onNewSuccess,this.visualization=(0,i.copy)(this.originalVisualization),this.visTypes=a.visualizationTypes,this.newVisualization=function(){return{type:a.defaultVisualization.type,name:a.defaultVisualization.name,description:"",options:a.defaultVisualization.defaultOptions}},this.visualization||(this.visualization=this.newVisualization()),this.typeChanged=function(e){var t=o.visualization.type;t&&e!==t&&o.visualization&&!o.visForm.name.$dirty&&(o.visualization.name=a.visualizations[o.visualization.type].name),t&&e!==t&&o.visualization&&(o.visualization.options=a.visualizations[o.visualization.type].defaultOptions)},this.submit=function(){o.visualization.id?n.record("update","visualization",o.visualization.id,{type:o.visualization.type}):n.record("create","visualization",null,{type:o.visualization.type}),o.visualization.query_id=o.query.id,a.save(o.visualization,function(e){s.success("Visualization saved");var t=(0,r.pluck)(o.query.visualizations,"id"),n=t.indexOf(e.id);n>-1?o.query.visualizations[n]=e:(o.query.visualizations.push(e),o.onNewSuccess&&o.onNewSuccess(e)),o.close()},function(){s.error("Visualization could not be saved")})},this.closeDialog=function(){o.visForm.$dirty?e.confirm("Are you sure you want to close the editor without saving?")&&o.close():o.close()}}]}},function(e,t){e.exports='<div>\n  <div class="modal-header">\n    <button type="button" class="close" aria-label="Close" ng-click="$ctrl.closeDialog()"><span aria-hidden="true">&times;</span>\n    </button>\n    <h4 class="modal-title">Visualization Editor</h4>\n  </div>\n  <div class="modal-body">\n    <div class="row">\n      <div class="col-md-5 p-r-5">\n        <div>\n          <form name="$ctrl.visForm">\n            <div class="form-group">\n              <label class="control-label">Visualization Type</label>\n\n              <select required ng-model="$ctrl.visualization.type"\n                      ng-options="type.type as type.name for type in $ctrl.visTypes" class="form-control"\n                      ng-change="$ctrl.typeChanged(\'{{$ctrl.visualization.type}}\')"></select>\n            </div>\n\n            <div class="form-group">\n              <label class="control-label">Visualization Name</label>\n              <input name="name" type="text" class="form-control" ng-model="$ctrl.visualization.name"\n                     placeholder="{{$ctrl.visualization.type | capitalize}}">\n            </div>\n\n            <visualization-options-editor visualization="$ctrl.visualization"\n                                          query-result="$ctrl.queryResult"\n                                          query="$ctrl.query">\n            </visualization-options-editor>\n          </form>\n        </div>\n      </div>\n      <div class="col-md-7" style="border: 1px solid #eee">\n        <visualization-renderer visualization="$ctrl.visualization" query-result="$ctrl.queryResult"></visualization-renderer>\n      </div>\n    </div>\n  </div>\n  <div class="modal-footer">\n    <button type="button" class="btn btn-default" ng-click="$ctrl.closeDialog()">Close</button>\n    <button type="button" class="btn btn-primary" ng-click="$ctrl.submit()">Save</button>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(){var e=this;this.visualizations={},this.visualizationTypes=[];var t={defaultOptions:{},skipTypes:!1,editorTemplate:null};this.registerVisualization=function(n){var a=u({},t,n);void 0!==e.defaultVisualization||a.name.match(/Deprecated/)||(e.defaultVisualization=a),e.visualizations[n.type]=a,n.skipTypes||e.visualizationTypes.push({name:n.name,type:n.type})},this.getSwitchTemplate=function(t){var n=/(<[a-zA-Z0-9-]*?)( |>)/,a=(0,p.reduce)(e.visualizations,function(e,a){if(a[t]){var r='$1 ng-switch-when="'+a.type+'" $2';return e+"\n"+a[t].replace(n,r)}return e},"");return a='<div ng-switch on="visualization.type">'+a+"</div>"},this.$get=["$resource",function(t){var n=t("api/visualizations/:id",{id:"@id"});return n.visualizations=e.visualizations,n.visualizationTypes=e.visualizationTypes,n.renderVisualizationsTemplate=e.getSwitchTemplate("renderTemplate"),n.editorTemplate=e.getSwitchTemplate("editorTemplate"),n.defaultVisualization=e.defaultVisualization,n}]}function r(e){return{restrict:"E",scope:{visualization:"="},template:"{{name}}",replace:!1,link:function(t){if(e.visualizations[t.visualization.type]){e.visualizations[t.visualization.type].name!==t.visualization.name&&(t.name=t.visualization.name)}}}}function i(e){return{restrict:"E",scope:{visualization:"=",queryResult:"="},template:'<filters filters="filters"></filters>\n'+e.renderVisualizationsTemplate,replace:!1,link:function(e){e.$watch("queryResult && queryResult.getFilters()",function(t){t&&(e.filters=t)})}}}function s(e){return{restrict:"E",template:e.editorTemplate,replace:!1,scope:{visualization:"=",query:"=",queryResult:"="}}}function o(e){return function(t,n){var a=t;if((0,p.isArray)(t)&&(a=t[0]),"date"===n.column.type){if(a&&d.default.isMoment(a))return a.format(e.dateFormat)}else if("datetime"===n.column.type&&a&&d.default.isMoment(a))return a.format(e.dateTimeFormat);return a}}function l(e){e.provider("Visualization",a),e.directive("visualizationRenderer",i),e.directive("visualizationOptionsEditor",s),e.directive("visualizationName",r),e.filter("filterValue",o)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.default=l;var c=n(0),d=function(e){return e&&e.__esModule?e:{default:e}}(c),p=n(5);o.$inject=["clientConfig"],r.$inject=["Visualization"],s.$inject=["Visualization"],i.$inject=["Visualization"]},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){return{restrict:"E",template:q.default,link:function(e,t){function n(){e.visualization.options.bounds=f.getBounds()}function a(){var t=e.visualization.options.bounds;if(t)f.fitBounds([[t._southWest.lat,t._southWest.lng],[t._northEast.lat,t._northEast.lng]]);else if(h){var n=l.default.flatten(l.default.map(l.default.values(h),function(e){return e.getLayers()})),a=new m.default.featureGroup(n);f.fitBounds(a.getBounds())}}function r(){f&&(f.invalidateSize(!1),a())}function i(e,t,n){var a=n[e],r=n[t],i='<ul style="list-style-type: none;padding-left: 0">';return i+="<li><strong>"+a+", "+r+"</strong>",l.default.each(n,function(n,a){a!==e&&a!==t&&(i+="<li>"+a+": "+n+"</li>")}),i}function s(e){e&&(g.removeLayer(e),f.removeLayer(e))}function o(t,n){var a=e.visualization.options.latColName||"lat",r=e.visualization.options.lonColName||"lon",s=e.visualization.options.classify,o=void 0;if(e.visualization.options.clusterMarkers){var u=e.visualization.options.groups[t].color,c={};s&&(c.iconCreateFunction=function(e){var t=e.getChildCount(),n=" marker-cluster-";n+=t<10?"small":t<100?"medium":"large",n="";var a="color: white; background-color: "+u+";";return m.default.divIcon({html:'<div style="'+a+'"><span>'+t+"</span></div>",className:"marker-cluster"+n,iconSize:new m.default.Point(40,40)})}),o=m.default.markerClusterGroup(c)}else o=m.default.layerGroup();l.default.each(n,function(n){var l=void 0,u=n[a],c=n[r];if(null!==u&&null!==c){if(s&&"none"!==s){var d=e.visualization.options.groups[t].color;l=y(u,c,d)}else l=b(u,c);l.bindPopup(i(a,r,n)),o.addLayer(l)}}),o.addTo(f),h[t]=o,g.addOverlay(o,t)}function u(){var t=e.queryResult.getData(),n=e.visualization.options.classify;if(e.visualization.options.mapTileUrl=e.visualization.options.mapTileUrl||"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",v.setUrl(e.visualization.options.mapTileUrl),void 0===e.visualization.options.clusterMarkers&&(e.visualization.options.clusterMarkers=!0),t){var r=void 0;r=n&&"none"!==n?l.default.groupBy(t,n):{All:t};var i=l.default.keys(r),u=l.default.map(i,function(t){return e.visualization.options.groups&&e.visualization.options.groups[t]?e.visualization.options.groups[t]:{color:d(t)}});e.visualization.options.groups=l.default.object(i,u),l.default.each(h,function(e){s(e)}),l.default.each(r,function(e,t){o(t,e)}),a()}}var d=c.default.scale.category10(),f=m.default.map(t[0].children[0].children[0],{scrollWheelZoom:!1}),g=m.default.control.layers().addTo(f),h={},v=m.default.tileLayer("//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(f);f.on("focus",function(){f.on("moveend",n)}),f.on("blur",function(){f.off("moveend",n)});var b=function(e,t){return m.default.marker([e,t])},y=function(e,t,n){var a={fillColor:n,fillOpacity:.9,stroke:!1};return m.default.circleMarker([e,t],a)};e.$watch("queryResult && queryResult.getData()",u),e.$watch("visualization.options",u,!0),p.default.element(window).on("resize",r),e.$watch("visualization.options.height",r)}}}function i(){return{restrict:"E",template:$.default,link:function(e){e.currentTab="general",e.columns=e.queryResult.getColumns(),e.columnNames=l.default.pluck(e.columns,"name"),e.classify_columns=e.columnNames.concat("none"),e.mapTiles=[{name:"OpenStreetMap",url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"},{name:"OpenStreetMap BW",url:"//{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png"},{name:"OpenStreetMap DE",url:"//{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png"},{name:"OpenStreetMap FR",url:"//{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png"},{name:"OpenStreetMap Hot",url:"//{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"},{name:"Thunderforest",url:"//{s}.tile.thunderforest.com/cycle/{z}/{x}/{y}.png"},{name:"Thunderforest Spinal",url:"//{s}.tile.thunderforest.com/spinal-map/{z}/{x}/{y}.png"},{name:"OpenMapSurfer",url:"//korona.geog.uni-heidelberg.de/tiles/roads/x={x}&y={y}&z={z}"},{name:"Stamen Toner",url:"//stamen-tiles-{s}.a.ssl.fastly.net/toner/{z}/{x}/{y}.png"},{name:"Stamen Toner Background",url:"//stamen-tiles-{s}.a.ssl.fastly.net/toner-background/{z}/{x}/{y}.png"},{name:"Stamen Toner Lite",url:"//stamen-tiles-{s}.a.ssl.fastly.net/toner-lite/{z}/{x}/{y}.png"},{name:"OpenTopoMap",url:"//{s}.tile.opentopomap.org/{z}/{x}/{y}.png"}]}}}function s(e){e.directive("mapRenderer",r),e.directive("mapEditor",i),e.config(["VisualizationProvider",function(e){var t={height:500,classify:"none",clusterMarkers:!0};e.registerVisualization({type:"MAP",name:"Map",renderTemplate:'<map-renderer options="visualization.options" query-result="queryResult"></map-renderer>',editorTemplate:"<map-editor></map-editor>",defaultOptions:t})}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var o=n(5),l=a(o),u=n(2),c=a(u),d=n(19),p=a(d),f=n(644),m=a(f);n(645),n(646),n(648),n(649);var g=n(647),h=a(g),v=n(650),b=a(v),y=n(651),w=a(y),x=n(652),q=a(x),_=n(653),$=a(_);m.default.Icon.Default.mergeOptions({iconUrl:h.default,iconRetinaUrl:b.default,shadowUrl:w.default}),delete m.default.Icon.Default.prototype._getIconUrl},,,function(e,t){},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAApCAYAAADAk4LOAAAFgUlEQVR4Aa1XA5BjWRTN2oW17d3YaZtr2962HUzbDNpjszW24mRt28p47v7zq/bXZtrp/lWnXr337j3nPCe85NcypgSFdugCpW5YoDAMRaIMqRi6aKq5E3YqDQO3qAwjVWrD8Ncq/RBpykd8oZUb/kaJutow8r1aP9II0WmLKLIsJyv1w/kqw9Ch2MYdB++12Onxee/QMwvf4/Dk/Lfp/i4nxTXtOoQ4pW5Aj7wpici1A9erdAN2OH64x8OSP9j3Ft3b7aWkTg/Fm91siTra0f9on5sQr9INejH6CUUUpavjFNq1B+Oadhxmnfa8RfEmN8VNAsQhPqF55xHkMzz3jSmChWU6f7/XZKNH+9+hBLOHYozuKQPxyMPUKkrX/K0uWnfFaJGS1QPRtZsOPtr3NsW0uyh6NNCOkU3Yz+bXbT3I8G3xE5EXLXtCXbbqwCO9zPQYPRTZ5vIDXD7U+w7rFDEoUUf7ibHIR4y6bLVPXrz8JVZEql13trxwue/uDivd3fkWRbS6/IA2bID4uk0UpF1N8qLlbBlXs4Ee7HLTfV1j54APvODnSfOWBqtKVvjgLKzF5YdEk5ewRkGlK0i33Eofffc7HT56jD7/6U+qH3Cx7SBLNntH5YIPvODnyfIXZYRVDPqgHtLs5ABHD3YzLuespb7t79FY34DjMwrVrcTuwlT55YMPvOBnRrJ4VXTdNnYug5ucHLBjEpt30701A3Ts+HEa73u6dT3FNWwflY86eMHPk+Yu+i6pzUpRrW7SNDg5JHR4KapmM5Wv2E8Tfcb1HoqqHMHU+uWDD7zg54mz5/2BSnizi9T1Dg4QQXLToGNCkb6tb1NU+QAlGr1++eADrzhn/u8Q2YZhQVlZ5+CAOtqfbhmaUCS1ezNFVm2imDbPmPng5wmz+gwh+oHDce0eUtQ6OGDIyR0uUhUsoO3vfDmmgOezH0mZN59x7MBi++WDL1g/eEiU3avlidO671bkLfwbw5XV2P8Pzo0ydy4t2/0eu33xYSOMOD8hTf4CrBtGMSoXfPLchX+J0ruSePw3LZeK0juPJbYzrhkH0io7B3k164hiGvawhOKMLkrQLyVpZg8rHFW7E2uHOL888IBPlNZ1FPzstSJM694fWr6RwpvcJK60+0HCILTBzZLFNdtAzJaohze60T8qBzyh5ZuOg5e7uwQppofEmf2++DYvmySqGBuKaicF1blQjhuHdvCIMvp8whTTfZzI7RldpwtSzL+F1+wkdZ2TBOW2gIF88PBTzD/gpeREAMEbxnJcaJHNHrpzji0gQCS6hdkEeYt9DF/2qPcEC8RM28Hwmr3sdNyht00byAut2k3gufWNtgtOEOFGUwcXWNDbdNbpgBGxEvKkOQsxivJx33iow0Vw5S6SVTrpVq11ysA2Rp7gTfPfktc6zhtXBBC+adRLshf6sG2RfHPZ5EAc4sVZ83yCN00Fk/4kggu40ZTvIEm5g24qtU4KjBrx/BTTH8ifVASAG7gKrnWxJDcU7x8X6Ecczhm3o6YicvsLXWfh3Ch1W0k8x0nXF+0fFxgt4phz8QvypiwCCFKMqXCnqXExjq10beH+UUA7+nG6mdG/Pu0f3LgFcGrl2s0kNNjpmoJ9o4B29CMO8dMT4Q5ox8uitF6fqsrJOr8qnwNbRzv6hSnG5wP+64C7h9lp30hKNtKdWjtdkbuPA19nJ7Tz3zR/ibgARbhb4AlhavcBebmTHcFl2fvYEnW0ox9xMxKBS8btJ+KiEbq9zA4RthQXDhPa0T9TEe69gWupwc6uBUphquXgf+/FrIjweHQS4/pduMe5ERUMHUd9xv8ZR98CxkS4F2n3EUrUZ10EYNw7BWm9x1GiPssi3GgiGRDKWRYZfXlON+dfNbM+GgIwYdwAAAAASUVORK5CYII="},function(e,t){},function(e,t){},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAABSCAMAAAAhFXfZAAAC91BMVEVMaXEzeak2f7I4g7g3g7c3grY3grg8hJo3grY4g7c4g7c3grU0gLI4grY9hrpBi79HkMM2frE0daA0fq82gbROlslbo9Vgp9dcpNZQmcxFjsIwd6QzeKk3gbRfptdepdZcpdY2gLMtd5s3gLNZotVSntNPnNJLmtFImdBZodU1f7A2f7A1frA2f7I2f7FHmNBUnM9Wn9VGmNAydaNYoNJOm9M9hLc0e6w3fa46f7BKmdFFltBVndE1fK1Els82fq41fK1Dlc89g7RClc9XoNVUndQ0eqxClM9Jl9FRms81eqo0eqpHltFBk89Fi75Qm9M/k89KkcYzealSjbadvdPH2ufz9/r4+vzP3+qlxNljmL08gLNSnNQzeKgydqUzeKg/ks6NtM/////+/v8+kc/f6fFAgK1CiLwydKIzd6c8kM6Tt9C1zd5OmdNBh7pTjLRzn78xdKIydqU7j86jwdbM3egxdKIydaQydaMydKNGlNE6js5OiLAxc6FKkshDk9E5jc09e6Zekrcxc6I4jc03eagyc6FIldI3jM0wcaBMl9J+psNKltIwcZ82i83k7fMubJhLlc81is1Lg6pklbZNl9I/j9AvbJlEjcVdkLPt8/cwcZ4ubZkwcJ00icy0y9swcJwvb5wzicxHkcpTh60ubZhCkNAyiMwvbpoxh8xAicBHj8hGk9FHks0+jdAubJcubJdEkdEwhsw6i88ubJgta5cvhswxapgubJcuhcstbJcubZcuhMsubJcvbJZBjMgthMsubJcvbZkubJcrg8stbJctbZcubJgrgssua5gubJc6is8qgcs8i9A9iMYtg8spgcoogMo7hcMrbZcubJcngMonf8olfsoubJc4gr8kfckua5g5iM8jfMk4iM8he8k1froua5g7itAgeskubJc2hs8eecgzfLcofssdeMg0hc4ubJccd8g2hcsxeLQbdsgZdcgxeLImfcszhM0vda4xgckzhM4xg84wf8Yxgs4udKsvfcQucqjbZ8obAAAA7HRSTlMAHDdTb4yPA+L/7ZxE/////yYLgvb///////8SYf/////qB/////////+1wNHd//////8s////r/////////+O/P///////////8f///////////////////////+P2P///////////3f//////////5j/////tczn//////L///////////////////////8+////////R/////Ww////tf////9q////////////4P/////Yd/8W+P/xov+UNv///STN/7hc1P/AUv//////////MMT///+m//+e//////+M//+C////////6cqo94AAAAXmSURBVHgBrNKDoipBGADgbHMRpjuKi2xOdu//MHe2Y6tvOdZvuhGzxWqzO2xWi9lp+g6L3eV+5PH6vmpltrv8nDsQDIWCAbef83jDpo9FojFeJxhPJO8JosQzYnb5oxYpVzodiCcyhiwA2esPEAPpdM727vT+eSH0x7McwoTmOUpxIcvF/RAWI29byCUIpUQ2m8A0/xwx8kIQls2vW4QrihIHQMDqGyQBgAiVnOXVTuWUtAaAnq++I48B0PxKrPZiq8qKvy4IpPqBhiDUm0rl+ca12h1NQN3eh7pI6MN26WnfooNBPIHU4SdUlBAHg9Hj0seDEEJ08pxKqfoio4tQaDAOP0xrMEWIzB4NCWaIK8xJ7ymXItQcFO/jcLGIF+bLRytW4LS18Wbd5SNcEBcLn8mw2TYZ2+3vLRuMaYdme7sdTA8iY8flQ0mPscC2fB1ku12z4+necs7YebDlri9JZ3rvoazB1tutxdiuy1TXl4/Zer95ufzneq7524qBAIBr61TmtxXX/MK4FC6cKIwvViozXMDMzLbCTF+1JBn/4/EtLi2vrK6tbywsbE506vVxnZ3fF7YIIQamdX7dVqb/RtnCr1X+n3F9gA2MdA7Vsl87nzEDId2MTUCHSdr+As/Y1DKvM1uYFWBGpTtggrFuYrMPApgc0jhMTNmdvInLbn8NqNImgEG7jWzZnwB1KAg79t1V3mzPvgm6Q+n9m98n/e5ZQI+iw6Dby1v43AzApPIIs24/Cbg1GFcRE+h29xpvseJ2v4cxjzQOmjtAgqF5PRyRZvTXIfcqbxUNPdOnI1JYnw8FSSwUp4mklKDzoRRvkw7N0vF6QTwUI4aMRsNZyUQnMhkzb2HMZeJ0RhUMUy1jIP68lRaKUpLSXN7FW5jz+QnqKEoFas37yX6pD8tFpYybpQpv4S3lEGv5KvaV9olNDPwNHUhh1ETex5scpsQOVg8UxAFhI0dCHKPjRIogDorT1aZPzkTuHC9U2oPnQlySRzFxhYkTJYHHIXFt5srNnhBxLDSyV+L2IyF395vnhQflpHCuifv80g3/a+UPIXWNEDEAQEE0HR23weEk6XGnwR1iH3eJu7udbt26fe30I17x/PYH+9iv+CB5qT1v+YhlL5WeS5ZV72RZftvlNF6Wj75Zdn2kHcl6e5Sy/A3D7DsBMP0gd/DkC/Bp9l3gW5Y7a5asWVCm3WcaAFSHnFtxAXivwwAsWf9E25dl+TiwhwIKPVRgD33Ct6wvom0ijKapOBllpkEcf6ZCMsqjyCgjuvKIoajXYgya8vhIJ7rKKnKOP+sxjOPJZmV0DRRHGIZx/KW6npaOvor3M/G+pqalS00TT5q4G7qzPGe4O+wu7mxw59wt8p3LCre//pn/J+iupIwe1HKcpVdXI8c9QB9l9QMDnHVQF8+9xdAw5YzgBmfuHdVh4bj7GKO8cZYxW/UmvHkAeEl5pgncMJt7JzVZzOYaTFGh6WRGEDVJ5pniCDOCWw0Ns3MaLA0NdRijYm+AmQZhXoO1YQFYpBJLqGloGF1W1ZuMfKRSL1OZFVXJyNBlUhhD7evXk6sqZl+/rscaKfUDC68FtYn19Xr64xU+oo7nxQ2FWZ6vxyapuTyEdV5WTgR+HZ3DpGoN9Szzu8Qkzz9CH6kbZhlpa7uELO2gs4I0bOKRJInFC1GyPsMuaanoxPre1n6hbXlvB90dpKkPj4Q9sXAi7gnfcEDaOjqxIxwe5e1vCcforiIdu/gkyyenOSeyrBthqrpxvHV2lF0cHW4d47ySdB3g29bWiSPjZMvZBDvpqzxPZk7Ti9PDLZcyomBHk/PwxJ1ycsgiv4guzrgOz9wexn126EVbNV3oVzLj8zBaEYXqNnjP/G4W8Z8F0GYiKisTPGMZ31kQGKdymGwIhMIeTzgUgM1EZRkHgmGfL8wi01Qe0wQCYSaAESrXNBCJRiN6EYURxKLRmF5E4Q0QjwNvyIAlJBKYIiNegnlJhowBY2RMP9BPBn38SEYtLpKG/+tgQe8M5cY7AAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACkAAAApCAQAAAACach9AAACMUlEQVR4Ae3ShY7jQBAE0Aoz/f9/HTMzhg1zrdKUrJbdx+Kd2nD8VNudfsL/Th///dyQN2TH6f3y/BGpC379rV+S+qqetBOxImNQXL8JCAr2V4iMQXHGNJxeCfZXhSRBcQMfvkOWUdtfzlLgAENmZDcmo2TVmt8OSM2eXxBp3DjHSMFutqS7SbmemzBiR+xpKCNUIRkdkkYxhAkyGoBvyQFEJEefwSmmvBfJuJ6aKqKWnAkvGZOaZXTUgFqYULWNSHUckZuR1HIIimUExutRxwzOLROIG4vKmCKQt364mIlhSyzAf1m9lHZHJZrlAOMMztRRiKimp/rpdJDc9Awry5xTZCte7FHtuS8wJgeYGrex28xNTd086Dik7vUMscQOa8y4DoGtCCSkAKlNwpgNtphjrC6MIHUkR6YWxxs6Sc5xqn222mmCRFzIt8lEdKx+ikCtg91qS2WpwVfBelJCiQJwvzixfI9cxZQWgiSJelKnwBElKYtDOb2MFbhmUigbReQBV0Cg4+qMXSxXSyGUn4UbF8l+7qdSGnTC0XLCmahIgUHLhLOhpVCtw4CzYXvLQWQbJNmxoCsOKAxSgBJno75avolkRw8iIAFcsdc02e9iyCd8tHwmeSSoKTowIgvscSGZUOA7PuCN5b2BX9mQM7S0wYhMNU74zgsPBj3HU7wguAfnxxjFQGBE6pwN+GjME9zHY7zGp8wVxMShYX9NXvEWD3HbwJf4giO4CFIQxXScH1/TM+04kkBiAAAAAElFTkSuQmCC"},function(e,t){e.exports="<div style='margin:1%;width:98%;height:{{visualization.options.height}}px'>\n    <div style=\"width:100%; height:100%;\"></div>\n</div>\n"},function(e,t){e.exports='<div>\n  <ul class="tab-nav">\n    <li ng-class="{active: currentTab == \'general\'}"><a ng-click="currentTab=\'general\'">General</a></li>\n    <li ng-class="{active: currentTab == \'groups\'}"><a ng-click="currentTab=\'groups\'">Groups</a></li>\n    <li ng-class="{active: currentTab == \'map\'}"><a ng-click="currentTab=\'map\'">Map Settings</a></li>\n  </ul>\n\n  <div ng-show="currentTab == \'general\'">\n    <div class="form-group">\n      <label class="control-label">Latitude Column Name</label>\n      <ui-select name="form-control" required ng-model="visualization.options.latColName">\n        <ui-select-match placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:visualization.options.classify | remove:visualization.options.lonColName">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="form-group">\n      <label class="control-label">Longitude Column Name</label>\n      <ui-select name="form-control" required ng-model="visualization.options.lonColName">\n        <ui-select-match placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in columnNames | remove:visualization.options.classify | remove:visualization.options.latColName">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n\n    <div class="form-group">\n      <label class="control-label">Group By</label>\n      <ui-select name="form-control" required ng-model="visualization.options.classify">\n        <ui-select-match placeholder="Choose column...">{{$select.selected}}</ui-select-match>\n        <ui-select-choices repeat="column in classify_columns | remove:visualization.options.lonColName | remove:visualization.options.latColName">\n          <span ng-bind-html="column | highlight: $select.search"></span><span> </span>\n          <small class="text-muted" ng-bind="columns[column].type"></small>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n  </div>\n\n  <div ng-show="currentTab == \'groups\'">\n    <table class="table table-condensed col-table">\n      <thead>\n      <th>Name</th>\n      <th>Color</th>\n      </thead>\n      <tbody>\n      <tr ng-repeat="(name, options) in visualization.options.groups">\n        <td>{{name}}</td>\n        <td>\n            <input class="form-control" type="color" ng-model="options.color"/>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n  </div>\n\n  <div ng-show="currentTab == \'map\'">\n    <div class="checkbox">\n      <label>\n        <input type="checkbox" ng-model="visualization.options.clusterMarkers">\n        <i class="input-helper"></i> Cluster Markers\n      </label>\n    </div>\n\n    <div class="form-group">\n      <label class="control-label">Map Height (px)</label>\n      <input class="form-control" type="number" ng-model="visualization.options.height"/>\n    </div>\n    <div class="form-group">\n      <label class="control-label">Map Tiles</label>\n      <select ng-options="tile.url as tile.name for tile in mapTiles" ng-model="visualization.options.mapTileUrl"\n              class="form-control"></select>\n    </div>\n  </div>\n\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){return{restrict:"E",scope:{queryResult:"=",visualization:"="},template:"",replace:!1,link:function(e,t){function n(){var t=e.visualization.options.controls&&e.visualization.options.controls.enabled;document.querySelectorAll(".pvtAxisContainer, .pvtRenderer, .pvtVals").forEach(function(e){e.style.display=t?"none":""})}function a(){e.$watch("queryResult && queryResult.getData()",function(a){if(a&&null!==e.queryResult.getData()){a=u.default.copy(e.queryResult.getData());var r={renderers:d.default.pivotUtilities.renderers,onRefresh:function(t){var n=o({},t);delete n.aggregators,delete n.renderers,delete n.onRefresh,delete n.rendererOptions,delete n.localeStrings,e.visualization&&(e.visualization.options=n)}};e.visualization&&o(r,e.visualization.options),(0,d.default)(t).pivotUI(a,r,!0),n()}})}e.$watch("queryResult && queryResult.getData()",a),e.$watch("visualization.options.controls.enabled",n)}}}function i(){return{restrict:"E",template:f.default}}function s(e){e.directive("pivotTableRenderer",r),e.directive("pivotTableEditor",i),e.config(["VisualizationProvider",function(e){var t={};e.registerVisualization({type:"PIVOT",name:"Pivot Table",renderTemplate:'<pivot-table-renderer visualization="visualization" query-result="queryResult"></pivot-table-renderer>',editorTemplate:"<pivot-table-editor></pivot-table-editor>",defaultOptions:t})}])}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.default=s;var l=n(19),u=a(l),c=n(14),d=a(c);n(655),n(656);var p=n(657),f=a(p)},,function(e,t){},function(e,t){e.exports='<div class="form-horizontal">\n  <div class="form-group">\n    <div class="col-lg-6">\n      <label>\n        <input type="checkbox" ng-model="visualization.options.controls.enabled">\n        Hide Pivot Controls\n      </label>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=[];return e.sourceLinks.forEach(function(e){t.push(e.target)}),e.targetLinks.forEach(function(e){t.push(e.source)}),t}function i(e){function t(e){return e||"Exit"}function n(e,n){e=t(e);var a=e+":"+String(n),r=i[a];if(!r){r={name:e};var s=o.push(r)-1;r.id=s,i[a]=r}return r}function a(e,t){var n=s[[e,t]];return n||(n={target:t,source:e,value:0},s[[e,t]]=n),n}function r(e,t,r,i){if(""!==e&&e||!(i>1)){var s=n(e,i),o=n(t,i+1);a(s.id,o.id).value+=parseInt(r,10)}}var i={},s={},o=[],l=function(e){return"value"!==e&&0!==e.indexOf("$$")},u=m.default.sortBy(m.default.filter(m.default.keys(e[0]),l),m.default.identity);return e.forEach(function(e){r(e[u[0]],e[u[1]],e.value,1),r(e[u[1]],e[u[2]],e.value,2),r(e[u[2]],e[u[3]],e.value,3),r(e[u[3]],e[u[4]],e.value,4)}),{nodes:o,links:m.default.values(s)}}function s(e,t){b.default.nest().key(function(e){return e.x}).entries(t.nodes).map(function(e){return e.values}).forEach(function(t){t=m.default.filter(m.default.sortBy(t,function(e){return-e.value}),function(e){return"Exit"!==e.name});var n=b.default.sum(t,function(e){return e.dy}),a=(e-n)/t.length;m.default.reduce(t,function(e,t){return t.y=e,e+t.dy+a},0)})}function o(e,t,n){function a(e){var t=r(e);t=m.default.pluck(t,"id"),x.filter(function(n){return n!==e&&!m.default.contains(t,n.id)}).style("opacity",.2),y.filter(function(t){return!(m.default.include(e.sourceLinks,t)||m.default.include(e.targetLinks,t))}).style("opacity",.2)}function o(){x.style("opacity",1),y.style("opacity",1)}var l={top:10,right:10,bottom:10,left:10},u=(0,h.default)(e).parent().width()-l.left-l.right,c=t-l.top-l.bottom,d=function(e){return b.default.format(",.0f")(e)},p=b.default.scale.category20();n=i(n),n.nodes=m.default.map(n.nodes,function(e){return m.default.extend(e,{color:p(e.name.replace(/ .*/,""))})});var f=b.default.select(e).append("svg").attr("class","sankey").attr("width",u+l.left+l.right).attr("height",c+l.top+l.bottom).append("g").attr("transform","translate("+l.left+","+l.top+")"),g=(0,w.default)().nodeWidth(15).nodePadding(10).size([u,c]),v=g.link();g.nodes(n.nodes).links(n.links).layout(0),s(c,n),g.relayout();var y=f.append("g").selectAll(".link").data(n.links).enter().append("path").filter(function(e){return"Exit"!==e.target.name}).attr("class","link").attr("d",v).style("stroke-width",function(e){return Math.max(1,e.dy)}).sort(function(e,t){return t.dy-e.dy});y.append("title").text(function(e){return e.source.name+"  "+e.target.name+"\n"+d(e.value)});var x=f.append("g").selectAll(".node").data(n.nodes).enter().append("g").filter(function(e){return"Exit"!==e.name}).attr("class","node").attr("transform",function(e){return"translate("+e.x+","+e.y+")"});x.on("mouseover",a).on("mouseout",o),x.append("rect").attr("height",function(e){return e.dy}).attr("width",g.nodeWidth()).style("fill",function(e){return e.color}).style("stroke",function(e){return b.default.rgb(e.color).darker(2)}).append("title").text(function(e){return e.name+"\n"+d(e.value)}),x.append("text").attr("x",-6).attr("y",function(e){return e.dy/2}).attr("dy",".35em").attr("text-anchor","end").attr("transform",null).text(function(e){return e.name}).filter(function(e){return e.x<u/2}).attr("x",6+g.nodeWidth()).attr("text-anchor","start")}function l(){return{restrict:"E",link:function(e,t){function n(){var n=e.queryResult.getData();n&&(p.default.element(t[0]).empty(),o(t[0],e.visualization.options.height,n))}p.default.element(window).on("resize",n),e.$watch("queryResult && queryResult.getData()",n),e.$watch("visualization.options.height",function(e,t){e!==t&&n()})}}}function u(){return{restrict:"E",template:q.default}}function c(e){e.directive("sankeyRenderer",l),e.directive("sankeyEditor",u),e.config(["VisualizationProvider",function(e){var t={height:300};e.registerVisualization({type:"SANKEY",name:"Sankey",renderTemplate:'<sankey-renderer options="visualization.options" query-result="queryResult"></sankey-renderer>',editorTemplate:"<sankey-editor></sankey-editor>",defaultOptions:t})}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var d=n(19),p=a(d),f=n(5),m=a(f),g=n(14),h=a(g),v=n(2),b=a(v),y=n(659),w=a(y),x=n(660),q=a(x)},function(e,t,n){"use strict";function a(e){return e.y+e.dy/2}function r(e){return e.value}function i(){function e(){m.forEach(function(e){e.sourceLinks=[],e.targetLinks=[]}),g.forEach(function(e){var t=e.source,n=e.target;"number"==typeof t&&(t=e.source=m[e.source]),"number"==typeof n&&(n=e.target=m[e.target]),t.sourceLinks.push(e),n.targetLinks.push(e)})}function t(){m.forEach(function(e){e.value=Math.max(o.default.sum(e.sourceLinks,r),o.default.sum(e.targetLinks,r))})}function n(e){m.forEach(function(t){t.sourceLinks.length||(t.x=e-1)})}function i(e){m.forEach(function(t){t.x*=e})}function s(){function e(e){e.x=r,e.dx=d,e.sourceLinks.forEach(function(e){a.indexOf(e.target)<0&&a.push(e.target)})}for(var t=m,a=void 0,r=0;t.length;)a=[],t.forEach(e),t=a,r+=1;n(r),i((f[0]-d)/(r-1))}function l(e){function t(){i.forEach(function(e){var t=e.length,a=void 0,r=void 0,i=0,s=void 0;for(e.sort(n),s=0;s<t;++s)a=e[s],r=i-a.y,r>0&&(a.y+=r),i=a.y+a.dy+p;if((r=i-p-f[1])>0)for(i=a.y-=r,s=t-2;s>=0;--s)a=e[s],r=a.y+a.dy+p-i,r>0&&(a.y-=r),i=a.y})}function t(){i.forEach(function(e){var t=void 0,a=void 0,r=0,i=e.length,s=void 0;for(e.sort(n),s=0;s<i;++s)t=e[s],a=r-t.y,a>0&&(t.y+=a),r=t.y+t.dy+p;if((a=r-p-f[1])>0)for(r=t.y-=a,s=i-2;s>=0;--s)t=e[s],a=t.y+t.dy+p-r,a>0&&(t.y-=a),r=t.y})}function n(e,t){return e.y-t.y}var i=o.default.nest().key(function(e){return e.x}).sortKeys(o.default.ascending).entries(m).map(function(e){return e.values});!function(){var e=o.default.min(i,function(e){return(f[1]-(e.length-1)*p)/o.default.sum(e,r)});i.forEach(function(t){t.forEach(function(t,n){t.y=n,t.dy=t.value*e})}),g.forEach(function(t){t.dy=t.value*e})}(),t();for(var s=1;e>0;e-=1)!function(e){function t(e){return a(e.target)*e.value}i.slice().reverse().forEach(function(n){n.forEach(function(n){if(n.sourceLinks.length){var i=o.default.sum(n.sourceLinks,t)/o.default.sum(n.sourceLinks,r);n.y+=(i-a(n))*e}})})}(s*=.99),t(),function(e){function t(e){return a(e.source)*e.value}i.forEach(function(n){n.forEach(function(n){if(n.targetLinks.length){var i=o.default.sum(n.targetLinks,t)/o.default.sum(n.targetLinks,r);n.y+=(i-a(n))*e}})})}(s),t()}function u(){function e(e,t){return e.source.y-t.source.y}function t(e,t){return e.target.y-t.target.y}m.forEach(function(n){n.sourceLinks.sort(t),n.targetLinks.sort(e)}),m.forEach(function(e){var t=0,n=0;e.sourceLinks.forEach(function(e){e.sy=t,t+=e.dy}),e.targetLinks.forEach(function(e){e.ty=n,n+=e.dy})})}var c={},d=24,p=8,f=[1,1],m=[],g=[];return c.nodeWidth=function(e){return arguments.length?(d=+e,c):d},c.nodePadding=function(e){return arguments.length?(p=+e,c):p},c.nodes=function(e){return arguments.length?(m=e,c):m},c.links=function(e){return arguments.length?(g=e,c):g},c.size=function(e){return arguments.length?(f=e,c):f},c.layout=function(n){return e(),t(),s(),l(n),u(),c},c.relayout=function(){return u(),c},c.link=function(){function e(e){var t=e.source.x+e.source.dx,a=e.target.x,r=o.default.interpolateNumber(t,a),i=r(n),s=r(1-n),l=e.source.y+e.sy+e.dy/2,u=e.target.y+e.ty+e.dy/2;return"M"+t+","+l+"C"+i+","+l+" "+s+","+u+" "+a+","+u}var t=arguments,n=.5;return e.curvature=function(a){return t.length?(n=+a,e):n},e},c}Object.defineProperty(t,"__esModule",{value:!0});var s=n(2),o=function(e){return e&&e.__esModule?e:{default:e}}(s);t.default=i},function(e,t){e.exports='<div class="form-horizontal">\n  <div class="form-group">\n    <label class="col-lg-6">Height</label>\n    <div class="col-lg-6">\n      <input type="number" ng-model="visualization.options.height" min="1" class="form-control">\n    </div>\n  </div>\n  <div>\n    <hr>\n    This visualization expects the query result to have rows in the following format:\n\n    <ul>\n      <li><strong>stage1</strong> - stage 1 value</li>\n      <li><strong>stage2</strong> - stage 2 value (or null)</li>\n      <li><strong>stage3</strong> - stage 3 value (or null)</li>\n      <li><strong>stage4</strong> - stage 4 value (or null)</li>\n      <li><strong>stage5</strong> - stage 5 value (or null)</li>\n      <li><strong>value</strong> - number of times this sequence occurred</li>\n    </ul>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(){return{restrict:"E",link:function(e,t){function n(){a.remove(),a=new c.default(e,t)}var a=new c.default(e,t);(0,l.default)(window).on("resize",n),e.$watch("visualization.options.height",function(e,t){e!==t&&n()})}}}function i(){return{restrict:"E",template:p.default}}function s(e){e.directive("sunburstSequenceRenderer",r),e.directive("sunburstSequenceEditor",i),e.config(["VisualizationProvider",function(e){var t={height:300};e.registerVisualization({type:"SUNBURST_SEQUENCE",name:"Sunburst Sequence",renderTemplate:'<sunburst-sequence-renderer options="visualization.options" query-result="queryResult"></sunburst-sequence-renderer>',editorTemplate:"<sunburst-sequence-editor></sunburst-sequence-editor>",defaultOptions:t})}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var o=n(14),l=a(o),u=n(662),c=a(u),d=n(663),p=a(d)},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){return m(e.name)}function i(e){for(var t=[],n=e;n.parent;)t.unshift(n),n=n.parent;return t}function s(e,t){function n(e,t){var n=[];return n.push("0,0"),n.push(q.w+",0"),n.push(q.w+q.t+","+q.h/2),n.push(q.w+","+q.h),n.push("0,"+q.h),t>0&&n.push(q.t+","+q.h/2),n.join(" ")}function a(e,t){var a=S.selectAll("g").data(e,function(e){return e.name+e.depth}),i=a.enter().append("g");i.append("polygon").classed("breadcrumbs-shape",!0).attr("points",n).attr("fill",r),i.append("text").classed("breadcrumbs-text",!0).attr("x",(q.w+q.t)/2).attr("y",q.h/2).attr("dy","0.35em").attr("font-size","10px").attr("text-anchor","middle").text(function(e){return e.name}),a.attr("transform",function(e,t){return"translate("+t*(q.w+q.s)+", 0)"}),a.exit().remove(),P.attr("x",(e.length+.5)*(q.w+q.s)).attr("y",q.h/2).attr("dy","0.35em").attr("text-anchor","middle").attr("fill","black").attr("font-weight",600).text(t)}function s(e){var t=(100*e.value/$).toPrecision(3),n=t+"%";t<1&&(n="< 1.0%");var r=i(e);a(r,n),j.selectAll("path").attr("opacity",.3),j.selectAll("path").filter(function(e){return r.indexOf(e)>=0}).attr("opacity",1),E.html("Stage: "+e.depth+"<br /><span class='percentage' style='font-size: 2em;'>"+n+"</span><br />"+e.value+" of "+$+"<br />"),E.style("visibility",""),S.style("visibility","")}function o(){j.selectAll("path").on("mouseover",null),j.selectAll("path").transition().duration(1e3).attr("opacity",1).each("end",function(){l.select(this).on("mouseover",s)}),S.style("visibility","hidden"),E.style("visibility","hidden")}function u(e){var t=k.nodes(e).filter(function(e){return e.dx>.005&&e.name!==f}),n=function(e){var t=[];return e.forEach(function(e){-1===t.indexOf(e.name)&&t.push(e.name)}),t}(t);m.domain(n);var a=j.data([e]).selectAll("path").data(t).enter().append("path").classed("nodePath",!0).attr("display",function(e){return e.depth?null:"none"}).attr("d",z).attr("fill",r).attr("opacity",1).attr("stroke","white").on("mouseover",s);A.on("click",o),$=a.node().__data__.value}function d(e){u(e)}function p(){j.selectAll(".nodePath").remove()}function g(e){var t=void 0;if(c.default.has(e[0],"sequence")&&c.default.has(e[0],"stage")&&c.default.has(e[0],"node")&&c.default.has(e[0],"value")){var n=c.default.groupBy(e,"sequence");t=c.default.map(n,function(e){var t=c.default.sortBy(e,"stage");return{size:e[0].value,sequence:e[0].sequence,nodes:c.default.pluck(t,"node")}})}else{var a=function(e){return"value"!==e&&0!==e.indexOf("$$")},r=c.default.sortBy(c.default.filter(c.default.keys(e[0]),a),c.default.identity);t=c.default.map(e,function(e,t){return{size:e.value,sequence:t,nodes:c.default.compact(c.default.map(r,function(t){return e[t]}))}})}return t}function h(e){var t=g(e),n={name:"root",children:[]};return t.forEach(function(e){for(var t=e.nodes,a=parseInt(e.size,10),r=n,i=0;i<t.length;i+=1)!function(e){var n=r.children,i=t[e],s=e+1===t.length;n||(r.children=n=[],n.push({name:f,size:r.size}));var o=c.default.find(n,function(e){return e.name===i});s&&o?o.children.push({name:f,size:a}):s?n.push({name:i,size:a}):(o||(o={name:i,children:[]},n.push(o)),r=o)}(i)}),n}function v(e){var t=h(e);p(),d(t)}function b(){var t=e.queryResult.getData();t&&v(t)}this.element=t,this.watches=[];var y=t[0].parentElement.clientWidth,w=e.visualization.options.height,x=Math.min(y,w)/2,q={w:y/6,h:30,s:3,t:10},_={top:x,bottom:50,left:x,right:0},$=0,k=l.layout.partition().size([2*Math.PI,x*x]).value(function(e){return e.size}),z=l.svg.arc().startAngle(function(e){return e.x}).endAngle(function(e){return e.x+e.dx}).innerRadius(function(e){return Math.sqrt(e.y)}).outerRadius(function(e){return Math.sqrt(e.y+e.dy)}),A=l.select(t[0]).append("div").classed("vis-container",!0).style("position","relative").style("margin-top","5px").style("height",w+2*q.h+"px"),S=A.append("div").classed("breadcrumbs-container",!0).append("svg").attr("width",y).attr("height",q.h).attr("fill","white").attr("font-weight",600),C=(y-2*x)/2,j=A.append("div").classed("sunburst-container",!0).style("z-index","2").style("left",C+"px").style("position","absolute").append("svg").attr("width",y).attr("height",w).append("g").attr("transform","translate("+_.left+","+_.top+")"),P=S.append("text").classed("lastCrumb",!0),E=A.append("div").classed("summary-container",!0).style("position","absolute").style("top",q.h+.8*x+"px").style("left",C+x/2+"px").style("width",x+"px").style("height",x+"px").style("text-align","center").style("font-size","11px").style("color","#666").style("z-index","1");b(),this.watches.push(e.$watch("visualization.options",b,!0)),this.watches.push(e.$watch("queryResult && queryResult.getData()",b))}Object.defineProperty(t,"__esModule",{value:!0});var o=n(2),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(o),u=n(5),c=a(u),d=n(19),p=a(d),f="<<<Exit>>>",m=l.scale.category10();s.prototype.remove=function(){this.watches.forEach(function(e){e()}),p.default.element(this.element[0]).empty(".vis-container")},t.default=s},function(e,t){e.exports='<div class="form-horizontal">\n  <div class="form-group">\n    <label class="col-lg-6">Height</label>\n    <div class="col-lg-6">\n      <input type="number" ng-model="visualization.options.height" min="1" class="form-control">\n    </div>\n  </div>\n  <div>\n    <hr>\n    This visualization expects the query result to have rows in one of the following formats:\n\n    <strong>Option 1:</strong>\n    <ul>\n      <li><strong>sequence</strong> - sequence id</li>\n      <li><strong>stage</strong> - what stage in sequence this is (1, 2, ...)</li>\n      <li><strong>node</strong> - stage name</li>\n      <li><strong>value</strong> - number of times this sequence occurred</li>\n    </ul>\n\n    <strong>Option 2:</strong>\n    <ul>\n      <li><strong>stage1</strong> - stage 1 value</li>\n      <li><strong>stage2</strong> - stage 2 value (or null)</li>\n      <li><strong>stage3</strong> - stage 3 value (or null)</li>\n      <li><strong>stage4</strong> - stage 4 value (or null)</li>\n      <li><strong>stage5</strong> - stage 5 value (or null)</li>\n      <li><strong>value</strong> - number of times this sequence occurred</li>\n    </ul>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a){var r=n;switch(a){case"integer":r=e("number")(n,0);break;case"float":r=e("number")(n,2);break;case"boolean":void 0!==n&&(r=String(n));break;case"date":n&&l.default.isMoment(n)&&(r=n.format(t.dateFormat));break;case"datetime":n&&l.default.isMoment(n)&&(r=n.format(t.dateTimeFormat));break;default:(0,u.isString)(n)&&(r=e("linkify")(n))}return r}function i(e){return{restrict:"E",scope:{queryResult:"=",itemsPerPage:"="},template:p.default,replace:!1,controller:["$scope","$filter",function(t,n){t.gridColumns=[],t.gridRows=[],t.$watch("queryResult && queryResult.getData()",function(a){if(a)if(null==t.queryResult.getData())t.gridColumns=[],t.filters=[];else{t.filters=t.queryResult.getFilters();var i=t.queryResult.getColumns();i.forEach(function(t){t.title=(0,c.getColumnCleanName)(t.name),t.formatFunction=(0,u.partial)(r,n,e,u._,t.type)}),t.gridRows=t.queryResult.getData(),t.gridColumns=i}})}]}}function s(e){e.config(["VisualizationProvider",function(e){e.registerVisualization({type:"TABLE",name:"Table",renderTemplate:'<grid-renderer options="visualization.options" query-result="queryResult"></grid-renderer>',skipTypes:!0})}]),e.directive("gridRenderer",i)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var o=n(0),l=a(o),u=n(5),c=n(232),d=n(665),p=a(d);i.$inject=["clientConfig"]},function(e,t){e.exports='<dynamic-table rows="gridRows" columns="gridColumns"></dynamic-table>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n={};return e.forEach(function(e){e[t].toString().split(" ").forEach(function(e){e in n?n[e]+=1:n[e]=1})}),n}function i(){return{restrict:"E",link:function(e,t){function n(){function n(e){u.default.select(t[0].parentNode).select("svg").remove(),u.default.select(t[0].parentNode).append("svg").attr("width",l.size()[0]).attr("height",l.size()[1]).append("g").attr("transform","translate("+l.size()[0]/2+","+l.size()[1]/2+")").selectAll("text").data(e).enter().append("text").style("font-size",function(e){return e.size+"px"}).style("font-family","Impact").style("fill",function(e,t){return o(t)}).attr("text-anchor","middle").attr("transform",function(e){return"translate("+[e.x,e.y]+")rotate("+e.rotate+")"}).text(function(e){return e.text})}if(d.default.isDefined(e.queryResult)){var a=e.queryResult.getData(),i={};e.visualization.options.column&&(i=r(a,e.visualization.options.column));var s=[];(0,m.each)(i,function(e,t){s.push({text:t,size:10+Math.pow(e,2)})});var o=u.default.scale.category20(),l=(0,f.default)().size([500,500]).words(s).padding(5).rotate(function(){return 90*Math.floor(2*Math.random())}).font("Impact").fontSize(function(e){return e.size});l.on("end",n),l.start()}}e.$watch("queryResult && queryResult.getData()",n),e.$watch("visualization.options.column",n)}}}function s(){return{restrict:"E",template:h.default}}function o(e){e.directive("wordCloudEditor",s),e.directive("wordCloudRenderer",i),e.config(["VisualizationProvider",function(e){e.registerVisualization({type:"WORD_CLOUD",name:"Word Cloud",renderTemplate:'<word-cloud-renderer options="visualization.options" query-result="queryResult"></word-cloud-renderer>',editorTemplate:"<word-cloud-editor></word-cloud-editor>"})}])}Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var l=n(2),u=a(l),c=n(19),d=a(c),p=n(667),f=a(p),m=n(5),g=n(670),h=a(g)},,,,function(e,t){e.exports='<div class="form-horizontal">\n  <div class="form-group">\n    <label class="col-lg-6">Word Cloud Column Name</label>\n    <div class="col-lg-6">\n      <select ng-options="name for name in queryResult.getColumnNames()" ng-model="visualization.options.column" class="form-control"></select>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){function a(e){return n(r(e))}function r(e){var t=i[e];if(!(t+1))throw new Error("Cannot find module '"+e+"'.");return t}var i={"./admin/outdated-queries/index.js":672,"./admin/status/index.js":676,"./admin/tasks/index.js":678,"./alert/index.js":680,"./alerts-list/index.js":682,"./dashboards/dashboard-list.js":684,"./dashboards/dashboard.js":687,"./dashboards/public-dashboard-page.js":690,"./data-sources/list.js":692,"./data-sources/show.js":694,"./destinations/list.js":696,"./destinations/show.js":698,"./groups/data-sources.js":700,"./groups/list.js":702,"./groups/show.js":704,"./home/index.js":706,"./queries-list/index.js":708,"./queries/queries-search-results-page.js":710,"./queries/source-view.js":712,"./queries/view.js":713,"./query-snippets/edit.js":714,"./query-snippets/list.js":717,"./users/list.js":719,"./users/new.js":721,"./users/show.js":723};a.keys=function(){return Object.keys(i)},a.resolve=r,e.exports=a,a.id=671},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a){var r=this;t.record("view","page","admin/outdated_queries"),e.autoUpdate=!0,this.queries=new l.Paginator([],{itemsPerPage:50});!function t(){e.autoUpdate&&(e.refresh_time=(0,o.default)().add(1,"minutes"),n.get("/api/admin/queries/outdated").success(function(t){r.queries.updateRows(t.queries),e.updatedAt=1e3*t.updated_at}));var i=a(t,59e3);e.$on("$destroy",function(){i&&a.cancel(i)})}()}function i(e){return e.component("outdatedQueriesPage",{template:c.default,controller:r}),{"/admin/queries/outdated":{template:"<outdated-queries-page></outdated-queries-page>",title:"Outdated Queries"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=n(0),o=a(s),l=n(26),u=n(675),c=a(u);r.$inject=["$scope","Events","$http","$timeout"]},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(5),s=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.page,i=void 0===r?1:r,s=n.itemsPerPage,o=void 0===s?20:s,l=n.totalCount,u=void 0===l?void 0:l;a(this,e),this.page=i,this.itemsPerPage=o,this.updateRows(t,u),this.orderByField=void 0,this.orderByReverse=!1}return r(e,[{key:"setPage",value:function(e){this.page=e}},{key:"getPageRows",value:function(){var e=this.itemsPerPage*(this.page-1),t=this.itemsPerPage*this.page;return this.rows.slice(e,t)}},{key:"updateRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.rows=e,this.rows?this.totalCount=t||e.length:this.totalCount=0}},{key:"orderBy",value:function(e){e===this.orderByField?this.orderByReverse=!this.orderByReverse:(this.orderByField=e,this.orderByReverse=!1),this.orderByField&&(this.rows=(0,i.sortBy)(this.rows,this.orderByField),this.orderByReverse&&(this.rows=this.rows.reverse()))}}]),e}();t.default=s},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=n.page,i=void 0===r?1:r,s=n.itemsPerPage,o=void 0===s?20:s;a(this,e),this.page=i,this.itemsPerPage=o,this.rowsFetcher=t,this.rowsFetcher(this.page,this.itemsPerPage,this)}return r(e,[{key:"setPage",value:function(e){this.page=e,this.rowsFetcher(e,this.itemsPerPage,this)}},{key:"getPageRows",value:function(){return this.rows}},{key:"updateRows",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;this.rows=e,this.rows?this.totalCount=t||e.length:this.totalCount=0}}]),e}();t.default=i},function(e,t){e.exports='<page-header title="Admin">\n</page-header>\n\n<div class="container">\n  <div class="container bg-white p-5">\n    <ul class="tab-nav">\n      <li><a href="admin/status">System Status</a></li>\n      <li><a href="admin/queries/tasks">Queries Queue</a></li>\n      <li class="active"><a href="admin/queries/outdated">Outdated Queries</a></li>\n    </ul>\n\n    <table class="table table-condensed table-hover">\n      <thead>\n      <tr>\n        <th>Name</th>\n        <th>Created By</th>\n        <th>Runtime</th>\n        <th>Last Executed At</th>\n        <th>Created At</th>\n        <th>Update Schedule</th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr ng-repeat="row in $ctrl.queries.getPageRows()">\n        <td>\n          {{row.data_source_id}}\n        </td>\n        <td>\n          <a ng-href="queries/{{row.id}}">{{row.name}}</a>\n        </td>\n        <td>{{row.user.name}}</td>\n        <td>{{row.runtime | durationHumanize}}</td>\n        <td>{{row.retrieved_at | dateTime}}</td>\n        <td>{{row.created_at | dateTime }}</td>\n        <td>{{row.schedule | scheduleHumanize}}</td>\n      </tr>\n      </tbody>\n    </table>\n    <paginator paginator="$ctrl.queries"></paginator>\n\n    <div class="badge">\n      Last update: <span am-time-ago="updatedAt"></span>\n    </div>\n    (<label><input type="checkbox" ng-model="autoUpdate"> Auto Update</label>)\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e,t,n,a,r){r.record("view","page","admin/status");!function a(){t.get("/status.json").success(function(t){e.workers=t.workers,delete t.workers,e.manager=t.manager,delete t.manager,e.status=t});var r=n(a,59e3);e.$on("$destroy",function(){r&&n.cancel(r)})}()}function r(e){return e.component("statusPage",{template:s.default,controller:a}),{"/admin/status":{template:"<status-page></status-page>",title:"System Status"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(677),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["$scope","$http","$timeout","currentUser","Events"]},function(e,t){e.exports='<page-header title="Admin">\n</page-header>\n\n<div class="container">\n  <div class="container bg-white p-5">\n    <ul class="tab-nav">\n      <li class="active"><a href="admin/status">System Status</a></li>\n      <li><a href="admin/queries/tasks">Queries Queue</a></li>\n      <li><a href="admin/queries/outdated">Outdated Queries</a></li>\n    </ul>\n\n    <div>\n\n      <ul class="list-group col-lg-4">\n        <li class="list-group-item active">General</li>\n        <li class="list-group-item" ng-repeat="(name, value) in status">\n          <span class="badge">{{value}}</span>\n          {{name | toHuman}}\n        </li>\n      </ul>\n\n      <ul class="list-group col-lg-4">\n        <li class="list-group-item active">Manager</li>\n        <li class="list-group-item">\n          <span class="badge" am-time-ago="manager.last_refresh_at*1000.0"></span>\n          Last Refresh\n        </li>\n        <li class="list-group-item">\n          <span class="badge" am-time-ago="manager.started_at*1000.0"></span>\n          Started\n        </li>\n        <li class="list-group-item">\n          <span class="badge">{{manager.outdated_queries_count}}</span>\n          Outdated Queries Count\n        </li>\n      </ul>\n\n      <ul class="list-group col-lg-4">\n        <li class="list-group-item active">Queues</li>\n        <li class="list-group-item" ng-repeat="(name, value) in manager.queues">\n          <span class="badge">{{value.size}}</span>\n          {{name}} <span uib-popover="{{value.data_sources}}" popover-trigger="\'mouseenter\'"><i class="fa fa-question-circle"></i></span>\n        </li>\n      </ul>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a,r){var i=this;r.record("view","page","admin/tasks"),e.autoUpdate=!0,e.selectedTab="in_progress",e.tasks={waiting:[],in_progress:[],done:[]},this.tasksPaginator=new l.Paginator([],{itemsPerPage:50}),e.setTab=function(t){e.selectedTab=t,i.tasksPaginator.updateRows(e.tasks[t])},e.setTab(t.hash()||"in_progress");!function t(){e.autoUpdate&&(e.refresh_time=(0,o.default)().add(1,"minutes"),n.get("/api/admin/queries/tasks").success(function(t){e.tasks=t,i.tasksPaginator.updateRows(e.tasks[e.selectedTab])}));var r=a(t,5e3);e.$on("$destroy",function(){r&&a.cancel(r)})}()}function i(e){return e.component("tasksPage",{template:c.default,controller:r}),{"/admin/queries/tasks":{template:"<tasks-page></tasks-page>",title:"Running Queries"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=n(0),o=a(s),l=n(26),u=n(679),c=a(u);r.$inject=["$scope","$location","$http","$timeout","Events"]},function(e,t){e.exports='<page-header title="Admin">\n</page-header>\n\n<div class="container">\n  <div class="container bg-white p-5">\n    <ul class="tab-nav">\n      <li><a href="admin/status">System Status</a></li>\n      <li class="active"><a href="admin/queries/tasks">Queries Queue</a></li>\n      <li><a href="admin/queries/outdated">Outdated Queries</a></li>\n    </ul>\n\n    <ul class="tab-nav">\n      <rd-tab tab-id="in_progress" name="In Progress ({{tasks.in_progress.length}})" ng-click="setTab(\'in_progress\')"></rd-tab>\n      <rd-tab tab-id="waiting" name="Waiting ({{tasks.waiting.length}})" ng-click="setTab(\'waiting\')"></rd-tab>\n      <rd-tab tab-id="done" name="Done" ng-click="setTab(\'done\')"></rd-tab>\n    </ul>\n\n    <table class="table table-condensed table-hover">\n      <thead>\n      <tr>\n        <th>Data Source ID</th>\n        <th>Username</th>\n        <th>State</th>\n        <th>Query ID</th>\n        <th>Query Hash</th>\n        <th>Runtime</th>\n        <th>Created At</th>\n        <th>Started At</th>\n        <th>Updated At</th>\n        <th ng-if="selectedTab === \'in_progress\'"></th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr ng-repeat="row in $ctrl.tasksPaginator.getPageRows()">\n        <td>{{row.data_source_id}}</td>\n        <td>{{row.username}}</td>\n        <td>{{row.state}} <span ng-if="row.state === \'failed\'" uib-popover="{{row.error}}" popover-trigger="mouseenter" class="zmdi zmdi-help"></span></td>\n        <td><a href="queries/{{row.query_id}}">{{row.query_id}}</a></td>\n        <td>{{row.query_hash}}</td>\n        <td>{{row.run_time | durationHumanize}}</td>\n        <td>{{row.created_at | toMilliseconds | dateTime }}</td>\n        <td>{{row.started_at | toMilliseconds | dateTime }}</td>\n        <td>{{row.updated_at | toMilliseconds | dateTime }}</td>\n        <td ng-if="selectedTab === \'in_progress\'">\n          <cancel-query-button query-id="row.query_id" task-id="row.task_id"></cancel-query-button>\n        </td>\n      </tr>\n      </tbody>\n    </table>\n    <paginator paginator="$ctrl.tasksPaginator"></paginator>\n\n    <label><input type="checkbox" ng-model="autoUpdate"> Auto Update</label>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e,t,n,a,r,s,o,l){var u=this;this.alertId=e.alertId,"new"===this.alertId?o.record("view","page","alerts/new"):o.record("view","alert",this.alertId),this.trustAsHtml=function(e){return n.trustAsHtml(e)},this.onQuerySelected=function(e){u.selectedQuery=e,e.getQueryResultPromise().then(function(e){u.queryResult=e,u.alert.options.column=u.alert.options.column||e.getColumnNames()[0]})},"new"===this.alertId?(this.alert=new l({options:{}}),this.canEdit=!0):this.alert=l.get({id:this.alertId},function(e){u.onQuerySelected(new s(e.query)),u.canEdit=r.canEdit(u.alert)}),this.ops=["greater than","less than","equals"],this.selectedQuery=null;var c=(0,i.template)("<%= query.name %>: <%= options.column %> <%= options.op %> <%= options.value %>");this.getDefaultName=function(){if(u.alert.query)return c(u.alert)},this.searchQueries=function(e){!e||e.length<3||s.search({q:e},function(e){u.queries=e})},this.saveChanges=function(){void 0!==u.alert.name&&""!==u.alert.name||(u.alert.name=u.getDefaultName()),""!==u.alert.rearm&&0!==u.alert.rearm||(u.alert.rearm=null),u.alert.$save(function(e){a.success("Saved."),"new"===u.alertId&&t.path("/alerts/"+e.id).replace()},function(){a.error("Failed saving alert.")})},this.delete=function(){u.alert.$delete(function(){t.path("/alerts"),a.success("Alert deleted.")},function(){a.error("Failed deleting alert.")})}}function r(e){return e.component("alertPage",{template:o.default,controller:a}),{"/alerts/:alertId":{template:"<alert-page></alert-page>",title:"Alerts"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(5),s=n(681),o=function(e){return e&&e.__esModule?e:{default:e}}(s);a.$inject=["$routeParams","$location","$sce","toastr","currentUser","Query","Events","Alert"]},function(e,t){e.exports='<page-header title=\'{{$ctrl.alert.name || $ctrl.getDefaultName() || "New" }}\'>\n</page-header>\n\n<div class="container">\n  <email-settings-warning function="\'alert emails\'"></email-settings-warning>\n\n  <div class="container">\n    <div class="row bg-white p-10">\n      <div class="col-md-8">\n        <form name="alertForm" class="form">\n          <div class="form-group">\n            <label>Query</label>\n            <ui-select ng-model="$ctrl.alert.query" reset-search-input="false" on-select="$ctrl.onQuerySelected($item)" ng-disabled="!$ctrl.canEdit">\n              <ui-select-match placeholder="Search a query by name">{{$select.selected.name}}</ui-select-match>\n              <ui-select-choices repeat="q in $ctrl.queries"\n                                 refresh="$ctrl.searchQueries($select.search)"\n                                 refresh-delay="0">\n                <div ng-bind-html="$ctrl.trustAsHtml(q.name | highlight: $select.search)"></div>\n              </ui-select-choices>\n            </ui-select>\n          </div>\n\n          <div class="form-group" ng-show="$ctrl.selectedQuery">\n            <label>Name</label>\n            <input type="string" placeholder="{{$ctrl.getDefaultName()}}" class="form-control" ng-model="$ctrl.alert.name" ng-disabled="!$ctrl.canEdit">\n          </div>\n\n          <div ng-show="$ctrl.queryResult" class="form-horizontal">\n            <div class="form-group">\n              <label class="control-label col-md-2">Value column</label>\n              <div class="col-md-4">\n                <select ng-options="name for name in $ctrl.queryResult.getColumnNames()" ng-model="$ctrl.alert.options.column"\n                        class="form-control" ng-disabled="!$ctrl.canEdit"></select>\n              </div>\n              <label class="control-label col-md-2">Value</label>\n              <div class="col-md-4">\n                <p class="form-control-static">{{$ctrl.queryResult.getData()[0][$ctrl.alert.options.column]}}</p>\n              </div>\n            </div>\n            <div class="form-group">\n              <label class="control-label col-md-2">Op</label>\n              <div class="col-md-4">\n                <select ng-options="name for name in $ctrl.ops" ng-model="$ctrl.alert.options.op" class="form-control" ng-disabled="!$ctrl.canEdit"></select>\n              </div>\n              <label class="control-label col-md-2">Reference</label>\n              <div class="col-md-4">\n                <input type="number" step="any" class="form-control" ng-model="$ctrl.alert.options.value" placeholder="reference value" ng-disabled="!$ctrl.canEdit"\n                       required/>\n              </div>\n            </div>\n            <div class="form-group">\n              <label class="control-label col-md-2">Rearm seconds</label>\n              <div class="col-md-4">\n                <input type="number" class="form-control" ng-model="$ctrl.alert.rearm" ng-disabled="!$ctrl.canEdit"/>\n              </div>\n            </div>\n          </div>\n\n          <div class="form-group" ng-if="$ctrl.canEdit">\n            <button class="btn btn-primary" ng-disabled="!alertForm.$valid" ng-click="$ctrl.saveChanges()">Save</button>\n            <button class="btn btn-danger" ng-if="$ctrl.alert.id" ng-click="$ctrl.delete()">Delete</button>\n          </div>\n        </form>\n      </div>\n      <div class="col-md-4" ng-if="$ctrl.alert.id">\n        <alert-subscriptions alert-id="$ctrl.alert.id"></alert-subscriptions>\n      </div>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e){return e.component("alertsListPage",{template:o.default,controller:u}),{"/alerts":{template:"<alerts-list-page></alerts-list-page>",title:"Alerts"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(26),s=n(683),o=function(e){return e&&e.__esModule?e:{default:e}}(s),l={ok:"label label-success",triggered:"label label-danger",unknown:"label label-warning"},u=function e(t,n){var r=this;a(this,e),t.record("view","page","alerts"),this.alerts=new i.Paginator([],{itemsPerPage:20}),n.query(function(e){r.alerts.updateRows(e.map(function(e){return{id:e.id,name:e.name,state:e.state,class:l[e.state],created_by:e.user.name,created_at:e.created_at,updated_at:e.updated_at}}))})};u.$inject=["Events","Alert"]},function(e,t){e.exports='<div>\n  <page-header title="Alerts">\n    <a href="alerts/new" class="btn btn-default"><i class="fa fa-plus"></i> New Alert</a>\n  </page-header>\n\n  <div class="container">\n    <div class="bg-white">\n      <table class="table table-condensed table-hover">\n        <thead>\n        <tr>\n          <th class="sortable-column" ng-click="$ctrl.alerts.orderBy(\'name\')">Name <sort-icon column="\'name\'" sort-column="$ctrl.alerts.orderByField" reverse="$ctrl.alerts.orderByReverse"></sort-icon></th>\n          <th class="sortable-column" ng-click="$ctrl.alerts.orderBy(\'created_by\')">Created By <sort-icon column="\'created_by\'" sort-column="$ctrl.alerts.orderByField" reverse="$ctrl.alerts.orderByReverse"></sort-icon></th>\n          <th class="sortable-column" ng-click="$ctrl.alerts.orderBy(\'state\')">State <sort-icon column="\'state\'" sort-column="$ctrl.alerts.orderByField" reverse="$ctrl.alerts.orderByReverse"></sort-icon></th>\n          <th class="sortable-column" ng-click="$ctrl.alerts.orderBy(\'created_at\')">Created By <sort-icon column="\'created_at\'" sort-column="$ctrl.alerts.orderByField" reverse="$ctrl.alerts.orderByReverse"></sort-icon></th>\n        </tr>\n        </thead>\n        <tbody>\n        <tr ng-repeat="row in $ctrl.alerts.getPageRows()">\n          <td><a href="alerts/{{row.id}}">{{row.name}}</a></td>\n          <td>{{row.created_by}}</td>\n          <td><span ng-class="row.class">{{row.state | uppercase}}</span> since <span am-time-ago="row.updated_at"></span></td>\n          <td><span am-time-ago="row.created_at"></span></td>\n        </tr>\n        </tbody>\n      </table>\n      <paginator paginator="$ctrl.alerts"></paginator>\n    </div>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){var a=this,r=/(^([\w\s]|[^\u0000-\u007F])+):|(#([\w-]|[^\u0000-\u007F])+)/gi;this.logoUrl=n.logoUrl;var i=parseInt(t.search().page||1,10);this.defaultOptions={},this.dashboards=e.query({}),this.selectedTags=[],this.searchText="",this.tagIsSelected=function(e){return a.selectedTags.indexOf(e)>-1},this.toggleTag=function(e,t){a.tagIsSelected(t)?e.shiftKey?a.selectedTags=a.selectedTags.filter(function(e){return e!==t}):a.selectedTags=[]:e.shiftKey?a.selectedTags.push(t):a.selectedTags=[t],a.update()},this.allTags=[],this.dashboards.$promise.then(function(e){var t=e.map(function(e){return e.name.match(r)});a.allTags=o.default.unique(o.default.flatten(t)).filter(function(e){return e}).map(function(e){return e.replace(/:$/,"")}),a.allTags.sort()}),this.paginator=new l.Paginator([],{page:i}),this.update=function(){a.dashboards.$promise.then(function(e){e=o.default.sortBy(e,"name");var t=e.map(function(e){return e.tags=(e.name.match(r)||[]).map(function(e){return e.replace(/:$/,"")}),e.untagged_name=e.name.replace(r,"").trim(),e}).filter(function(e){if(a.selectedTags.length){var t=new Set(e.tags),n=a.selectedTags,r=n.filter(function(e){return t.has(e)});if(n.length!==r.length)return!1}return!(a.searchText&&a.searchText.length&&!e.untagged_name.toLowerCase().includes(a.searchText.toLowerCase()))});a.paginator.updateRows(t,e.count)})},this.update()}function i(e){return e.component("pageDashboardList",{template:c.default,controller:r}),{"/dashboards":{template:"<page-dashboard-list></page-dashboard-list>",reloadOnSearch:!1,title:"Dashboards"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=n(5),o=a(s),l=n(26),u=n(685),c=a(u);n(686),r.$inject=["Dashboard","$location","clientConfig"]},function(e,t){e.exports='<div class=\'container row\'>\n  <page-header title="Dashboards"></page-header>\n  <div class="col-lg-3">\n    <input type=\'text\' class=\'form-control\' placeholder="Search Dashboards..." \n      ng-change="$ctrl.update()" ng-model="$ctrl.searchText" autofocus/>\n    <div class=\'list-group m-t-20 tags-list\'>\n      <a ng-repeat=\'tag in $ctrl.allTags\' ng-class=\'{"active": $ctrl.tagIsSelected(tag)}\'\n      class=\'list-group-item\' ng-click=\'$ctrl.toggleTag($event, tag)\'>\n        {{ tag }}\n      </a>\n    </div>\n  </div>\n  <div class="col-lg-9">\n    <div class="bg-white">\n      <table class="table table-condensed table-hover">\n        <thead>\n        <tr>\n          <th>Name</th>\n          <th>Created At</th>\n        </tr>\n        </thead>\n        <tbody>\n        <tr ng-repeat="dashboard in $ctrl.paginator.getPageRows()">\n          <td>\n            <a href="dashboard/{{ dashboard.slug }}">\n              <span class="label label-primary m-2" ng-bind="tag" ng-repeat="tag in dashboard.tags"></span> {{ dashboard.untagged_name }}\n              <span class="label label-default" ng-if="dashboard.is_draft">Unpublished</span>\n            </a>\n          </td>\n          <td>{{ dashboard.created_at | dateTime }}</td>\n        </tr>\n        </tbody>\n      </table>\n      <paginator paginator="$ctrl.paginator"></paginator>\n    </div>\n  </div>\n</div>\n'},function(e,t){},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a,r,i,s,l,u,c,d,p){var f=this;this.isFullscreen=!1,this.refreshRate=null,this.showPermissionsControl=d.showPermissionsControl,this.currentUser=c,this.globalParameters=[],this.refreshRates=[{name:"10 seconds",rate:10},{name:"30 seconds",rate:30},{name:"1 minute",rate:60},{name:"5 minutes",rate:300},{name:"10 minutes",rate:600},{name:"30 minutes",rate:1800},{name:"1 hour",rate:3600},{name:"12 hour",rate:43200},{name:"24 hour",rate:86400}],this.setRefreshRate=function(e){f.refreshRate=e,null!==e&&(f.loadDashboard(!0),f.autoRefresh())},this.extractGlobalParameters=function(){var e={};f.dashboard.widgets.forEach(function(t){return t.forEach(function(t){t.getQuery()&&t.getQuery().getParametersDefs().filter(function(e){return e.global}).forEach(function(t){var n={};n[t.name]=o.create(Object.getPrototypeOf(t),t),n[t.name].locals=[],e=o.defaults(e,n),e[t.name].locals.push(t)})})}),f.globalParameters=o.values(e)},this.onGlobalParametersChange=function(){f.globalParameters.forEach(function(e){e.locals.forEach(function(t){t.value=e.value})})};var m=function(e,t){s.set(e.name);var a=[];f.dashboard.widgets.forEach(function(e){return e.forEach(function(e){if(e.visualization){var n=t?0:void 0,r=e.getQuery().getQueryResult(n);o.isUndefined(r)||a.push(r.toPromise())}})}),f.extractGlobalParameters(),r.all(a).then(function(t){var a={};t.forEach(function(t){t.getFilters().forEach(function(t){var r=o.has(n.search(),t.name);if(r||e.dashboard_filters_enabled){if(r&&(t.current=n.search()[t.name]),!o.has(a,t.name)){var i=o.extend({},t);a[i.name]=i,a[i.name].originFilters=[]}a[t.name].originFilters.push(t)}})}),f.filters=o.values(a),f.filtersOnChange=function(e){o.each(e.originFilters,function(t){t.current=e.current})}})};this.loadDashboard=o.throttle(function(e){f.dashboard=u.get({slug:t.dashboardSlug},function(t){p.record("view","dashboard",t.id),m(t,e)},function(){f.loadDashboard()})},1e3),this.loadDashboard(),this.autoRefresh=function(){a(function(){f.loadDashboard(!0)},1e3*f.refreshRate.rate).then(function(){return f.autoRefresh()})},this.archiveDashboard=function(){var t=function(){p.record("archive","dashboard",f.dashboard.id),f.dashboard.$delete(function(){e.$broadcast("reloadDashboards")})},n='Are you sure you want to archive the "'+f.dashboard.name+'" dashboard?',a={class:"btn-warning",title:"Archive"};l.open("Archive Dashboard",n,a).then(t)},this.showManagePermissionsModal=function(){i.open({component:"permissionsEditor",resolve:{aclUrl:{url:"api/dashboards/"+f.dashboard.id+"/acl"}}})},this.editDashboard=function(){var e=f.dashboard.dashboard_filters_enabled;i.open({component:"editDashboardDialog",resolve:{dashboard:function(){return f.dashboard}}}).result.then(function(t){var n=!e&&t.dashboard_filters_enabled;f.dashboard=t,n&&m(f.dashboard)})},this.addWidget=function(){i.open({component:"addWidgetDialog",resolve:{dashboard:function(){return f.dashboard}}}).result.then(function(){return f.extractGlobalParameters()})},this.toggleFullscreen=function(){f.isFullscreen=!f.isFullscreen,document.querySelector("body").classList.toggle("headless"),f.isFullscreen?n.search("fullscreen",!0):n.search("fullscreen",null)},this.togglePublished=function(){p.record("toggle_published","dashboard",f.dashboard.id),f.dashboard.is_draft=!f.dashboard.is_draft,f.saveInProgress=!0,u.save({slug:f.dashboard.id,name:f.dashboard.name,layout:JSON.stringify(f.dashboard.layout),is_draft:f.dashboard.is_draft},function(t){f.saveInProgress=!1,f.dashboard.version=t.version,e.$broadcast("reloadDashboards")})},o.has(n.search(),"fullscreen")&&this.toggleFullscreen(),this.openShareForm=function(){i.open({component:"shareDashboard",resolve:{dashboard:f.dashboard}})}}function i(e){return e.component("shareDashboard",p),e.component("dashboardPage",{template:u.default,controller:r}),{"/dashboard/:dashboardSlug":{template:"<dashboard-page></dashboard-page>",reloadOnSearch:!1}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=n(5),o=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(s),l=n(688),u=a(l),c=n(689),d=a(c);r.$inject=["$rootScope","$routeParams","$location","$timeout","$q","$uibModal","Title","AlertDialog","Dashboard","currentUser","clientConfig","Events"];var p={template:d.default,bindings:{resolve:"<",close:"&",dismiss:"&"},controller:["$http",function(e){"ngInject";var t=this;this.dashboard=this.resolve.dashboard,this.toggleSharing=function(){var n="api/dashboards/"+t.dashboard.id+"/share";t.dashboard.publicAccessEnabled?e.post(n).success(function(e){t.dashboard.publicAccessEnabled=!0,t.dashboard.public_url=e.public_url}).error(function(){t.dashboard.publicAccessEnabled=!1}):e.delete(n).success(function(){t.dashboard.publicAccessEnabled=!1,delete t.dashboard.public_url}).error(function(){t.dashboard.publicAccessEnabled=!0})}}]}},function(e,t){e.exports='<div class="container">\n  <div class="row bg-white p-t-10 p-b-10 m-b-10">\n    <div class="col-sm-9">\n      <h3>{{$ctrl.dashboard.name}}\n        <span class="label label-default" ng-if="$ctrl.dashboard.is_draft && !$ctrl.dashboard.is_archived">Unpublished</span>\n        <span class="label label-warning" ng-if="$ctrl.dashboard.is_archived" uib-popover="This dashboard is archived and and won\'t appear in the dashboards list or search results." popover-placement="right" popover-trigger="\'mouseenter\'">Archived</span>\n      </h3>\n    </div>\n    <div class="col-sm-3 text-right">\n      <h3>\n        <span ng-if="!$ctrl.dashboard.is_archived && !public" class="hidden-print">\n            <div class="btn-group" uib-dropdown>\n              <button id="split-button" type="button"\n                      ng-class="{\'btn-default\': $ctrl.refreshRate === null,\'btn-primary\':$ctrl.refreshRate !== null}"\n                      class="btn" ng-click="$ctrl.loadDashboard(true)">\n                <i class="zmdi zmdi-refresh"></i> {{$ctrl.refreshRate === null ? \'Refresh\' : $ctrl.refreshRate.name}}\n              </button>\n              <button type="button" class="btn" uib-dropdown-toggle\n                      ng-class="{\'btn-default\': $ctrl.refreshRate === null,\'btn-primary\':$ctrl.refreshRate !== null}">\n                <span class="caret"></span>\n                <span class="sr-only">Split button!</span>\n              </button>\n              <ul class="dropdown-menu" ng-model="$ctrl.refreshRate" uib-dropdown-menu role="menu" aria-labelledby="split-button">\n                <li role="menuitem" ng-repeat="refreshRate in $ctrl.refreshRates">\n                  <a href="#" ng-click="$ctrl.setRefreshRate(refreshRate)">{{refreshRate.name}}</a>\n                </li>\n                <li role="menuitem" ng-if="$ctrl.refreshRate !== null">\n                  <a href="#" ng-click="$ctrl.setRefreshRate(null)">Stop auto refresh</a>\n                </li>\n              </ul>\n            </div>\n            <button type="button" class="btn btn-sm" ng-class="{\'btn-default\': !$ctrl.isFullscreen, \'btn-primary\': $ctrl.isFullscreen}" tooltip="Enable/Disable Fullscreen display" ng-click="$ctrl.toggleFullscreen()">\n              <span class="zmdi zmdi-fullscreen"></span>\n            </button>\n            <button type="button" class="btn btn-sm" ng-class="{\'btn-default\': !$ctrl.dashboard.publicAccessEnabled, \'btn-primary\': $ctrl.dashboard.publicAccessEnabled}" tooltip="Enable/Disable Share URL" ng-click="$ctrl.openShareForm()" ng-if="$ctrl.dashboard.canEdit() || $ctrl.dashboard.publicAccessEnabled">\n              <span class="zmdi zmdi-share"></span>\n            </button>\n        </span>\n            <div class="btn-group hidden-print" role="group" ng-show="$ctrl.dashboard.canEdit()" uib-dropdown ng-if="!$ctrl.dashboard.is_archived">\n              <button class="btn btn-default btn-sm dropdown-toggle" uib-dropdown-toggle>\n                <span class="zmdi zmdi-more"></span>\n              </button>\n              <ul class="dropdown-menu pull-right" uib-dropdown-menu>\n                <li ng-if="!$ctrl.dashboard.is_archived"><a ng-click="$ctrl.editDashboard()">Edit Dashboard</a></li>\n                <li ng-if="!$ctrl.dashboard.is_archived"><a ng-click="$ctrl.addWidget()">Add Widget</a></li>\n                <li ng-if="$ctrl.showPermissionsControl"><a ng-click="$ctrl.showManagePermissionsModal()">Manage Permissions</a></li>\n                <li ng-if="!$ctrl.dashboard.is_draft"><a ng-click="$ctrl.togglePublished()">Unpublish Dashboard</a></li>\n                <li ng-if="$ctrl.dashboard.is_draft"><a ng-click="$ctrl.togglePublished()">Publish Dashboard</a></li>\n                <li ng-if="!$ctrl.dashboard.is_archived"><a ng-click="$ctrl.archiveDashboard()">Archive Dashboard</a></li>\n              </ul>\n            </div>\n      </h3>\n    </div>\n  </div>\n\n  <div class="m-b-5">\n    <parameters parameters="$ctrl.globalParameters" on-change="$ctrl.onGlobalParametersChange()"></parameters>\n  </div>\n\n  <div class="m-b-5">\n    <filters ng-if="$ctrl.dashboard.dashboard_filters_enabled" filters="$ctrl.filters" on-change="$ctrl.filtersOnChange(filter, $modal)"></filters>\n  </div>\n\n  <div ng-repeat="row in $ctrl.dashboard.widgets" class="row">\n    <dashboard-widget ng-repeat="widget in row" widget="widget" dashboard="$ctrl.dashboard" on-delete="$ctrl.extractGlobalParameters()"></dashboard-widget>\n  </div>\n</div>\n'},function(e,t){e.exports='<div class="modal-header">\n  <button type="button" class="close" aria-label="Close" ng-click="$ctrl.close()"><span aria-hidden="true">&times;</span>\n  </button>\n  <h4 class="modal-title"><i class="fa fa-share-alt"></i> Share</h4>\n</div>\n<div class="modal-body">\n  <div class="checkbox">\n    <label>\n      <input type="checkbox" ng-model="$ctrl.dashboard.publicAccessEnabled" ng-click="$ctrl.toggleSharing()" ng-disabled="!$ctrl.dashboard.canEdit()">\n      Allow public access (using a secret URL).\n    </label>\n  </div>\n\n  <div ng-if="$ctrl.dashboard.publicAccessEnabled">\n    <input type="text" class="form-control" value="{{$ctrl.dashboard.public_url}}">\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){function t(e,t){"ngInject";var n=t.current.params.token;return e.get("api/dashboards/public/"+n).then(function(e){return e.data})}function n(e,t,n){var a=t.current.params.token;return n.setApiKey(a),n.loadConfig()}return n.$inject=["$http","$route","Auth"],t.$inject=["$http","$route"],e.component("publicDashboardPage",u),e.config(["$routeProvider",function(e){e.when("/public/dashboards/:token",{template:'<public-dashboard-page dashboard="$resolve.dashboard"></public-dashboard-page>',reloadOnSearch:!1,resolve:{dashboard:t,session:n}})}]),[]}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(70),s=a(i),o=n(691),l=a(o),u={template:l.default,bindings:{dashboard:"<"},controller:["$routeParams","Widget",function(e,t){"ngInject";this.logoUrl=s.default,this.headless=e.embed,this.headless&&document.querySelector("body").classList.add("headless"),this.public=!0,this.dashboard.widgets=this.dashboard.widgets.map(function(e){return e.map(function(e){return new t(e)})})}]}},function(e,t){e.exports='\x3c!-- simple nav bar --\x3e\n<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation" ng-if="!$ctrl.headless">\n  <div class="container">\n    <div class="navbar-header">\n      <a class="navbar-brand" href="/" target="_self"><img ng-src="{{$ctrl.logoUrl}}"/></a>\n    </div>\n  </div>\n</nav>\n\n<div class="container">\n  <page-header title="{{$ctrl.dashboard.name}}">\n  </page-header>\n\n  <div class="m-b-5">\n    <filters ng-if="$ctrl.dashboard.dashboard_filters_enabled"></filters>\n  </div>\n\n    <div ng-repeat="row in $ctrl.dashboard.widgets" class="row">\n      <dashboard-widget ng-repeat="widget in row" widget="widget" dashboard="$ctrl.dashboard" public="true"></dashboard-widget>\n    </div>\n</div>\n'},function(e,t,n){"use strict";function a(e,t,n,a,r){a.record("view","page","admin/data_sources"),e.dataSources=r.query()}function r(e){return e.controller("DataSourcesCtrl",a),{"/data_sources":{template:s.default,controller:"DataSourcesCtrl",title:"Data Sources"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(693),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["$scope","$location","currentUser","Events","DataSource"]},function(e,t){e.exports='<settings-screen>\n  <div class="row voffset1">\n    <div class="col-md-4">\n      <p>\n        <a href="data_sources/new" class="btn btn-default"><i class="fa fa-plus"></i> New Data Source</a>\n      </p>\n      <div class="list-group">\n        <a ng-href="data_sources/{{dataSource.id}}" class="list-group-item" ng-repeat="dataSource in dataSources"><i class="fa fa-database"></i> {{dataSource.name}}</a>\n      </div>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a,r,i,s,o){function l(){s.record("delete","datasource",e.dataSource.id),e.dataSource.$delete(function(){r.success("Data source deleted successfully."),a.path("/data_sources/")},function(e){c("Failed to delete data source: ",e.status,e.statusText,e.data),r.error("Failed to delete data source.")})}function u(t){s.record("test","datasource",e.dataSource.id),o.test({id:e.dataSource.id},function(e){e.ok?r.success("Success"):r.error(e.message,"Connection Test Failed:",{timeOut:1e4}),t()},function(e){c("Failed to test data source: ",e.status,e.statusText,e),r.error("Unknown error occurred while performing connection test. Please try again later.","Connection Test Failed:",{timeOut:1e4}),t()})}s.record("view","page","admin/data_source"),e.dataSourceId=t.dataSourceId,"new"===e.dataSourceId?e.dataSource=new o({options:{}}):e.dataSource=o.get({id:t.dataSourceId}),e.$watch("dataSource.id",function(t){t!==e.dataSourceId&&void 0!==t&&a.path("/data_sources/"+t).replace()}),e.actions=[{name:"Delete",class:"btn-danger",callback:l},{name:"Test Connection",class:"btn-default",callback:u,disableWhenDirty:!0}]}function i(e){return e.controller("DataSourceCtrl",r),{"/data_sources/:dataSourceId":{template:u.default,controller:"DataSourceCtrl",title:"Datasources"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=n(24),o=a(s),l=n(695),u=a(l);r.$inject=["$scope","$routeParams","$http","$location","toastr","currentUser","Events","DataSource"];var c=(0,o.default)("redash:http")},function(e,t){e.exports='<settings-screen>\n  <div class="row">\n    <div class="col-md-8">\n      <dynamic-form target="dataSource" type="data_sources" actions="actions">\n      </dynamic-form>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function a(e,t,n,a,r,i){r.record("view","page","admin/destinations"),e.destinations=i.query()}function r(e){return e.controller("DestinationsCtrl",a),{"/destinations":{template:s.default,controller:"DestinationsCtrl",title:"Destinations"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(697),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["$scope","$location","toastr","currentUser","Events","Destination"]},function(e,t){e.exports='<settings-screen>\n  <div class="row voffset1">\n    <div class="col-md-4">\n      <p>\n        <a href="destinations/new" class="btn btn-default"><i class="fa fa-plus"></i> New Alert Destination</a>\n      </p>\n      <div class="list-group">\n        <a ng-href="destinations/{{destination.id}}" class="list-group-item" ng-repeat="destination in destinations"><i class="fa {{destination.icon}}"></i> {{destination.name}}</a>\n      </div>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a,r,i,s,o){s.record("view","page","admin/destination"),e.destinationId=t.destinationId,"new"===e.destinationId?e.destination=new o({options:{}}):e.destination=o.get({id:t.destinationId}),e.$watch("destination.id",function(t){t!==e.destinationId&&void 0!==t&&a.path("/destinations/"+t).replace()}),e.delete=function(){s.record("delete","destination",e.destination.id),e.destination.$delete(function(){r.success("Destination deleted successfully."),a.path("/destinations/")},function(e){c("Failed to delete destination: ",e.status,e.statusText,e.data),r.error("Failed to delete destination.")})}}function i(e){return e.controller("DestinationCtrl",r),{"/destinations/:destinationId":{template:u.default,controller:"DestinationCtrl",title:"Destinations"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=n(24),o=a(s),l=n(699),u=a(l);r.$inject=["$scope","$routeParams","$http","$location","toastr","currentUser","Events","Destination"];var c=(0,o.default)("redash:http")},function(e,t){e.exports='<settings-screen>\n  <div class="row voffset1">\n    <div class="col-md-6">\n      <dynamic-form target="destination" type="destinations">\n        <button class="btn btn-danger" ng-if="destination.id" ng-click="delete()">Delete</button>\n      </dynamic-form>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function a(e,t,n,a,r,s){a.record("view","group_data_sources",e.groupId),e.group=r.get({id:t.groupId}),e.dataSources=r.dataSources({id:t.groupId}),e.newDataSource={},e.findDataSource=function(){void 0===e.foundDataSources&&s.query(function(t){var n=e.dataSources.map(function(e){return e.id});e.foundDataSources=t.filter(function(e){return!(0,i.contains)(n,e.id)})})},e.addDataSource=function(a){e.newDataSource.selected=void 0,n.post("api/groups/"+t.groupId+"/data_sources",{data_source_id:a.id}).success(function(){a.view_only=!1,e.dataSources.unshift(a),e.foundDataSources&&(e.foundDataSources=e.foundDataSources.filter(function(e){return e!==a}))})},e.changePermission=function(e,a){n.post("api/groups/"+t.groupId+"/data_sources/"+e.id,{view_only:a}).success(function(){e.view_only=a})},e.removeDataSource=function(a){n.delete("api/groups/"+t.groupId+"/data_sources/"+a.id).success(function(){e.dataSources=e.dataSources.filter(function(e){return a!==e})})}}function r(e){return e.controller("GroupDataSourcesCtrl",a),{"/groups/:groupId/data_sources":{template:o.default,controller:"GroupDataSourcesCtrl"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(5),s=n(701),o=function(e){return e&&e.__esModule?e:{default:e}}(s);a.$inject=["$scope","$routeParams","$http","Events","Group","DataSource"]},function(e,t){e.exports='<settings-screen>\n  <group-name group="group"></group-name>\n\n  <div class="row">\n    <div class="col-lg-4">\n      <ul class="tab-nav">\n        <li role="presentation"><a href="groups/{{group.id}}">Members</a></li>\n        <li role="presentation" class="active"><a href="groups/{{group.id}}/data_sources">Data Sources</a></li>\n      </ul>\n    </div>\n    <div class="col-lg-8">\n      <ui-select ng-model="newDataSource.selected" on-select="addDataSource($item)">\n        <ui-select-match placeholder="Add Data Source"></ui-select-match>\n        <ui-select-choices repeat="dataSource in foundDataSources | filter:$select.search"\n                           refresh="findDataSource($select.search)"\n                           refresh-delay="0">\n          <div>\n            {{dataSource.name}}\n          </div>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n  </div>\n  <div class="row voffset1">\n    <div class="col-lg-12">\n      <table class="table table-condensed table-hover">\n        <thead>\n        </thead>\n        <tbody>\n        <tr ng-repeat="dataSource in dataSources">\n          <td> {{dataSource.name}}</td>\n          <td width="280px" class="text-right">\n            <div class="btn-group" uib-dropdown>\n              <button type="button" class="btn btn-sm btn-default dropdown-toggle" uib-dropdown-toggle ng-if="dataSource.view_only">\n                View Only <span class="caret"></span>\n              </button>\n\n              <button type="button" class="btn btn-sm btn-success dropdown-toggle" uib-dropdown-toggle ng-if="!dataSource.view_only">\n                Full Access <span class="caret"></span>\n              </button>\n\n              <ul class="dropdown-menu" role="menu" uib-dropdown-menu>\n                <li><a ng-click="changePermission(dataSource, false)"><small ng-if="!dataSource.view_only"><span class="fa fa-check"/></small> Full Access<br/></a></li>\n                <li><a ng-click="changePermission(dataSource, true)"><small ng-if="dataSource.view_only"><span class="fa fa-check"/></small> View Only</a></li>\n              </ul>\n            </div>\n\n            <button class="pull-right btn btn-sm btn-danger" ng-click="removeDataSource(dataSource)">Remove</button>\n          </td>\n        </tr>\n        </tbody>\n      </table>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function a(e,t,n,a,r){a.record("view","page","groups"),e.currentUser=n,e.groups=new i.Paginator([],{itemsPerPage:20}),r.query(function(t){e.groups.updateRows(t)}),e.newGroup=function(){t.open({component:"editGroupDialog",size:"sm",resolve:{group:function(){return new r({})}}})}}function r(e){return e.controller("GroupsCtrl",a),{"/groups":{template:o.default,controller:"GroupsCtrl",title:"Groups"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(26),s=n(703),o=function(e){return e&&e.__esModule?e:{default:e}}(s);a.$inject=["$scope","$uibModal","currentUser","Events","Group"]},function(e,t){e.exports='<settings-screen>\n  <div class="row voffset1">\n    <div class="col-md-12">\n      <p ng-if="currentUser.hasPermission(\'admin\')">\n        <a ng-click="newGroup()" class="btn btn-default"><i class="fa fa-plus"></i> New Group</a>\n      </p>\n      <table class="table table-condensed table-hover">\n        <thead>\n          <tr>\n            <th>Name</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr ng-repeat="row in groups.getPageRows()">\n            <td>\n              <a href="groups/{{row.id}}">{{row.name}}</a>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n      <paginator paginator="groups"></paginator>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function a(e,t,n,a,r,s,o){r.record("view","group",e.groupId),e.currentUser=a,e.group=s.get({id:t.groupId}),e.members=s.members({id:t.groupId}),e.newMember={},e.findUser=function(t){""!==t&&void 0===e.foundUsers&&o.query(function(t){var n=e.members.map(function(e){return e.id});t.forEach(function(e){e.alreadyMember=(0,i.contains)(n,e.id)}),e.foundUsers=t})},e.addMember=function(a){e.newMember.selected=void 0,n.post("api/groups/"+t.groupId+"/members",{user_id:a.id}).success(function(){e.members.unshift(a),a.alreadyMember=!0})},e.removeMember=function(a){n.delete("api/groups/"+t.groupId+"/members/"+a.id).success(function(){e.members=e.members.filter(function(e){return e!==a}),e.foundUsers&&e.foundUsers.forEach(function(e){e.id===a.id&&(e.alreadyMember=!1)})})}}function r(e){return e.controller("GroupCtrl",a),{"/groups/:groupId":{template:o.default,controller:"GroupCtrl"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(5),s=n(705),o=function(e){return e&&e.__esModule?e:{default:e}}(s);a.$inject=["$scope","$routeParams","$http","currentUser","Events","Group","User"]},function(e,t){e.exports='<settings-screen>\n  <group-name group="group"></group-name>\n\n  <div class="row">\n    <div class="col-lg-4">\n      <ul class="tab-nav">\n        <li role="presentation" class="active"><a href="groups/{{group.id}}">Members</a></li>\n        <li role="presentation" ng-if="currentUser.isAdmin"><a href="groups/{{group.id}}/data_sources">Data Sources</a></li>\n      </ul>\n    </div>\n\n    <div class="col-lg-8" ng-if="currentUser.isAdmin">\n      <ui-select ng-model="newMember.selected" on-select="addMember($item)">\n        <ui-select-match placeholder="Add New Member"></ui-select-match>\n        <ui-select-choices repeat="user in foundUsers | filter:$select.search"\n                           refresh="findUser($select.search)"\n                           refresh-delay="0"\n                           ui-disable-choice="user.alreadyMember">\n          <div>\n            <img ng-src="{{user.gravatar_url}}" height="24px">&nbsp;{{user.name}}\n            <small ng-if="user.alreadyMember">(already member in this group)</small>\n          </div>\n        </ui-select-choices>\n      </ui-select>\n    </div>\n  </div>\n  <div class="row voffset1">\n    <div class="col-lg-12">\n      <table class="table table-condensed table-hover" ng-show="members">\n        <tbody>\n        <tr ng-repeat="member in members">\n          <td width="50px"><img ng-src="{{member.gravatar_url}}" height="40px"/></td>\n          <td>{{member.name}} <button class="pull-right btn btn-sm btn-danger" ng-click="removeMember(member)" ng-if="currentUser.isAdmin">Remove</button></td>\n        </tr>\n        </tbody>\n      </table>\n\n      <div ng-hide="members.length">\n        No members.\n      </div>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function a(e,t,n,a,r,i){a.record("view","page","personal_homepage"),this.canCreateQuery=n.hasPermission("create_query"),this.canCreateDashboard=n.hasPermission("create_dashboard"),this.canCreateAlert=n.hasPermission("list_alerts"),this.recentQueries=i.recent(),this.recentDashboards=r.recent(),this.newDashboard=function(){t.open({component:"editDashboardDialog",resolve:{dashboard:function(){return{name:null,layout:null}}}})}}function r(e){return e.component("homePage",{template:s.default,controller:a}),{"/":{template:"<home-page></home-page>",title:"Redash"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(707),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["$scope","$uibModal","currentUser","Events","Dashboard","Query"]},function(e,t){e.exports='<div class="container">\n  <div class="tile m-t-10 m-b-5" ng-if="$ctrl.canCreateQuery || $ctrl.canCreateDashboard || $ctrl.canCreateAlert">\n    <div class="t-body p-5">\n      <a href="queries/new" ng-show="$ctrl.canCreateQuery" class="btn btn-default">New Query</a>\n      <button ng-show="$ctrl.canCreateDashboard" class="btn btn-default" ng-click="$ctrl.newDashboard()">New Dashboard\n      </button>\n      <a href="alerts/new" ng-show="$ctrl.canCreateAlert" class="btn btn-default">New Alert</a>\n    </div>\n  </div>\n\n  <div class="tile">\n    <div class="t-body tb-padding">\n      <div class="row">\n        <div class="col-md-6">\n          <p class="f-500 m-b-20 c-black">Recent Dashboards</p>\n          <div class="list-group">\n            <a ng-href="dashboard/{{dashboard.slug}}" class="list-group-item" ng-repeat="dashboard in $ctrl.recentDashboards">\n                {{dashboard.name}} <span class="label label-default" ng-if="dashboard.is_draft">Unpublished</span>\n              </a>\n          </div>\n        </div>\n\n        <div class="col-md-6">\n          <p class="f-500 m-b-20 c-black">Recent Queries</p>\n          <div class="list-group">\n            <a ng-href="queries/{{query.id}}" class="list-group-item" ng-repeat="query in $ctrl.recentQueries">{{query.name}} <span class="label label-default" ng-if="query.is_draft">Unpublished</span></a>\n          </div>\n        </div>\n      </div>\n\n    </div>\n  </div>\n</div>'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e){e.component("pageQueriesList",{template:d.default,controller:p});var t={template:"<page-queries-list></page-queries-list>",reloadOnSearch:!1};return{"/queries":t,"/queries/my":t}}Object.defineProperty(t,"__esModule",{value:!0});var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.default=i;var o=n(0),l=a(o),u=n(26),c=n(709),d=a(c),p=function e(t,n,a){function i(e,n,a){t.search("page",e);var r=s({},c.defaultOptions,{page:e,page_size:n});return c.resource(r).$promise.then(function(e){var t=e.results.map(function(e){return e.created_at=(0,l.default)(e.created_at),e.retrieved_at=(0,l.default)(e.retrieved_at),e});a.updateRows(t,e.count)})}r(this,e);var o=parseInt(t.search().page||1,10);this.defaultOptions={};var c=this;switch(t.path()){case"/queries":n.set("Queries"),this.resource=a.query;break;case"/queries/my":n.set("My Queries"),this.resource=a.myQueries}this.paginator=new u.LivePaginator(i,{page:o}),this.tabs=[{name:"My Queries",path:"queries/my"},{path:"queries",name:"All Queries",isActive:function(e){return"/queries"===e}}]};p.$inject=["$location","Title","Query"]},function(e,t){e.exports='<div class="container">\n  <page-header title="Queries"></page-header>\n  <tab-nav tabs="$ctrl.tabs"></tab-nav>\n\n  <div class="bg-white">\n    <table class="table table-condensed table-hover">\n      <thead>\n      <tr>\n        <th>Name</th>\n        <th>Created By</th>\n        <th>Created At</th>\n        <th>Runtime</th>\n        <th>Last Executed At</th>\n        <th>Update Schedule</th>\n      </tr>\n      </thead>\n      <tbody>\n      <tr ng-repeat="query in $ctrl.paginator.getPageRows()">\n        <td><a href="queries/{{query.id}}">{{query.name}}</a> <span class="label label-default" ng-if="query.is_draft">Unpublished</span></td>\n        <td>{{query.user.name}}</td>\n        <td>{{query.created_at | dateTime}}</td>\n        <td>{{query.runtime | durationHumanize}}</td>\n        <td>{{query.retrieved_at | dateTime}}</td>\n        <td>{{query.schedule | scheduleHumanize}}</td>\n      </tr>\n      </tbody>\n    </table>\n    <paginator paginator="$ctrl.paginator"></paginator>\n  </div>\n</div>\n'},function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n,a,r){var i=this;this.term=e.search().q,this.paginator=new u.Paginator([],{itemsPerPage:20}),r.search({q:this.term,include_drafts:!0},function(e){var t=e.map(function(e){return e.created_at=(0,o.default)(e.created_at),e});i.paginator.updateRows(t)}),this.search=function(){(0,l.isString)(i.term)&&""!==i.term.trim()?e.search({q:i.term}):i.paginator.updateRows([])},a.record("search","query","",{term:this.term})}function i(e){return e.component("queriesSearchResultsPage",{template:d.default,controller:r}),{"/queries/search":{template:"<queries-search-results-page></queries-search-results-page>",reloadOnSearch:!0,title:"Queries Search"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=i;var s=n(0),o=a(s),l=n(5),u=n(26),c=n(711),d=a(c);r.$inject=["$location","$filter","currentUser","Events","Query"]},function(e,t){e.exports='<div class="container">\n    <div class="bg-white p-5 m-t-10 m-b-10">\n      <form class="form-inline" role="form" ng-submit="$ctrl.search()">\n        <div class="input-group">\n            <input class="form-control input-sm" placeholder="Search..." ng-model="$ctrl.term" autofocus>\n            <span class="input-group-btn">\n              <button class="btn btn-primary" type="submit">\n                <span class="zmdi zmdi-search"></span>\n              </button>\n            </span>\n        </div>\n      </form>\n    </div>\n    <div class="bg-white">\n      <table class="table table-condensed table-hover">\n        <thead>\n          <tr>\n            <th>Name</th>\n            <th>Created By</th>\n            <th>Created At</th>\n            <th>Update Schedule</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr ng-repeat="query in $ctrl.paginator.getPageRows()">\n            <td><a href="queries/{{query.id}}">{{query.name}}</a> <span class="label label-default" ng-if="query.is_draft">Unpublished</span></td>\n            <td>{{query.user.name}}</td>\n            <td>{{query.created_at | dateTime}}</td>\n            <td>{{query.schedule | scheduleHumanize}}</td>\n          </tr>\n        </tbody>\n      </table>\n      <paginator paginator="$ctrl.paginator"></paginator>\n    </div>\n</div>\n'},function(e,t,n){"use strict";function a(e,t,n,a,r,i,s,o,l,u,c,d){n("QueryViewCtrl",{$scope:a});e.record("view_source","query",a.query.id);var p=!a.query.id,f=a.query.query,m=a.saveQuery;a.sourceMode=!0,a.isDirty=!1,a.base_url=r.protocol()+"://"+r.host()+":"+r.port(),a.newVisualization=void 0,Object.defineProperty(a,"showDataset",{get:function(){return a.queryResult&&"done"===a.queryResult.getStatus()}});var g={"mod+s":function(){a.canEdit&&a.saveQuery()}};d.bind(g),a.$on("$destroy",function(){d.unbind(g)}),a.canForkQuery=function(){return l.hasPermission("edit_query")&&!a.dataSource.view_only},a.saveQuery=function(e,t){var n=m(e,t);return n.then(function(e){f=e.query,a.isDirty=a.query.query!==f,a.query.version=e.version,p&&r.path(e.getSourceLink())}),n},a.formatQuery=function(){u.format(a.dataSource.syntax,a.query.query).then(function(e){a.query.query=e}).catch(function(e){return t.error(e)})},a.duplicateQuery=function(){e.record("fork","query",a.query.id),u.fork({id:a.query.id},function(e){r.url(e.getSourceLink()).replace()})},a.deleteVisualization=function(n,i){n.preventDefault();var s="Are you sure you want to delete "+i.name+" ?",l={class:"btn-danger",title:"Delete"};o.open(void 0,s,l).then(function(){e.record("delete","visualization",i.id),c.delete({id:i.id},function(){a.selectedTab===String(i.id)&&(a.selectedTab="table",r.hash(a.selectedTab)),a.query.visualizations=a.query.visualizations.filter(function(e){return i.id!==e.id})},function(){t.error("Error deleting visualization. Maybe it's used in a dashboard?")})})},a.$watch("query.query",function(e){a.isDirty=e!==f})}function r(e){return e.controller("QuerySourceCtrl",a),{"/queries/new":{template:s.default,controller:"QuerySourceCtrl",reloadOnSearch:!1,resolve:{query:["Query",function(e){"ngInject";return e.newQuery()}],dataSources:["DataSource",function(e){"ngInject";return e.query().$promise}]}},"/queries/:queryId/source":{template:s.default,controller:"QuerySourceCtrl",reloadOnSearch:!1,resolve:{query:["Query","$route",function(e,t){"ngInject";return e.get({id:t.current.params.queryId}).$promise}]}}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(291),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["Events","toastr","$controller","$scope","$location","$http","$q","AlertDialog","currentUser","Query","Visualization","KeyboardShortcuts"]},function(e,t,n){"use strict";function a(e,t,n,a,r,o,l,u,c,d,p,f,m,g,h,v,b){function y(t){void 0===t&&(t=r.search().maxAge),void 0===t&&(t=-1),e.showLog=!1,e.queryResult=e.query.getQueryResult(t)}function w(){var t=e.query.data_source_id;return void 0===t&&(t=parseInt(localStorage.lastSelectedDataSourceId,10)),!isNaN(t)&&(0,s.some)(e.dataSources,function(e){return e.id===t})||(t=e.dataSources[0].id),t}function x(t){e.hasSchema=t,e.editorSize=t?"col-md-9":"col-md-12"}function q(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;b.getSchema({id:e.query.data_source_id,refresh:t},function(n){var a=!!t&&(e.schema&&e.schema.length>0),r=n&&n.length>0;r?(e.schema=n,n.forEach(function(e){e.collapsed=!0})):a&&m.error("Schema refresh failed. Please try again later."),x(r||a)})}function _(){x(!1),q()}function $(t){if(e.dataSources=t.filter(function(t){return!t.view_only||t.id===e.query.data_source_id}),0===e.dataSources.length)return void(e.noDataSources=!0);e.query.isNew()&&(e.query.data_source_id=w()),e.dataSource=(0,s.find)(t,function(t){return t.id===e.query.data_source_id}),e.canCreateQuery=(0,s.any)(t,function(e){return!e.view_only}),_()}e.refreshSchema=function(){return q(!0)},e.executeQuery=function(){e.canExecuteQuery()&&e.query.query&&(y(0),e.lockButton(!0),e.cancelling=!1,t.record("execute","query",e.query.id),p.getPermissions())},e.currentUser=h,e.dataSource={},e.query=n.current.locals.query,e.showPermissionsControl=f.showPermissionsControl;var k={"mod+enter":e.executeQuery};u.bind(k),e.$on("$destroy",function(){u.unbind(k)}),t.record("view","query",e.query.id),(e.query.hasResult()||e.query.paramsRequired())&&y(),e.queryExecuting=!1,e.isQueryOwner=h.id===e.query.user.id||h.hasPermission("admin"),e.canEdit=h.canEdit(e.query)||e.query.can_edit,e.canViewSource=h.hasPermission("view_source"),e.canExecuteQuery=function(){return h.hasPermission("execute_query")&&!e.dataSource.view_only},e.canScheduleQuery=h.hasPermission("schedule_query"),n.current.locals.dataSources?(e.dataSources=n.current.locals.dataSources,$(n.current.locals.dataSources)):e.dataSources=b.query($),e.showDataset=!0,e.showLog=!1,e.lockButton=function(t){e.queryExecuting=t},e.showApiKey=function(){g.open({component:"apiKeyDialog",resolve:{query:e.query}})},e.saveQuery=function(t,n){var a=n;if(a){if(e.query.isNew())return l.reject();a.id=e.query.id,a.version=e.query.version}else a=(0,s.pick)(e.query,["schedule","query","id","description","name","data_source_id","options","latest_query_data_id","version","is_draft"]);var r=i({},{successMessage:"Query saved",errorMessage:"Query could not be saved"},t);return v.save(a,function(t){m.success(r.successMessage),e.query.version=t.version},function(e){409===e.status?m.error("It seems like the query has been modified by another user. Please copy/backup your changes and reload this page.",{autoDismiss:!1}):m.error(r.errorMessage)}).$promise},e.togglePublished=function(){t.record("toggle_published","query",e.query.id),e.query.is_draft=!e.query.is_draft,e.saveQuery(void 0,{is_draft:e.query.is_draft})},e.saveDescription=function(){t.record("edit_description","query",e.query.id),e.saveQuery(void 0,{description:e.query.description})},e.saveName=function(){t.record("edit_name","query",e.query.id),e.query.is_draft&&f.autoPublishNamedQueries&&"New Query"!==e.query.name&&(e.query.is_draft=!1),e.saveQuery(void 0,{name:e.query.name,is_draft:e.query.is_draft})},e.cancelExecution=function(){e.cancelling=!0,e.queryResult.cancelExecution(),t.record("cancel_execute","query",e.query.id)},e.archiveQuery=function(){function t(){v.delete({id:e.query.id},function(){e.query.is_archived=!0,e.query.schedule=null},function(){m.error("Query could not be archived.")})}var n={class:"btn-warning",title:"Archive"};d.open("Archive Query","Are you sure you want to archive this query?<br/> All alerts and dashboard widgets created with its visualizations will be deleted.",n).then(t)},e.updateDataSource=function(){t.record("update_data_source","query",e.query.id),localStorage.lastSelectedDataSourceId=e.query.data_source_id,e.query.latest_query_data=null,e.query.latest_query_data_id=null,e.query.id&&v.save({id:e.query.id,data_source_id:e.query.data_source_id,latest_query_data_id:null}),_(),e.dataSource=(0,s.find)(e.dataSources,function(t){return t.id===e.query.data_source_id}),e.executeQuery()},e.setVisualizationTab=function(t){e.selectedTab=t.id,r.hash(t.id)},e.$watch("query.name",function(){c.set(e.query.name)}),e.$watch("queryResult && queryResult.getData()",function(t){t&&(e.filters=e.queryResult.getFilters())}),e.$watch("queryResult && queryResult.getStatus()",function(t){t&&("done"===t?(e.query.latest_query_data_id=e.queryResult.getId(),e.query.queryResult=e.queryResult,p.showNotification("Redash",e.query.name+" updated.")):"failed"===t&&p.showNotification("Redash",e.query.name+" failed to run: "+e.queryResult.getError()),"done"!==t&&"failed"!==t||e.lockButton(!1),null!=e.queryResult.getLog()&&(e.showLog=!0))}),e.openVisualizationEditor=function(t){e.query.isNew()?e.saveQuery().then(function(e){r.path(e.getSourceLink()).hash("add")}):function(){g.open({windowClass:"modal-xl",component:"editVisualizationDialog",resolve:{query:e.query,visualization:t,queryResult:e.queryResult,onNewSuccess:function(){return e.setVisualizationTab}}})}()},"add"===r.hash()&&(r.hash(null),e.openVisualizationEditor()),e.openScheduleForm=function(){e.canEdit&&e.canScheduleQuery&&g.open({component:"scheduleDialog",size:"sm",resolve:{query:e.query,saveQuery:function(){return e.saveQuery}}})},e.showEmbedDialog=function(e,t){g.open({component:"embedCodeDialog",resolve:{query:e,visualization:t}})},e.$watch(function(){return r.hash()},function(t){e.selectedTab=t||"table"}),e.showManagePermissionsModal=function(){g.open({component:"permissionsEditor",resolve:{aclUrl:{url:"api/queries/"+a.queryId+"/acl"}}})}}function r(e){return e.controller("QueryViewCtrl",a),{"/queries/:queryId":{template:l.default,controller:"QueryViewCtrl",reloadOnSearch:!1,resolve:{query:["Query","$route",function(e,t){"ngInject";return e.get({id:t.current.params.queryId}).$promise}]}}}}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e};t.default=r;var s=n(5),o=n(291),l=function(e){return e&&e.__esModule?e:{default:e}}(o);a.$inject=["$scope","Events","$route","$routeParams","$location","$window","$q","KeyboardShortcuts","Title","AlertDialog","Notifications","clientConfig","toastr","$uibModal","currentUser","Query","DataSource"]},function(e,t,n){"use strict";function a(e,t,n,a,r,i,s){var o=this;this.snippetId=e.snippetId,i.record("view","query_snippet",this.snippetId),this.editorOptions={mode:"snippets",advanced:{behavioursEnabled:!0,enableSnippets:!1,autoScrollEditorIntoView:!0},onLoad:function(e){e.$blockScrolling=1/0,e.getSession().setUseWrapMode(!0),e.setShowPrintMargin(!1)}},this.saveChanges=function(){o.snippet.$save(function(e){a.success("Saved."),"new"===o.snippetId&&n.path("/query_snippets/"+e.id).replace()},function(){a.error("Failed saving snippet.")})},this.delete=function(){o.snippet.$delete(function(){n.path("/query_snippets"),a.sucess("Query snippet deleted.")},function(){a.error("Failed deleting query snippet.")})},"new"===this.snippetId?(this.snippet=new s({description:""}),this.canEdit=!0):this.snippet=s.get({id:this.snippetId},function(e){o.canEdit=r.canEdit(e)})}function r(e){return e.component("snippetPage",{template:s.default,controller:a}),{"/query_snippets/:snippetId":{template:"<snippet-page></snippet-page>",title:"Query Snippets"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,n(715);var i=n(716),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["$routeParams","$http","$location","toastr","currentUser","Events","QuerySnippet"]},,function(e,t){e.exports='<settings-screen>\n  <div class="">\n    <form name="snippetForm" class="form">\n      <div class="form-group">\n        <label>Trigger</label>\n        <input type="string" class="form-control" ng-model="$ctrl.snippet.trigger" ng-disabled="!$ctrl.canEdit" required autofocus>\n      </div>\n\n      <div class="form-group">\n        <label>Description</label>\n        <input type="string" class="form-control" ng-model="$ctrl.snippet.description" ng-disabled="!$ctrl.canEdit">\n      </div>\n\n      <div class="form-group">\n        <label>Snippet</label>\n        <pre ng-if="!$ctrl.canEdit">{{$ctrl.snippet.snippet}}</pre>\n        <div ui-ace="$ctrl.editorOptions" ng-model="$ctrl.snippet.snippet" style="height:300px" ng-if="$ctrl.canEdit"></div>\n      </div>\n\n      <div class="form-group" ng-if="$ctrl.canEdit">\n        <button class="btn btn-primary" ng-disabled="!snippetForm.$valid" ng-click="$ctrl.saveChanges()">Save</button>\n        <button class="btn btn-danger" ng-if="$ctrl.snippet.id" ng-click="$ctrl.delete()">Delete</button>\n      </div>\n      <small ng-if="$ctrl.snippet.user">\n        Created by: {{$ctrl.snippet.user.name}}\n      </small>\n    </form>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function a(e,t,n,a){var r=this;n.record("view","page","query_snippets"),this.snippets=new i.Paginator([],{itemsPerPage:20}),a.query(function(e){r.snippets.updateRows(e)})}function r(e){return e.component("snippetsListPage",{template:o.default,controller:a}),{"/query_snippets":{template:"<snippets-list-page></snippets-list-page>",title:"Query Snippets"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(26),s=n(718),o=function(e){return e&&e.__esModule?e:{default:e}}(s);a.$inject=["$location","currentUser","Events","QuerySnippet"]},function(e,t){e.exports='<settings-screen>\n    <div class="row voffset1">\n        <div class="col-md-12">\n          <p>\n            <a href="query_snippets/new" class="btn btn-default"><i class="fa fa-plus"></i> New Snippet</a>\n          </p>\n\n          <table class="table table-condensed table-hover">\n            <thead>\n              <tr>\n                <th>Trigger</th>\n                <th>Description</th>\n                <th>Snippet</th>\n                <th>Created By</th>\n                <th>Updated At</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr ng-repeat="row in $ctrl.snippets.getPageRows()">\n                <td>\n                  <a href="query_snippets/{{row.id}}">{{row.trigger}}</a>\n                </td>\n                <td>\n                  {{row.description}}\n                </td>\n                <td>\n                  {{row.snippet}}\n                </td>\n                <td>\n                  {{row.user.name}}\n                </td>\n                <td>\n                  <span am-time-ago="row.created_at"></span>\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          <paginator paginator="$ctrl.snippets"></paginator>\n        </div>\n    </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function a(e,t,n){var a=this;t.record("view","page","users"),this.currentUser=e,this.users=new i.Paginator([],{itemsPerPage:20}),n.query(function(e){a.users.updateRows(e)})}function r(e){return e.component("usersListPage",{controller:a,template:o.default}),{"/users":{template:"<users-list-page></users-list-page>",title:"Users"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(26),s=n(720),o=function(e){return e&&e.__esModule?e:{default:e}}(s);a.$inject=["currentUser","Events","User"]},function(e,t){e.exports='<settings-screen>\n  <div class="row voffset1">\n    <div class="col-md-12">\n      <p ng-if="$ctrl.currentUser.hasPermission(\'admin\')">\n        <a href="users/new" class="btn btn-default"><i class="fa fa-plus"></i> New User</a>\n      </p>\n\n      <table class="table table-condensed table-hover">\n        <thead>\n          <tr>\n            <th>Name</th>\n            <th>Joined</th>\n          </tr>\n        </thead>\n        <tbody>\n          <tr ng-repeat="row in $ctrl.users.getPageRows()">\n            <td>\n              <img ng-src="{{row.gravatar_url}}" height="40px"/> <a href="users/{{row.id}}">{{row.name}}</a>\n            </td>\n            <td>\n              <span am-time-ago="row.created_at"></span>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n      <paginator paginator="$ctrl.users"></paginator>\n    </div>\n  </div>\n</settings-screen>\n'},function(e,t,n){"use strict";function a(e,t,n,a,r,i){var s=this;r.record("view","page","users/new"),e.user=new i({}),e.saveUser=function(){s.userForm.$valid&&e.user.$save(function(t){e.user=t,e.user.created=!0,n.success("Saved.")},function(e){var t=e.data.message||"Failed saving.";n.error(t)})}}function r(e){return e.controller("NewUserCtrl",a),{"/users/new":{template:s.default,controller:"NewUserCtrl",controllerAs:"$ctrl",bindToController:"true"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(722),s=function(e){return e&&e.__esModule?e:{default:e}}(i);a.$inject=["$scope","$location","toastr","currentUser","Events","User"]},function(e,t){e.exports='<settings-screen>\n  <email-settings-warning function="\'invite emails\'"></email-settings-warning>\n  <form class="form" name="$ctrl.userForm" ng-submit="saveUser()" novalidate>\n    <div class="form-group required" ng-class="{ \'has-error\':  ($ctrl.userForm.email | showError:$ctrl.userForm )}">\n      <label class="control-label">Name</label>\n      <input type="text" name="name" class="form-control" ng-model="user.name" ng-disabled="user.created" required/ autofocus>\n\n      <error-messages input="$ctrl.userForm.name" form="$ctrl.userForm"></error-messages>\n    </div>\n\n    <div class="form-group required" ng-class="{ \'has-error\': ($ctrl.userForm.email | showError:$ctrl.userForm ) }">\n      <label class="control-label">Email</label>\n      <input name="email" type="email" class="form-control" ng-model="user.email" ng-disabled="user.created" required/>\n\n      <error-messages input="$ctrl.userForm.email" form="$ctrl.userForm"></error-messages>\n    </div>\n\n    <div class="form-group" ng-if="!user.created">\n      <button class="btn btn-primary">Create</button>\n    </div>\n\n\n    <div ng-if="user.created" class="alert alert-success">\n      <p>\n        <strong>The user has been created and should receive an invite email soon.</strong>\n      </p>\n      <p>\n        You can use the following link to invite them yourself:<br/>\n        {{user.invite_link}}\n      </p>\n    </div>\n  </form>\n</settings-screen>\n'},function(e,t,n){"use strict";function a(e,t,n,a,r,s,o,l,u){e.userId=t.userId,e.currentUser=o,e.clientConfig=s,"me"===e.userId&&(e.userId=o.id),l.record("view","user",e.userId),e.canEdit=o.hasPermission("admin")||o.id===parseInt(e.userId,10),e.showSettings=!1,e.showPasswordSettings=!1,e.selectTab=function(t){e.selectedTab=t,(0,i.each)(e.tabs,function(n,a){e.tabs[a]=a===t})},e.setTab=function(t){e.selectedTab=t,a.hash(t)},e.tabs={profile:!1,apiKey:!1,settings:!1,password:!1},e.selectTab(a.hash()||"profile"),e.user=u.get({id:e.userId},function(t){"password"===t.auth_type&&(e.showSettings=e.canEdit,e.showPasswordSettings=e.canEdit)}),e.password={current:"",new:"",newRepeat:""},e.savePassword=function(t){if(t.$valid){var n={id:e.user.id,password:e.password.new,old_password:e.password.current};u.save(n,function(){r.success("Password Saved."),e.password={current:"",new:"",newRepeat:""}},function(e){var t=e.data.message||"Failed saving password.";r.error(t)})}},e.updateUser=function(t){if(t.$valid){var n={id:e.user.id,name:e.user.name,email:e.user.email};u.save(n,function(t){r.success("Saved."),e.user=t},function(e){var t=e.data.message||"Failed saving.";r.error(t)})}},e.sendPasswordReset=function(){e.disablePasswordResetButton=!0,n.post("api/users/"+e.user.id+"/reset_password").success(function(t){e.disablePasswordResetButton=!1,e.passwordResetLink=t.reset_link})}}function r(e){return e.controller("UserCtrl",a),{"/users/:userId":{template:o.default,reloadOnSearch:!1,controller:"UserCtrl",title:"Users"}}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var i=n(5),s=n(724),o=function(e){return e&&e.__esModule?e:{default:e}}(s);a.$inject=["$scope","$routeParams","$http","$location","toastr","clientConfig","currentUser","Events","User"]},function(e,t){e.exports='<settings-screen>\n  <email-settings-warning function="\'invite emails\'"></email-settings-warning>\n\n  <h3 class="p-l-5">{{user.name}}</h3>\n\n  <ul class="tab-nav">\n    <rd-tab tab-id="profile" name="Profile" ng-click="selectTab(\'profile\')"></rd-tab>\n    <rd-tab tab-id="apiKey" name="API Key" ng-click="selectTab(\'apiKey\')" ng-if="user.api_key"></rd-tab>\n    <rd-tab tab-id="settings" name="Settings" ng-click="selectTab(\'settings\')" ng-if="showSettings"></rd-tab>\n    <rd-tab tab-id="password" name="Password" ng-click="selectTab(\'password\')" ng-if="showPasswordSettings"></rd-tab>\n  </ul>\n\n  <div ng-show="selectedTab == \'profile\'" class="p-10">\n    <p>\n      <img ng-src="{{user.gravatar_url}}"/>\n    </p>\n\n    <p>\n      <strong>{{user.name}}</strong>\n    </p>\n\n    <p>\n      {{user.email}}\n    </p>\n    <div ng-if="currentUser.isAdmin">\n      <hr/>\n      <div class="form-group">\n        <button class="btn btn-default" ng-click="sendPasswordReset()" ng-disabled="disablePasswordResetButton">Send\n          Password Reset Email\n        </button>\n      </div>\n\n      <div ng-if="passwordResetLink" class="alert alert-success">\n        <p ng-if="!clientConfig.mailSettingMissing">\n          <strong>The user should receive a link to reset his password by email soon.</strong>\n        </p>\n        <p ng-if="clientConfig.mailSettingsMissing">\n          You don\'t have mail server configured, please send the following link\n          to {{user.name}} to reset their password:<br/>\n          <a ng-href="passwordResetLink">{{passwordResetLink}}</a>\n        </p>\n      </div>\n    </div>\n  </div>\n  <div ng-show="selectedTab == \'apiKey\'" class="p-10">\n    API Key:\n    <input type="text" value="{{user.api_key}}" size="44" readonly/>\n  </div>\n  <div ng-show="selectedTab == \'settings\'" class="p-10">\n    <div class="col-md-6">\n      <form class="form" name="userSettingsForm" ng-submit="updateUser(userSettingsForm)" novalidate>\n        <div class="form-group required" ng-class="{ \'has-error\':  (userSettingsForm.name | showError:userSettingsForm )}">\n          <label class="control-label">Name</label>\n          <input name="name" type="text" class="form-control" ng-model="user.name" required/>\n          <error-messages input="userSettingsForm.name" form="userSettingsForm"></error-messages>\n        </div>\n        <div class="form-group required" ng-class="{ \'has-error\':  (userSettingsForm.email | showError:userSettingsForm )}">\n          <label class="control-label">Email</label>\n          <input name="email" type="email" class="form-control" ng-model="user.email" required/>\n          <error-messages input="userSettingsForm.email" form="userSettingsForm"></error-messages>\n        </div>\n        <div class="form-group">\n          <button class="btn btn-primary">Save</button>\n        </div>\n      </form>\n    </div>\n  </div>\n  <div ng-show="selectedTab == \'password\'" class="p-10">\n    <div class="col-md-6">\n      <form class="form" name="userPasswordForm" ng-submit="savePassword(userPasswordForm)" novalidate>\n        <div class="form-group required" ng-class="{ \'has-error\':  (userPasswordForm.currentPassword | showError:userPasswordForm )}">\n          <label class="control-label">Current Password</label>\n          <input name="currentPassword" class="form-control" type="password" ng-model="password.current" required/>\n          <error-messages input="userPasswordForm.currentPassword" form="userPasswordForm"></error-messages>\n        </div>\n        <div class="form-group required" ng-class="{ \'has-error\':  (userPasswordForm.newPassword | showError:userPasswordForm )}">\n          <label class="control-label">New Password</label>\n          <input name="newPassword" class="form-control" type="password" ng-model="password.new" ng-minlength="6"\n                 required/>\n          <error-messages input="userPasswordForm.newPassword" form="userPasswordForm"></error-messages>\n        </div>\n        <div class="form-group required" ng-class="{ \'has-error\':  (userPasswordForm.passwordRepeat | showError:userPasswordForm )}">\n          <label class="control-label">Repeat New Password</label>\n          <input name="passwordRepeat" class="form-control" type="password" ng-model="password.newRepeat"\n                 compare-to="password.new"/>\n          <span class="help-block error"\n                ng-if="userPasswordForm.passwordRepeat.$error.compareTo">Passwords don\'t match.</span>\n        </div>\n        <div class="form-group">\n          <button class="btn btn-primary">Save</button>\n        </div>\n      </form>\n    </div>\n  </div>\n</settings-screen>\n'}]),[292]);
//# sourceMappingURL=app.5262398db28052e60e20.js.map