FROM cypress/browsers:node-24.14.0-chrome-145.0.7632.116-1-ff-148.0-edge-145.0.3800.70-1

ENV APP /usr/src/app
WORKDIR $APP

COPY package.json pnpm-lock.yaml pnpm-workspace.yaml .npmrc $APP/
COPY viz-lib $APP/viz-lib
RUN npm install -g pnpm@10.30.3 && pnpm install --frozen-lockfile > /dev/null

COPY . $APP

RUN ./node_modules/.bin/cypress verify
